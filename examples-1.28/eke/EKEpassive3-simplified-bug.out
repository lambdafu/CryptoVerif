Doing expand if, let, find... No change.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... No change.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_55: host, x2_54: host, x3_53: G, x4_52: G, x5_51: G) -> let x1: host = x1_55 in let x2: host = x2_54 in let x3: G = x3_53 in let x4: G = x4_52 in let x5: G = x5_51 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Succeeded.
Doing simplify... Run simplify 3 time(s). Maximum reached.
Eliminated collisions between y and y Probability: 0.5 * NS * NS / |exponent|
Eliminated collisions between x and x Probability: 0.5 * NU * NU / |exponent|
Eliminated collisions between r1_71[!_42] and auth_s[!_42] Probability: NS / |hash1|
(r1_71[!_42] characterizes a part of r1_71[!_42] of type(s) hash1;
 auth_s[!_42] does not depend on r1_71[!_42])
Reduced (mult(x[j[!_42]], y[!_42]) = mult(x[j[@i_87[!_42]]], y[@i_87[!_42]])) to (((x[j[!_42]] = x[j[@i_87[!_42]]]) && (y[!_42] = y[@i_87[!_42]])) || ((x[j[!_42]] = y[@i_87[!_42]]) && (y[!_42] = x[j[@i_87[!_42]]]))) Probability: 1. / |exponent| * NS
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_62: G, @2_ke_61: passwd) := let @2_x: G = @2_x_62 in let @2_ke: passwd = @2_ke_61 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_64: G, @2_kd_63: passwd) := let @2_m: G = @2_m_64 in let @2_kd: passwd = @2_kd_63 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Succeeded.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Eliminated collisions between @2_r4_137[!_41] and x14[!2_804] Probability: qH1 * NU / |G|
(@2_r4_137[!_41] characterizes a part of @2_r4_137[!_41] of type(s) G;
 x14[!2_804] does not depend on @2_r4_137[!_41])
Eliminated collisions between exp(g, y[!_42]) and @2_r4_128[!2_730] Probability: qD * NS / |exponent|
(exp(g, y[!_42]) characterizes a part of y[!_42] of type(s) exponent;
 @2_r4_128[!2_730] does not depend on y[!_42])
Eliminated collisions between exp(g, y[!_42]) and @2_r4_137[!2_729] Probability: NU * NS / |exponent|
(exp(g, y[!_42]) characterizes a part of y[!_42] of type(s) exponent;
 @2_r4_137[!2_729] does not depend on y[!_42])
Eliminated collisions between exp(g, y[!_42]) and @2_x_133[!2_728] Probability: qE * NS / |exponent|
(exp(g, y[!_42]) characterizes a part of y[!_42] of type(s) exponent;
 @2_x_133[!2_728] does not depend on y[!_42])
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
{1316}in(start, ());
{1315}new pw: passwd;
{1314}out(c8, {1313}());
{1312}(
{1308}  ! !_41 <= NU
{1307}  in(c1[{1306}!_41], ());
{1305}  new x: exponent;
{1304}  let X: G = {1303}exp({1300}g, {1302}x) in
{1299}  out(c2[{1298}!_41], {1297}({1294}U, {1296}X));
{1293}  in(c5[{1292}!_41], (={1291}S, Ystar_u: G));
{1290}  let @2_m_139: G = {1289}cst_G in
{1288}  let @2_kd_138: passwd = {1287}cst_passwd in
{1286}  find [unique] @i_171 <= qD suchthat defined(@2_m[{813}@i_171], @2_kd[{815}@i_171], @2_kd_129[{817}@i_171], @2_m_130[{819}@i_171], @2_r4_128[{821}@i_171]) && otheruses(@2_m[{811}@i_171] -> @2_r4_128[{809}@i_171]) && {807}({801}({797}Ystar_u = {800}@2_m[{799}@i_171]) && {806}({802}pw = {805}@2_kd[{804}@i_171])) then
  (
{795}    let Y_u: G = {794}@2_r4_128[{793}@i_171] in
{791}    let K_u: G = {790}exp({787}@2_r4_128[{786}@i_171], {789}x) in
{784}    let x1_82: host = {783}U in
{782}    let x2_81: host = {781}S in
{780}    find [unique] @i_91 <= qH1 suchthat defined(x11[{769}@i_91], x12[{771}@i_91], x13[{773}@i_91], x14[{775}@i_91], x15[{777}@i_91], r1_65[{779}@i_91]) && otheruses(r1_65[{767}@i_91]) && {765}({736}({732}x1_82 = {735}x11[{734}@i_91]) && {764}({742}({738}x2_81 = {741}x12[{740}@i_91]) && {763}({748}({744}X = {747}x13[{746}@i_91]) && {762}({755}({751}@2_r4_128[{750}@i_171] = {754}x14[{753}@i_91]) && {761}({757}K_u = {760}x15[{759}@i_91]))))) then
    (
{730}      let sk_u: hash0 = {729}h0({720}U, {721}S, {723}X, {726}@2_r4_128[{725}@i_171], {728}K_u) in
{719}      event {718}termU({707}U, {709}X, {710}S, {712}Ystar_u, {715}r1_65[{714}@i_91], {717}sk_u);
{704}      out(c6[{703}!_41], {702}r1_65[{701}@i_91])
    )
    else
{697}      new r1_77: hash1;
{696}      let sk_u: hash0 = {695}h0({686}U, {687}S, {689}X, {692}@2_r4_128[{691}@i_171], {694}K_u) in
{685}      event {684}termU({674}U, {676}X, {677}S, {679}Ystar_u, {681}r1_77, {683}sk_u);
{671}      out(c6[{670}!_41], {669}r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[{967}@i_168], @2_m_139[{969}@i_168], @2_r4_137[{971}@i_168]) && otheruses(Ystar_u[{965}@i_168] -> @2_r4_137[{963}@i_168]) && {961}({957}Ystar_u = {960}Ystar_u[{959}@i_168]) then
  (
{955}    let Y_u: G = {954}@2_r4_137[{953}@i_168] in
{951}    let K_u: G = {950}exp({947}@2_r4_137[{946}@i_168], {949}x) in
{944}    let x1_82: host = {943}U in
{942}    let x2_81: host = {941}S in
{940}    find [unique] @i_91 <= qH1 suchthat defined(x11[{929}@i_91], x12[{931}@i_91], x13[{933}@i_91], x14[{935}@i_91], x15[{937}@i_91], r1_65[{939}@i_91]) && otheruses(r1_65[{927}@i_91]) && {925}({896}({892}x1_82 = {895}x11[{894}@i_91]) && {924}({902}({898}x2_81 = {901}x12[{900}@i_91]) && {923}({908}({904}X = {907}x13[{906}@i_91]) && {922}({915}({911}@2_r4_137[{910}@i_168] = {914}x14[{913}@i_91]) && {921}({917}K_u = {920}x15[{919}@i_91]))))) then
    (
{890}      let sk_u: hash0 = {889}h0({880}U, {881}S, {883}X, {886}@2_r4_137[{885}@i_168], {888}K_u) in
{879}      event {878}termU({867}U, {869}X, {870}S, {872}Ystar_u, {875}r1_65[{874}@i_91], {877}sk_u);
{864}      out(c6[{863}!_41], {862}r1_65[{861}@i_91])
    )
    else
{857}      new r1_77: hash1;
{856}      let sk_u: hash0 = {855}h0({846}U, {847}S, {849}X, {852}@2_r4_137[{851}@i_168], {854}K_u) in
{845}      event {844}termU({834}U, {836}X, {837}S, {839}Ystar_u, {841}r1_77, {843}sk_u);
{831}      out(c6[{830}!_41], {829}r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_ke[{1123}@i_166], @2_x[{1125}@i_166], @2_x_133[{1127}@i_166], @2_ke_132[{1129}@i_166], @2_r2_131[{1131}@i_166]) && otheruses(@2_x[{1121}@i_166] -> @2_r2_131[{1119}@i_166]) && {1117}({1111}({1107}Ystar_u = {1110}@2_r2_131[{1109}@i_166]) && {1116}({1112}pw = {1115}@2_ke[{1114}@i_166])) then
  (
{1105}    let Y_u: G = {1104}@2_x[{1103}@i_166] in
{1101}    let K_u: G = {1100}exp({1097}@2_x[{1096}@i_166], {1099}x) in
{1094}    let x1_82: host = {1093}U in
{1092}    let x2_81: host = {1091}S in
{1090}    find [unique] @i_91 <= qH1 suchthat defined(x11[{1079}@i_91], x12[{1081}@i_91], x13[{1083}@i_91], x14[{1085}@i_91], x15[{1087}@i_91], r1_65[{1089}@i_91]) && otheruses(r1_65[{1077}@i_91]) && {1075}({1046}({1042}x1_82 = {1045}x11[{1044}@i_91]) && {1074}({1052}({1048}x2_81 = {1051}x12[{1050}@i_91]) && {1073}({1058}({1054}X = {1057}x13[{1056}@i_91]) && {1072}({1065}({1061}@2_x[{1060}@i_166] = {1064}x14[{1063}@i_91]) && {1071}({1067}K_u = {1070}x15[{1069}@i_91]))))) then
    (
{1040}      let sk_u: hash0 = {1039}h0({1030}U, {1031}S, {1033}X, {1036}@2_x[{1035}@i_166], {1038}K_u) in
{1029}      event {1028}termU({1017}U, {1019}X, {1020}S, {1022}Ystar_u, {1025}r1_65[{1024}@i_91], {1027}sk_u);
{1014}      out(c6[{1013}!_41], {1012}r1_65[{1011}@i_91])
    )
    else
{1007}      new r1_77: hash1;
{1006}      let sk_u: hash0 = {1005}h0({996}U, {997}S, {999}X, {1002}@2_x[{1001}@i_166], {1004}K_u) in
{995}      event {994}termU({984}U, {986}X, {987}S, {989}Ystar_u, {991}r1_77, {993}sk_u);
{981}      out(c6[{980}!_41], {979}r1_77)
  )
  orfind @i_165 <= NS suchthat defined(Y[{1279}@i_165], @2_x_136[{1281}@i_165], @2_r2_134[{1283}@i_165], y[{1285}@i_165]) && otheruses(Y[{1277}@i_165] -> @2_r2_134[{1275}@i_165]) && {1273}({1269}Ystar_u = {1272}@2_r2_134[{1271}@i_165]) then
  (
{1267}    let Y_u: G = {1266}Y[{1265}@i_165] in
{1263}    let K_u: G = {1262}exp({1255}g, {1261}mult({1258}y[{1257}@i_165], {1260}x)) in
{1254}    let x1_82: host = {1253}U in
{1252}    let x2_81: host = {1251}S in
{1250}    find [unique] @i_91 <= qH1 suchthat defined(x11[{1239}@i_91], x12[{1241}@i_91], x13[{1243}@i_91], x14[{1245}@i_91], x15[{1247}@i_91], r1_65[{1249}@i_91]) && otheruses(r1_65[{1237}@i_91]) && {1235}({1206}({1202}x1_82 = {1205}x11[{1204}@i_91]) && {1234}({1212}({1208}x2_81 = {1211}x12[{1210}@i_91]) && {1233}({1218}({1214}X = {1217}x13[{1216}@i_91]) && {1232}({1225}({1221}Y[{1220}@i_165] = {1224}x14[{1223}@i_91]) && {1231}({1227}K_u = {1230}x15[{1229}@i_91]))))) then
    (
{1200}      let sk_u: hash0 = {1199}h0({1190}U, {1191}S, {1193}X, {1196}Y[{1195}@i_165], {1198}K_u) in
{1189}      event {1188}termU({1177}U, {1179}X, {1180}S, {1182}Ystar_u, {1185}r1_65[{1184}@i_91], {1187}sk_u);
{1174}      out(c6[{1173}!_41], {1172}r1_65[{1171}@i_91])
    )
    else
{1167}      new r1_77: hash1;
{1166}      let sk_u: hash0 = {1165}h0({1156}U, {1157}S, {1159}X, {1162}Y[{1161}@i_165], {1164}K_u) in
{1155}      event {1154}termU({1144}U, {1146}X, {1147}S, {1149}Ystar_u, {1151}r1_77, {1153}sk_u);
{1141}      out(c6[{1140}!_41], {1139}r1_77)
  )
  else
{661}    new @2_r4_137: G;
{660}    let Y_u: G = {659}@2_r4_137 in
{657}    let K_u: G = {656}exp({653}@2_r4_137, {655}x) in
{651}    let x1_82: host = {650}U in
{649}    let x2_81: host = {648}S in
{647}    new r1_77: hash1;
{646}    let sk_u: hash0 = {645}h0({637}U, {638}S, {640}X, {642}@2_r4_137, {644}K_u) in
{636}    event {635}termU({625}U, {627}X, {628}S, {630}Ystar_u, {632}r1_77, {634}sk_u);
{622}    out(c6[{621}!_41], {620}r1_77)
) | (
{609}  ! !_42 <= NS
{608}  in(c3[{607}!_42], (={606}U, X_s: G));
{605}  new y: exponent;
{604}  let Y: G = {603}exp({600}g, {602}y) in
{599}  let @2_x_136: G = {598}cst_G in
{597}  let @2_ke_135: passwd = {596}cst_passwd in
{595}  new @2_r2_134: G;
{594}  out(c4[{593}!_42], {592}({589}S, {591}@2_r2_134));
{588}  in(c7[{587}!_42], auth_s: hash1);
{586}  find j <= NU suchthat defined(X[{583}j], x[{585}j]) && {581}({578}X[{577}j] = {580}X_s) then
{575}  let K_s: G = {574}exp({567}g, {573}mult({570}x[{569}j], {572}y)) in
{566}  let x1_76: host = {565}U in
{564}  let x2_75: host = {563}S in
{562}  find [unique] @i_88 <= qH1 suchthat defined(x11[{496}@i_88], x12[{498}@i_88], x13[{500}@i_88], x14[{502}@i_88], x15[{504}@i_88], r1_65[{506}@i_88]) && otheruses(r1_65[{494}@i_88]) && {492}({464}({460}x1_76 = {463}x11[{462}@i_88]) && {491}({470}({466}x2_75 = {469}x12[{468}@i_88]) && {490}({476}({472}X_s = {475}x13[{474}@i_88]) && {489}({482}({478}Y = {481}x14[{480}@i_88]) && {488}({484}K_s = {487}x15[{486}@i_88]))))) then
  (
{458}    if {457}({453}auth_s = {456}r1_65[{455}@i_88]) then
{451}    let sk_s: hash0 = {450}h0({442}U, {443}S, {445}X_s, {447}Y, {449}K_s) in
{441}    event {440}termS({430}U, {432}X_s, {433}S, {435}@2_r2_134, {437}auth_s, {439}sk_s)
  )
  orfind  suchthat defined(Y_u[{557}j], K_u[{559}j], r1_77[{561}j]) && otheruses(r1_77[{555}j]) && {553}({546}({542}Y = {545}Y_u[{544}j]) && {552}({548}K_s = {551}K_u[{550}j])) then
  (
{540}    if {539}({535}auth_s = {538}r1_77[{537}j]) then
{533}    let sk_s: hash0 = {532}h0({524}U, {525}S, {527}X_s, {529}Y, {531}K_s) in
{523}    event {522}termS({512}U, {514}X_s, {515}S, {517}@2_r2_134, {519}auth_s, {521}sk_s)
  )
) | (
{415}  ! !_43 <= qE
{414}  in(@2_c1[{413}!_43], (@2_x: G, @2_ke: passwd));
{412}  let @2_x_133: G = {411}cst_G in
{410}  let @2_ke_132: passwd = {409}cst_passwd in
{408}  find [unique] @i_155 <= qD suchthat defined(@2_kd[{308}@i_155], @2_m[{310}@i_155], @2_m_130[{312}@i_155], @2_kd_129[{314}@i_155], @2_r4_128[{316}@i_155]) && otheruses(@2_m[{306}@i_155] -> @2_r4_128[{304}@i_155]) && {302}({295}({291}@2_x = {294}@2_r4_128[{293}@i_155]) && {301}({297}@2_ke = {300}@2_kd[{299}@i_155])) then
{289}    out(@2_c2[{288}!_43], {287}@2_m[{286}@i_155])
  orfind @i_152 <= NU suchthat defined(pw, Ystar_u[{339}@i_152], @2_m_139[{341}@i_152], @2_kd_138[{343}@i_152], @2_r4_137[{345}@i_152]) && otheruses(Ystar_u[{337}@i_152] -> @2_r4_137[{335}@i_152]) && {333}({328}({324}@2_x = {327}@2_r4_137[{326}@i_152]) && {332}({330}@2_ke = {331}pw)) then
{322}    out(@2_c2[{321}!_43], {320}Ystar_u[{319}@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[{370}@i_150], @2_ke[{372}@i_150], @2_ke_132[{374}@i_150], @2_x_133[{376}@i_150], @2_r2_131[{378}@i_150]) && otheruses(@2_x[{368}@i_150] -> @2_r2_131[{366}@i_150]) && {364}({357}({353}@2_x = {356}@2_x[{355}@i_150]) && {363}({359}@2_ke = {362}@2_ke[{361}@i_150])) then
{351}    out(@2_c2[{350}!_43], {349}@2_r2_131[{348}@i_150])
  orfind @i_149 <= NS suchthat defined(Y[{401}@i_149], pw, @2_ke_135[{403}@i_149], @2_x_136[{405}@i_149], @2_r2_134[{407}@i_149]) && otheruses(Y[{399}@i_149] -> @2_r2_134[{397}@i_149]) && {395}({390}({386}@2_x = {389}Y[{388}@i_149]) && {394}({392}@2_ke = {393}pw)) then
{384}    out(@2_c2[{383}!_43], {382}@2_r2_134[{381}@i_149])
  else
{283}    new @2_r2_131: G;
{282}    out(@2_c2[{281}!_43], {280}@2_r2_131)
) | (
{275}  ! !_44 <= qD
{274}  in(@2_c3[{273}!_44], (@2_m: G, @2_kd: passwd));
{272}  let @2_m_130: G = {271}cst_G in
{270}  let @2_kd_129: passwd = {269}cst_passwd in
{268}  find [unique] @i_147 <= qD suchthat defined(@2_m[{168}@i_147], @2_kd[{170}@i_147], @2_kd_129[{172}@i_147], @2_m_130[{174}@i_147], @2_r4_128[{176}@i_147]) && otheruses(@2_m[{166}@i_147] -> @2_r4_128[{164}@i_147]) && {162}({155}({151}@2_m = {154}@2_m[{153}@i_147]) && {161}({157}@2_kd = {160}@2_kd[{159}@i_147])) then
{149}    out(@2_c4[{148}!_44], {147}@2_r4_128[{146}@i_147])
  orfind @i_144 <= NU suchthat defined(Ystar_u[{199}@i_144], pw, @2_kd_138[{201}@i_144], @2_m_139[{203}@i_144], @2_r4_137[{205}@i_144]) && otheruses(Ystar_u[{197}@i_144] -> @2_r4_137[{195}@i_144]) && {193}({188}({184}@2_m = {187}Ystar_u[{186}@i_144]) && {192}({190}@2_kd = {191}pw)) then
{182}    out(@2_c4[{181}!_44], {180}@2_r4_137[{179}@i_144])
  orfind @i_142 <= qE suchthat defined(@2_ke[{230}@i_142], @2_x[{232}@i_142], @2_x_133[{234}@i_142], @2_ke_132[{236}@i_142], @2_r2_131[{238}@i_142]) && otheruses(@2_x[{228}@i_142] -> @2_r2_131[{226}@i_142]) && {224}({217}({213}@2_m = {216}@2_r2_131[{215}@i_142]) && {223}({219}@2_kd = {222}@2_ke[{221}@i_142])) then
{211}    out(@2_c4[{210}!_44], {209}@2_x[{208}@i_142])
  orfind @i_141 <= NS suchthat defined(pw, Y[{261}@i_141], @2_x_136[{263}@i_141], @2_ke_135[{265}@i_141], @2_r2_134[{267}@i_141]) && otheruses(Y[{259}@i_141] -> @2_r2_134[{257}@i_141]) && {255}({250}({246}@2_m = {249}@2_r2_134[{248}@i_141]) && {254}({252}@2_kd = {253}pw)) then
{244}    out(@2_c4[{243}!_44], {242}Y[{241}@i_141])
  else
{143}    new @2_r4_128: G;
{142}    out(@2_c4[{141}!_44], {140}@2_r4_128)
) | (
{135}  ! !_45 <= qH0
{134}  in(c10[{133}!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
{132}  out(c20[{131}!_45], {130}h0({121}x1, {123}x2, {125}x3, {127}x4, {129}x5))
) | (
{118}  ! !_46 <= qH1
{117}  in(c11[{116}!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
{115}  find [unique] @i_85 <= qH1 suchthat defined(x11[{50}@i_85], x12[{52}@i_85], x13[{54}@i_85], x14[{56}@i_85], x15[{58}@i_85], r1_65[{60}@i_85]) && otheruses(r1_65[{48}@i_85]) && {46}({18}({14}x11 = {17}x11[{16}@i_85]) && {45}({24}({20}x12 = {23}x12[{22}@i_85]) && {44}({30}({26}x13 = {29}x13[{28}@i_85]) && {43}({36}({32}x14 = {35}x14[{34}@i_85]) && {42}({38}x15 = {41}x15[{40}@i_85]))))) then
{12}    out(c21[{11}!_46], {10}r1_65[{9}@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[{104}@i_83], x2_81[{106}@i_83], X[{108}@i_83], Y_u[{110}@i_83], K_u[{112}@i_83], r1_77[{114}@i_83]) && otheruses(r1_77[{102}@i_83]) && {100}({72}({68}x11 = {71}x1_82[{70}@i_83]) && {99}({78}({74}x12 = {77}x2_81[{76}@i_83]) && {98}({84}({80}x13 = {83}X[{82}@i_83]) && {97}({90}({86}x14 = {89}Y_u[{88}@i_83]) && {96}({92}x15 = {95}K_u[{94}@i_83]))))) then
{66}    out(c21[{65}!_46], {64}r1_77[{63}@i_83])
  else
{6}    new r1_65: hash1;
{5}    out(c21[{4}!_46], {3}r1_65)
)

Doing insert event Encrypt at occurrence 1105... Done.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_55: host, x2_54: host, x3_53: G, x4_52: G, x5_51: G) -> let x1: host = x1_55 in let x2: host = x2_54 in let x3: G = x3_53 in let x4: G = x4_52 in let x5: G = x5_51 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_60: host, x2_59: host, x3_58: G, x4_57: G, x5_56: G) -> let x1: host = x1_60 in let x2: host = x2_59 in let x3: G = x3_58 in let x4: G = x4_57 in let x5: G = x5_56 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Succeeded.
Doing simplify... Run simplify 3 time(s). Fixpoint reached.
Eliminated collisions between @2_r4_128 and @2_r4_128 Probability: 0.5 * qD * qD / |G|
Eliminated collisions between @2_r4_128 and @2_r4_137 Probability: qD * NU / |G|
Eliminated collisions between @2_r4_137 and @2_r4_137 Probability: 0.5 * NU * NU / |G|
Eliminated collisions between r1_77 and r1_65 Probability: NU * qH1 / |hash1|
Eliminated collisions between r1_77[!_41] and auth_s[!2_2824] Probability: NS * NU / |hash1|
(r1_77[!_41] characterizes a part of r1_77[!_41] of type(s) hash1;
 auth_s[!2_2824] does not depend on r1_77[!_41])
Eliminated collisions between @2_r4_128[!2_2802] and exp(g, y[!2_2803]) Probability: NS * qD / |G|
(@2_r4_128[!2_2802] characterizes a part of @2_r4_128[!2_2802] of type(s) G;
 exp(g, y[!2_2803]) does not depend on @2_r4_128[!2_2802])
Eliminated collisions between @2_r4_137[!2_2754] and exp(g, y[!2_2755]) Probability: NS * NU / |G|
(@2_r4_137[!2_2754] characterizes a part of @2_r4_137[!2_2754] of type(s) G;
 exp(g, y[!2_2755]) does not depend on @2_r4_137[!2_2754])
Eliminated collisions between @2_r4_137[!_41] and x4_256[!2_2666] Probability: qH0 * NU / |G|
(@2_r4_137[!_41] characterizes a part of @2_r4_137[!_41] of type(s) G;
 x4_256[!2_2666] does not depend on @2_r4_137[!_41])
Eliminated collisions between @2_r4_137[!_41] and x4_262[!2_2665] Probability: NS * NU / |G|
(@2_r4_137[!_41] characterizes a part of @2_r4_137[!_41] of type(s) G;
 x4_262[!2_2665] does not depend on @2_r4_137[!_41])
Eliminated collisions between @2_r4_137[!_41] and x4_268[!2_2664] Probability: NS * NU / |G|
(@2_r4_137[!_41] characterizes a part of @2_r4_137[!_41] of type(s) G;
 x4_268[!2_2664] does not depend on @2_r4_137[!_41])
Eliminated collisions between @2_r4_137[!_41] and x4_280[!2_2662] Probability: NU * NU / |G|
(@2_r4_137[!_41] characterizes a part of @2_r4_137[!_41] of type(s) G;
 x4_280[!2_2662] does not depend on @2_r4_137[!_41])
Eliminated collisions between @2_r4_137[!_41] and x4_286[!2_2661] Probability: NU * NU / |G|
(@2_r4_137[!_41] characterizes a part of @2_r4_137[!_41] of type(s) G;
 x4_286[!2_2661] does not depend on @2_r4_137[!_41])
Eliminated collisions between @2_r4_137[!_41] and x4_292[!2_2660] Probability: NU * NU / |G|
(@2_r4_137[!_41] characterizes a part of @2_r4_137[!_41] of type(s) G;
 x4_292[!2_2660] does not depend on @2_r4_137[!_41])
Eliminated collisions between @2_r4_137[!_41] and x4_298[!2_2659] Probability: NU * NU / |G|
(@2_r4_137[!_41] characterizes a part of @2_r4_137[!_41] of type(s) G;
 x4_298[!2_2659] does not depend on @2_r4_137[!_41])
Eliminated collisions between @2_r4_137[!_41] and x4_304[!2_2658] Probability: NU * NU / |G|
(@2_r4_137[!_41] characterizes a part of @2_r4_137[!_41] of type(s) G;
 x4_304[!2_2658] does not depend on @2_r4_137[!_41])
Eliminated collisions between @2_r4_137[!_41] and x4_310[!2_2657] Probability: NU * NU / |G|
(@2_r4_137[!_41] characterizes a part of @2_r4_137[!_41] of type(s) G;
 x4_310[!2_2657] does not depend on @2_r4_137[!_41])
Eliminated collisions between exp(g, y[!_42]) and @2_r4_128[!2_2258] Probability: qD * NS / |exponent|
(exp(g, y[!_42]) characterizes a part of y[!_42] of type(s) exponent;
 @2_r4_128[!2_2258] does not depend on y[!_42])
Eliminated collisions between exp(g, y[!_42]) and @2_r4_137[!2_2213] Probability: NU * NS / |exponent|
(exp(g, y[!_42]) characterizes a part of y[!_42] of type(s) exponent;
 @2_r4_137[!2_2213] does not depend on y[!_42])
Reduced (mult(y[@i_165[j[!_42]]], x[j[!_42]]) = mult(x[j[!_42]], y[!_42])) to (((y[@i_165[j[!_42]]] = x[j[!_42]]) && (x[j[!_42]] = y[!_42])) || ((y[@i_165[j[!_42]]] = y[!_42]) && (x[j[!_42]] = x[j[!_42]]))) Probability: 1. / |exponent| * NS
Reduced (mult(y[@i_165[!_41]], x[!_41]) = mult(x[j[@i_412[!_41]]], y[@i_412[!_41]])) to (((y[@i_165[!_41]] = x[j[@i_412[!_41]]]) && (x[!_41] = y[@i_412[!_41]])) || ((y[@i_165[!_41]] = y[@i_412[!_41]]) && (x[!_41] = x[j[@i_412[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_165[!_41]], x[!_41]) = mult(x[j[@i_411[!_41]]], y[@i_411[!_41]])) to (((y[@i_165[!_41]] = x[j[@i_411[!_41]]]) && (x[!_41] = y[@i_411[!_41]])) || ((y[@i_165[!_41]] = y[@i_411[!_41]]) && (x[!_41] = x[j[@i_411[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_165[!_41]], x[!_41]) = mult(y[@i_165[@i_405[!_41]]], x[@i_405[!_41]])) to (((y[@i_165[!_41]] = y[@i_165[@i_405[!_41]]]) && (x[!_41] = x[@i_405[!_41]])) || ((y[@i_165[!_41]] = x[@i_405[!_41]]) && (x[!_41] = y[@i_165[@i_405[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_165[!_41]], x[!_41]) = mult(y[@i_165[@i_404[!_41]]], x[@i_404[!_41]])) to (((y[@i_165[!_41]] = y[@i_165[@i_404[!_41]]]) && (x[!_41] = x[@i_404[!_41]])) || ((y[@i_165[!_41]] = x[@i_404[!_41]]) && (x[!_41] = y[@i_165[@i_404[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_165[!_41]], x[!_41]) = mult(x[j[@i_402[!_41]]], y[@i_402[!_41]])) to (((y[@i_165[!_41]] = x[j[@i_402[!_41]]]) && (x[!_41] = y[@i_402[!_41]])) || ((y[@i_165[!_41]] = y[@i_402[!_41]]) && (x[!_41] = x[j[@i_402[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_165[!_41]], x[!_41]) = mult(x[j[@i_401[!_41]]], y[@i_401[!_41]])) to (((y[@i_165[!_41]] = x[j[@i_401[!_41]]]) && (x[!_41] = y[@i_401[!_41]])) || ((y[@i_165[!_41]] = y[@i_401[!_41]]) && (x[!_41] = x[j[@i_401[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_165[!_41]], x[!_41]) = mult(y[@i_165[@i_395[!_41]]], x[@i_395[!_41]])) to (((y[@i_165[!_41]] = y[@i_165[@i_395[!_41]]]) && (x[!_41] = x[@i_395[!_41]])) || ((y[@i_165[!_41]] = x[@i_395[!_41]]) && (x[!_41] = y[@i_165[@i_395[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_165[!_41]], x[!_41]) = mult(y[@i_165[@i_394[!_41]]], x[@i_394[!_41]])) to (((y[@i_165[!_41]] = y[@i_165[@i_394[!_41]]]) && (x[!_41] = x[@i_394[!_41]])) || ((y[@i_165[!_41]] = x[@i_394[!_41]]) && (x[!_41] = y[@i_165[@i_394[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(x[j[!_42]], y[!_42]) = mult(x[j[@i_332[!_42]]], y[@i_332[!_42]])) to (((x[j[!_42]] = x[j[@i_332[!_42]]]) && (y[!_42] = y[@i_332[!_42]])) || ((x[j[!_42]] = y[@i_332[!_42]]) && (y[!_42] = x[j[@i_332[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(x[j[@i_331[!_42]]], y[@i_331[!_42]])) to (((x[j[!_42]] = x[j[@i_331[!_42]]]) && (y[!_42] = y[@i_331[!_42]])) || ((x[j[!_42]] = y[@i_331[!_42]]) && (y[!_42] = x[j[@i_331[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(y[@i_165[@i_325[!_42]]], x[@i_325[!_42]])) to (((x[j[!_42]] = y[@i_165[@i_325[!_42]]]) && (y[!_42] = x[@i_325[!_42]])) || ((x[j[!_42]] = x[@i_325[!_42]]) && (y[!_42] = y[@i_165[@i_325[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(y[@i_165[@i_324[!_42]]], x[@i_324[!_42]])) to (((x[j[!_42]] = y[@i_165[@i_324[!_42]]]) && (y[!_42] = x[@i_324[!_42]])) || ((x[j[!_42]] = x[@i_324[!_42]]) && (y[!_42] = y[@i_165[@i_324[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(x[j[@i_342[!_42]]], y[@i_342[!_42]])) to (((x[j[!_42]] = x[j[@i_342[!_42]]]) && (y[!_42] = y[@i_342[!_42]])) || ((x[j[!_42]] = y[@i_342[!_42]]) && (y[!_42] = x[j[@i_342[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(x[j[@i_341[!_42]]], y[@i_341[!_42]])) to (((x[j[!_42]] = x[j[@i_341[!_42]]]) && (y[!_42] = y[@i_341[!_42]])) || ((x[j[!_42]] = y[@i_341[!_42]]) && (y[!_42] = x[j[@i_341[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(y[@i_165[@i_335[!_42]]], x[@i_335[!_42]])) to (((x[j[!_42]] = y[@i_165[@i_335[!_42]]]) && (y[!_42] = x[@i_335[!_42]])) || ((x[j[!_42]] = x[@i_335[!_42]]) && (y[!_42] = y[@i_165[@i_335[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(y[@i_165[@i_334[!_42]]], x[@i_334[!_42]])) to (((x[j[!_42]] = y[@i_165[@i_334[!_42]]]) && (y[!_42] = x[@i_334[!_42]])) || ((x[j[!_42]] = x[@i_334[!_42]]) && (y[!_42] = y[@i_165[@i_334[!_42]]]))) Probability: 1. / |exponent| * NS
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_55: host, x2_54: host, x3_53: G, x4_52: G, x5_51: G) -> let x1: host = x1_55 in let x2: host = x2_54 in let x3: G = x3_53 in let x4: G = x4_52 in let x5: G = x5_51 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_60: host, x2_59: host, x3_58: G, x4_57: G, x5_56: G) -> let x1: host = x1_60 in let x2: host = x2_59 in let x3: G = x3_58 in let x4: G = x4_57 in let x5: G = x5_56 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_62: G, @2_ke_61: passwd) := let @2_x: G = @2_x_62 in let @2_ke: passwd = @2_ke_61 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_64: G, @2_kd_63: passwd) := let @2_m: G = @2_m_64 in let @2_kd: passwd = @2_kd_63 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_7 <= @1_N new @1_x: exponent; @1_OX() := exp(g, @1_x)
<=(0)=>
      ! !_8 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... No change.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_55: host, x2_54: host, x3_53: G, x4_52: G, x5_51: G) -> let x1: host = x1_55 in let x2: host = x2_54 in let x3: G = x3_53 in let x4: G = x4_52 in let x5: G = x5_51 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_60: host, x2_59: host, x3_58: G, x4_57: G, x5_56: G) -> let x1: host = x1_60 in let x2: host = x2_59 in let x3: G = x3_58 in let x4: G = x4_57 in let x5: G = x5_56 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_62: G, @2_ke_61: passwd) := let @2_x: G = @2_x_62 in let @2_ke: passwd = @2_ke_61 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_64: G, @2_kd_63: passwd) := let @2_m: G = @2_m_64 in let @2_kd: passwd = @2_kd_63 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_7 <= @1_N new @1_x: exponent; @1_OX() := exp(g, @1_x)
<=(0)=>
      ! !_8 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... No change.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_55: host, x2_54: host, x3_53: G, x4_52: G, x5_51: G) -> let x1: host = x1_55 in let x2: host = x2_54 in let x3: G = x3_53 in let x4: G = x4_52 in let x5: G = x5_51 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_60: host, x2_59: host, x3_58: G, x4_57: G, x5_56: G) -> let x1: host = x1_60 in let x2: host = x2_59 in let x3: G = x3_58 in let x4: G = x4_57 in let x5: G = x5_56 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_62: G, @2_ke_61: passwd) := let @2_x: G = @2_x_62 in let @2_ke: passwd = @2_ke_61 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_64: G, @2_kd_63: passwd) := let @2_m: G = @2_m_64 in let @2_kd: passwd = @2_kd_63 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_7 <= @1_N new @1_x: exponent; @1_OX() := exp(g, @1_x)
<=(0)=>
      ! !_8 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
... Failed.
Doing SA rename K_u... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Eliminated collisions between y and @1_x_535 Probability: NS * qD / |exponent|
Eliminated collisions between y and @1_x_650 Probability: NS * NU / |exponent|
Reduced (mult(x[j[!_42]], y[!_42]) = mult(@1_x_535[@i_171[j[!_42]]], x[j[!_42]])) to (((x[j[!_42]] = @1_x_535[@i_171[j[!_42]]]) && (y[!_42] = x[j[!_42]])) || ((x[j[!_42]] = x[j[!_42]]) && (y[!_42] = @1_x_535[@i_171[j[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(@1_x_650[@i_168[j[!_42]]], x[j[!_42]])) to (((x[j[!_42]] = @1_x_650[@i_168[j[!_42]]]) && (y[!_42] = x[j[!_42]])) || ((x[j[!_42]] = x[j[!_42]]) && (y[!_42] = @1_x_650[@i_168[j[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(@1_x_650[j[!_42]], x[j[!_42]])) to (((x[j[!_42]] = @1_x_650[j[!_42]]) && (y[!_42] = x[j[!_42]])) || ((x[j[!_42]] = x[j[!_42]]) && (y[!_42] = @1_x_650[j[!_42]]))) Probability: 1. / |exponent| * NS
Done.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
with x, @1_x_535... Failed.
Doing remove assignments of binder K_s... Done.
Doing remove assignments of binder K_u_790... Done.
Doing remove assignments of binder K_u_787... Done.
Doing remove assignments of binder K_u_788... Done.
Doing remove assignments of binder K_u_789... Done.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
with @1_x_650, y, x, @1_x_535... Eliminated collisions between @1_x_650 and @1_x_650 Probability: 0.5 * NU * NU / |exponent|
Eliminated collisions between @1_x_535 and @1_x_535 Probability: 0.5 * qD * qD / |exponent|
Eliminated collisions between @1_x_650 and @1_x_535 Probability: NU * qD / |exponent|
Succeeded.
Doing simplify... Run simplify 3 time(s). Maximum reached.
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
Proved one-session secrecy of sk_u
Proved secrecy of sk_u
Proved one-session secrecy of sk_s
Proved secrecy of sk_s
Proved query event inj:termS(x, X, y, Y, a, k) ==> inj:termU(x, X, y, Y, a, k)
Proved query event termS(x, X, y, Y, a, k) && termU(x, X, y, Y, a, k') ==> (k = k')
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_55: host, x2_54: host, x3_53: G, x4_52: G, x5_51: G) -> let x1: host = x1_55 in let x2: host = x2_54 in let x3: G = x3_53 in let x4: G = x4_52 in let x5: G = x5_51 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_60: host, x2_59: host, x3_58: G, x4_57: G, x5_56: G) -> let x1: host = x1_60 in let x2: host = x2_59 in let x3: G = x3_58 in let x4: G = x4_57 in let x5: G = x5_56 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_62: G, @2_ke_61: passwd) := let @2_x: G = @2_x_62 in let @2_ke: passwd = @2_ke_61 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_64: G, @2_kd_63: passwd) := let @2_m: G = @2_m_64 in let @2_kd: passwd = @2_kd_63 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Succeeded.
Doing simplify... Run simplify 3 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_55: host, x2_54: host, x3_53: G, x4_52: G, x5_51: G) -> let x1: host = x1_55 in let x2: host = x2_54 in let x3: G = x3_53 in let x4: G = x4_52 in let x5: G = x5_51 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_60: host, x2_59: host, x3_58: G, x4_57: G, x5_56: G) -> let x1: host = x1_60 in let x2: host = x2_59 in let x3: G = x3_58 in let x4: G = x4_57 in let x5: G = x5_56 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_62: G, @2_ke_61: passwd) := let @2_x: G = @2_x_62 in let @2_ke: passwd = @2_ke_61 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_64: G, @2_kd_63: passwd) := let @2_m: G = @2_m_64 in let @2_kd: passwd = @2_kd_63 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_55: host, x2_54: host, x3_53: G, x4_52: G, x5_51: G) -> let x1: host = x1_55 in let x2: host = x2_54 in let x3: G = x3_53 in let x4: G = x4_52 in let x5: G = x5_51 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_60: host, x2_59: host, x3_58: G, x4_57: G, x5_56: G) -> let x1: host = x1_60 in let x2: host = x2_59 in let x3: G = x3_58 in let x4: G = x4_57 in let x5: G = x5_56 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_62: G, @2_ke_61: passwd) := let @2_x: G = @2_x_62 in let @2_ke: passwd = @2_ke_61 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_64: G, @2_kd_63: passwd) := let @2_m: G = @2_m_64 in let @2_kd: passwd = @2_kd_63 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Succeeded.
Doing simplify... Run simplify 3 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_55: host, x2_54: host, x3_53: G, x4_52: G, x5_51: G) -> let x1: host = x1_55 in let x2: host = x2_54 in let x3: G = x3_53 in let x4: G = x4_52 in let x5: G = x5_51 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_60: host, x2_59: host, x3_58: G, x4_57: G, x5_56: G) -> let x1: host = x1_60 in let x2: host = x2_59 in let x3: G = x3_58 in let x4: G = x4_57 in let x5: G = x5_56 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_62: G, @2_ke_61: passwd) := let @2_x: G = @2_x_62 in let @2_ke: passwd = @2_ke_61 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_64: G, @2_kd_63: passwd) := let @2_m: G = @2_m_64 in let @2_kd: passwd = @2_kd_63 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_7 <= @1_N new @1_x: exponent; @1_OX() := exp(g, @1_x)
<=(0)=>
      ! !_8 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
... Failed.
===================== Proof starts =======================
Initial state
Game 1 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
  let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
  event termU(U, X, S, Ystar_u, auth_u, sk_u);
  out(c6[!_41], auth_u)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  let K_s: G = exp(X_s, y) in
  if (auth_s = h1(U, S, X_s, Y, K_s)) then
  let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
  event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_43], enc(@2_x, @2_ke))
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_44], dec(@2_m, @2_kd))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_45], h0(x1, x2, x3, x4, x5))
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  out(c21[!_46], h1(x11, x12, x13, x14, x15))
)


Applying simplify yields

Game 2 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
  let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
  event termU(U, X, S, Ystar_u, auth_u, sk_u);
  out(c6[!_41], auth_u)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  if (auth_s = h1(U, S, X_s, Y, K_s)) then
  let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
  event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_43], enc(@2_x, @2_ke))
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_44], dec(@2_m, @2_kd))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_45], h0(x1, x2, x3, x4, x5))
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  out(c21[!_46], h1(x11, x12, x13, x14, x15))
)


Applying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_55: host, x2_54: host, x3_53: G, x4_52: G, x5_51: G) -> let x1: host = x1_55 in let x2: host = x2_54 in let x3: G = x3_53 in let x4: G = x4_52 in let x5: G = x5_51 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
 yields

Game 3 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_82: host = U in
  let x2_81: host = S in
  let x3_80: G = X in
  let x4_79: G = Y_u in
  let x5_78: G = K_u in
  find [unique] @i_91 <= qH1 suchthat defined(x1_70[@i_91], x2_69[@i_91], x3_68[@i_91], x4_67[@i_91], x5_66[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x1_70[@i_91]) && ((x2_81 = x2_69[@i_91]) && ((x3_80 = x3_68[@i_91]) && ((x4_79 = x4_67[@i_91]) && (x5_78 = x5_66[@i_91]))))) then
  (
    let auth_u: hash1 = r1_65[@i_91] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  orfind @i_90 <= NS suchthat defined(x1_76[@i_90], x2_75[@i_90], x3_74[@i_90], x4_73[@i_90], x5_72[@i_90], r1_71[@i_90]) && otheruses(r1_71[@i_90]) && ((x1_82 = x1_76[@i_90]) && ((x2_81 = x2_75[@i_90]) && ((x3_80 = x3_74[@i_90]) && ((x4_79 = x4_73[@i_90]) && (x5_78 = x5_72[@i_90]))))) then
  (
    let auth_u: hash1 = r1_71[@i_90] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  orfind @i_89 <= NU suchthat defined(x1_82[@i_89], x2_81[@i_89], x3_80[@i_89], x4_79[@i_89], x5_78[@i_89], r1_77[@i_89]) && otheruses(r1_77[@i_89]) && ((x1_82 = x1_82[@i_89]) && ((x2_81 = x2_81[@i_89]) && ((x3_80 = x3_80[@i_89]) && ((x4_79 = x4_79[@i_89]) && (x5_78 = x5_78[@i_89]))))) then
  (
    let auth_u: hash1 = r1_77[@i_89] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  else
    new r1_77: hash1;
    let auth_u: hash1 = r1_77 in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  let x3_74: G = X_s in
  let x4_73: G = Y in
  let x5_72: G = K_s in
  find [unique] @i_88 <= qH1 suchthat defined(x1_70[@i_88], x2_69[@i_88], x3_68[@i_88], x4_67[@i_88], x5_66[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x1_70[@i_88]) && ((x2_75 = x2_69[@i_88]) && ((x3_74 = x3_68[@i_88]) && ((x4_73 = x4_67[@i_88]) && (x5_72 = x5_66[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_87 <= NS suchthat defined(x1_76[@i_87], x2_75[@i_87], x3_74[@i_87], x4_73[@i_87], x5_72[@i_87], r1_71[@i_87]) && otheruses(r1_71[@i_87]) && ((x1_76 = x1_76[@i_87]) && ((x2_75 = x2_75[@i_87]) && ((x3_74 = x3_74[@i_87]) && ((x4_73 = x4_73[@i_87]) && (x5_72 = x5_72[@i_87]))))) then
  (
    if (auth_s = r1_71[@i_87]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_86 <= NU suchthat defined(x1_82[@i_86], x2_81[@i_86], x3_80[@i_86], x4_79[@i_86], x5_78[@i_86], r1_77[@i_86]) && otheruses(r1_77[@i_86]) && ((x1_76 = x1_82[@i_86]) && ((x2_75 = x2_81[@i_86]) && ((x3_74 = x3_80[@i_86]) && ((x4_73 = x4_79[@i_86]) && (x5_72 = x5_78[@i_86]))))) then
  (
    if (auth_s = r1_77[@i_86]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  else
    new r1_71: hash1;
    if (auth_s = r1_71) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_43], enc(@2_x, @2_ke))
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_44], dec(@2_m, @2_kd))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_45], h0(x1, x2, x3, x4, x5))
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_70: host = x11 in
  let x2_69: host = x12 in
  let x3_68: G = x13 in
  let x4_67: G = x14 in
  let x5_66: G = x15 in
  find [unique] @i_85 <= qH1 suchthat defined(x1_70[@i_85], x2_69[@i_85], x3_68[@i_85], x4_67[@i_85], x5_66[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x1_70 = x1_70[@i_85]) && ((x2_69 = x2_69[@i_85]) && ((x3_68 = x3_68[@i_85]) && ((x4_67 = x4_67[@i_85]) && (x5_66 = x5_66[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_84 <= NS suchthat defined(x1_76[@i_84], x2_75[@i_84], x3_74[@i_84], x4_73[@i_84], x5_72[@i_84], r1_71[@i_84]) && otheruses(r1_71[@i_84]) && ((x1_70 = x1_76[@i_84]) && ((x2_69 = x2_75[@i_84]) && ((x3_68 = x3_74[@i_84]) && ((x4_67 = x4_73[@i_84]) && (x5_66 = x5_72[@i_84]))))) then
    out(c21[!_46], r1_71[@i_84])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], x3_80[@i_83], x4_79[@i_83], x5_78[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x1_70 = x1_82[@i_83]) && ((x2_69 = x2_81[@i_83]) && ((x3_68 = x3_80[@i_83]) && ((x4_67 = x4_79[@i_83]) && (x5_66 = x5_78[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying simplify [Excluding set(dist 3->4, proba <= 1. / |exponent| * NS + NS / |hash1| + 0.5 * NU * NU / |exponent| + 0.5 * NS * NS / |exponent|)] yields

Game 4 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_82: host = U in
  let x2_81: host = S in
  let x3_80: G = X in
  let x4_79: G = Y_u in
  let x5_78: G = K_u in
  find [unique] @i_91 <= qH1 suchthat defined(x1_70[@i_91], x2_69[@i_91], x3_68[@i_91], x4_67[@i_91], x5_66[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x1_70[@i_91]) && ((x2_81 = x2_69[@i_91]) && ((x3_80 = x3_68[@i_91]) && ((x4_79 = x4_67[@i_91]) && (x5_78 = x5_66[@i_91]))))) then
  (
    let auth_u: hash1 = r1_65[@i_91] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  else
    new r1_77: hash1;
    let auth_u: hash1 = r1_77 in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  let x3_74: G = X_s in
  let x4_73: G = Y in
  let x5_72: G = K_s in
  find [unique] @i_88 <= qH1 suchthat defined(x1_70[@i_88], x2_69[@i_88], x3_68[@i_88], x4_67[@i_88], x5_66[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x1_70[@i_88]) && ((x2_75 = x2_69[@i_88]) && ((x3_74 = x3_68[@i_88]) && ((x4_73 = x4_67[@i_88]) && (x5_72 = x5_66[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind  suchthat defined(x4_79[j], x5_78[j], r1_77[j]) && otheruses(r1_77[j]) && ((x4_73 = x4_79[j]) && (x5_72 = x5_78[j])) then
  (
    let @i_86 <= NU = j in
    if (auth_s = r1_77[j]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_43], enc(@2_x, @2_ke))
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_44], dec(@2_m, @2_kd))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_45], h0(x1, x2, x3, x4, x5))
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_70: host = x11 in
  let x2_69: host = x12 in
  let x3_68: G = x13 in
  let x4_67: G = x14 in
  let x5_66: G = x15 in
  find [unique] @i_85 <= qH1 suchthat defined(x1_70[@i_85], x2_69[@i_85], x3_68[@i_85], x4_67[@i_85], x5_66[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x1_70 = x1_70[@i_85]) && ((x2_69 = x2_69[@i_85]) && ((x3_68 = x3_68[@i_85]) && ((x4_67 = x4_67[@i_85]) && (x5_66 = x5_66[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], x3_80[@i_83], x4_79[@i_83], x5_78[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x1_70 = x1_82[@i_83]) && ((x2_69 = x2_81[@i_83]) && ((x3_68 = x3_80[@i_83]) && ((x4_67 = x4_79[@i_83]) && (x5_66 = x5_78[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying move all binders yields

Game 5 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_82: host = U in
  let x2_81: host = S in
  let x3_80: G = X in
  let x4_79: G = Y_u in
  let x5_78: G = K_u in
  find [unique] @i_91 <= qH1 suchthat defined(x1_70[@i_91], x2_69[@i_91], x3_68[@i_91], x4_67[@i_91], x5_66[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x1_70[@i_91]) && ((x2_81 = x2_69[@i_91]) && ((x3_80 = x3_68[@i_91]) && ((x4_79 = x4_67[@i_91]) && (x5_78 = x5_66[@i_91]))))) then
  (
    let auth_u: hash1 = r1_65[@i_91] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  else
    new r1_77: hash1;
    let auth_u: hash1 = r1_77 in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  let x3_74: G = X_s in
  let x4_73: G = Y in
  let x5_72: G = K_s in
  find [unique] @i_88 <= qH1 suchthat defined(x1_70[@i_88], x2_69[@i_88], x3_68[@i_88], x4_67[@i_88], x5_66[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x1_70[@i_88]) && ((x2_75 = x2_69[@i_88]) && ((x3_74 = x3_68[@i_88]) && ((x4_73 = x4_67[@i_88]) && (x5_72 = x5_66[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind  suchthat defined(x4_79[j], x5_78[j], r1_77[j]) && otheruses(r1_77[j]) && ((x4_73 = x4_79[j]) && (x5_72 = x5_78[j])) then
  (
    if (auth_s = r1_77[j]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_43], enc(@2_x, @2_ke))
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_44], dec(@2_m, @2_kd))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_45], h0(x1, x2, x3, x4, x5))
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_70: host = x11 in
  let x2_69: host = x12 in
  let x3_68: G = x13 in
  let x4_67: G = x14 in
  let x5_66: G = x15 in
  find [unique] @i_85 <= qH1 suchthat defined(x1_70[@i_85], x2_69[@i_85], x3_68[@i_85], x4_67[@i_85], x5_66[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x1_70 = x1_70[@i_85]) && ((x2_69 = x2_69[@i_85]) && ((x3_68 = x3_68[@i_85]) && ((x4_67 = x4_67[@i_85]) && (x5_66 = x5_66[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], x3_80[@i_83], x4_79[@i_83], x5_78[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x1_70 = x1_82[@i_83]) && ((x2_69 = x2_81[@i_83]) && ((x3_68 = x3_80[@i_83]) && ((x4_67 = x4_79[@i_83]) && (x5_66 = x5_78[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying remove assignments of useless yields

Game 6 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_82: host = U in
  let x2_81: host = S in
  let x3_80: G = cst_G in
  let x4_79: G = cst_G in
  let x5_78: G = cst_G in
  find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], x5_66[@i_91], x4_67[@i_91], x3_68[@i_91], x2_69[@i_91], x1_70[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y_u = x14[@i_91]) && (K_u = x15[@i_91]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
    out(c6[!_41], r1_65[@i_91])
  )
  else
    new r1_77: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_77, sk_u);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], x5_66[@i_88], x4_67[@i_88], x3_68[@i_88], x2_69[@i_88], x1_70[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind  suchthat defined(Y_u[j], K_u[j], x5_78[j], x4_79[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
  (
    if (auth_s = r1_77[j]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_43], enc(@2_x, @2_ke))
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_44], dec(@2_m, @2_kd))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_45], h0(x1, x2, x3, x4, x5))
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_70: host = cst_host in
  let x2_69: host = cst_host in
  let x3_68: G = cst_G in
  let x4_67: G = cst_G in
  let x5_66: G = cst_G in
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], x5_66[@i_85], x4_67[@i_85], x3_68[@i_85], x2_69[@i_85], x1_70[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(X[@i_83], Y_u[@i_83], K_u[@i_83], x5_78[@i_83], x4_79[@i_83], x3_80[@i_83], x1_82[@i_83], x2_81[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_62: G, @2_ke_61: passwd) := let @2_x: G = @2_x_62 in let @2_ke: passwd = @2_ke_61 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_64: G, @2_kd_63: passwd) := let @2_m: G = @2_m_64 in let @2_kd: passwd = @2_kd_63 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
 [Excluding set(dist 6->7, proba <= (NS * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * qE + -1. * NU + -1. * qD) / |G|)] yields

Game 7 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_139: G = Ystar_u in
  let @2_kd_138: passwd = pw in
  find [unique] @i_171 <= qD suchthat defined(@2_r4_128[@i_171], @2_m_130[@i_171], @2_kd_129[@i_171]) && otheruses(@2_m_130[@i_171] -> @2_r4_128[@i_171]) && ((@2_m_139 = @2_m_130[@i_171]) && (@2_kd_138 = @2_kd_129[@i_171])) then
  (
    let Y_u: G = @2_r4_128[@i_171] in
    let K_u: G = exp(Y_u, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    let x3_80: G = cst_G in
    let x4_79: G = cst_G in
    let x5_78: G = cst_G in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], x5_66[@i_91], x4_67[@i_91], x3_68[@i_91], x2_69[@i_91], x1_70[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y_u = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(@2_r4_137[@i_168], @2_m_139[@i_168], @2_kd_138[@i_168]) && otheruses(@2_m_139[@i_168] -> @2_r4_137[@i_168]) && ((@2_m_139 = @2_m_139[@i_168]) && (@2_kd_138 = @2_kd_138[@i_168])) then
  (
    let Y_u: G = @2_r4_137[@i_168] in
    let K_u: G = exp(Y_u, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    let x3_80: G = cst_G in
    let x4_79: G = cst_G in
    let x5_78: G = cst_G in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], x5_66[@i_91], x4_67[@i_91], x3_68[@i_91], x2_69[@i_91], x1_70[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y_u = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_x_133[@i_166], @2_ke_132[@i_166], @2_r2_131[@i_166]) && otheruses(@2_x_133[@i_166] -> @2_r2_131[@i_166]) && ((@2_m_139 = @2_r2_131[@i_166]) && (@2_kd_138 = @2_ke_132[@i_166])) then
  (
    let Y_u: G = @2_x_133[@i_166] in
    let K_u: G = exp(Y_u, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    let x3_80: G = cst_G in
    let x4_79: G = cst_G in
    let x5_78: G = cst_G in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], x5_66[@i_91], x4_67[@i_91], x3_68[@i_91], x2_69[@i_91], x1_70[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y_u = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  orfind @i_165 <= NS suchthat defined(@2_x_136[@i_165], @2_ke_135[@i_165], @2_r2_134[@i_165]) && otheruses(@2_x_136[@i_165] -> @2_r2_134[@i_165]) && ((@2_m_139 = @2_r2_134[@i_165]) && (@2_kd_138 = @2_ke_135[@i_165])) then
  (
    let Y_u: G = @2_x_136[@i_165] in
    let K_u: G = exp(Y_u, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    let x3_80: G = cst_G in
    let x4_79: G = cst_G in
    let x5_78: G = cst_G in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], x5_66[@i_91], x4_67[@i_91], x3_68[@i_91], x2_69[@i_91], x1_70[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y_u = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  else
    new @2_r4_137: G;
    let Y_u: G = @2_r4_137 in
    let K_u: G = exp(Y_u, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    let x3_80: G = cst_G in
    let x4_79: G = cst_G in
    let x5_78: G = cst_G in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], x5_66[@i_91], x4_67[@i_91], x3_68[@i_91], x2_69[@i_91], x1_70[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y_u = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_136: G = Y in
  let @2_ke_135: passwd = pw in
  find [unique] @i_163 <= qD suchthat defined(@2_r4_128[@i_163], @2_m_130[@i_163], @2_kd_129[@i_163]) && otheruses(@2_m_130[@i_163] -> @2_r4_128[@i_163]) && ((@2_x_136 = @2_r4_128[@i_163]) && (@2_ke_135 = @2_kd_129[@i_163])) then
  (
    let Ystar: G = @2_m_130[@i_163] in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_76: host = U in
    let x2_75: host = S in
    find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], x5_66[@i_88], x4_67[@i_88], x3_68[@i_88], x2_69[@i_88], x1_70[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
    (
      if (auth_s = r1_65[@i_88]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], x5_78[j], x4_79[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_77[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  orfind @i_160 <= NU suchthat defined(@2_r4_137[@i_160], @2_m_139[@i_160], @2_kd_138[@i_160]) && otheruses(@2_m_139[@i_160] -> @2_r4_137[@i_160]) && ((@2_x_136 = @2_r4_137[@i_160]) && (@2_ke_135 = @2_kd_138[@i_160])) then
  (
    let Ystar: G = @2_m_139[@i_160] in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_76: host = U in
    let x2_75: host = S in
    find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], x5_66[@i_88], x4_67[@i_88], x3_68[@i_88], x2_69[@i_88], x1_70[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
    (
      if (auth_s = r1_65[@i_88]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], x5_78[j], x4_79[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_77[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  orfind @i_158 <= qE suchthat defined(@2_x_133[@i_158], @2_ke_132[@i_158], @2_r2_131[@i_158]) && otheruses(@2_x_133[@i_158] -> @2_r2_131[@i_158]) && ((@2_x_136 = @2_x_133[@i_158]) && (@2_ke_135 = @2_ke_132[@i_158])) then
  (
    let Ystar: G = @2_r2_131[@i_158] in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_76: host = U in
    let x2_75: host = S in
    find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], x5_66[@i_88], x4_67[@i_88], x3_68[@i_88], x2_69[@i_88], x1_70[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
    (
      if (auth_s = r1_65[@i_88]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], x5_78[j], x4_79[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_77[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  orfind @i_157 <= NS suchthat defined(@2_x_136[@i_157], @2_ke_135[@i_157], @2_r2_134[@i_157]) && otheruses(@2_x_136[@i_157] -> @2_r2_134[@i_157]) && ((@2_x_136 = @2_x_136[@i_157]) && (@2_ke_135 = @2_ke_135[@i_157])) then
  (
    let Ystar: G = @2_r2_134[@i_157] in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_76: host = U in
    let x2_75: host = S in
    find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], x5_66[@i_88], x4_67[@i_88], x3_68[@i_88], x2_69[@i_88], x1_70[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
    (
      if (auth_s = r1_65[@i_88]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], x5_78[j], x4_79[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_77[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    new @2_r2_134: G;
    let Ystar: G = @2_r2_134 in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_76: host = U in
    let x2_75: host = S in
    find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], x5_66[@i_88], x4_67[@i_88], x3_68[@i_88], x2_69[@i_88], x1_70[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
    (
      if (auth_s = r1_65[@i_88]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], x5_78[j], x4_79[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_77[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  let @2_x_133: G = @2_x in
  let @2_ke_132: passwd = @2_ke in
  find [unique] @i_155 <= qD suchthat defined(@2_r4_128[@i_155], @2_m_130[@i_155], @2_kd_129[@i_155]) && otheruses(@2_m_130[@i_155] -> @2_r4_128[@i_155]) && ((@2_x_133 = @2_r4_128[@i_155]) && (@2_ke_132 = @2_kd_129[@i_155])) then
    out(@2_c2[!_43], @2_m_130[@i_155])
  orfind @i_152 <= NU suchthat defined(@2_r4_137[@i_152], @2_m_139[@i_152], @2_kd_138[@i_152]) && otheruses(@2_m_139[@i_152] -> @2_r4_137[@i_152]) && ((@2_x_133 = @2_r4_137[@i_152]) && (@2_ke_132 = @2_kd_138[@i_152])) then
    out(@2_c2[!_43], @2_m_139[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x_133[@i_150], @2_ke_132[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x_133[@i_150] -> @2_r2_131[@i_150]) && ((@2_x_133 = @2_x_133[@i_150]) && (@2_ke_132 = @2_ke_132[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(@2_x_136[@i_149], @2_ke_135[@i_149], @2_r2_134[@i_149]) && otheruses(@2_x_136[@i_149] -> @2_r2_134[@i_149]) && ((@2_x_133 = @2_x_136[@i_149]) && (@2_ke_132 = @2_ke_135[@i_149])) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  let @2_m_130: G = @2_m in
  let @2_kd_129: passwd = @2_kd in
  find [unique] @i_147 <= qD suchthat defined(@2_r4_128[@i_147], @2_m_130[@i_147], @2_kd_129[@i_147]) && otheruses(@2_m_130[@i_147] -> @2_r4_128[@i_147]) && ((@2_m_130 = @2_m_130[@i_147]) && (@2_kd_129 = @2_kd_129[@i_147])) then
    out(@2_c4[!_44], @2_r4_128[@i_147])
  orfind @i_144 <= NU suchthat defined(@2_r4_137[@i_144], @2_m_139[@i_144], @2_kd_138[@i_144]) && otheruses(@2_m_139[@i_144] -> @2_r4_137[@i_144]) && ((@2_m_130 = @2_m_139[@i_144]) && (@2_kd_129 = @2_kd_138[@i_144])) then
    out(@2_c4[!_44], @2_r4_137[@i_144])
  orfind @i_142 <= qE suchthat defined(@2_x_133[@i_142], @2_ke_132[@i_142], @2_r2_131[@i_142]) && otheruses(@2_x_133[@i_142] -> @2_r2_131[@i_142]) && ((@2_m_130 = @2_r2_131[@i_142]) && (@2_kd_129 = @2_ke_132[@i_142])) then
    out(@2_c4[!_44], @2_x_133[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_x_136[@i_141], @2_ke_135[@i_141], @2_r2_134[@i_141]) && otheruses(@2_x_136[@i_141] -> @2_r2_134[@i_141]) && ((@2_m_130 = @2_r2_134[@i_141]) && (@2_kd_129 = @2_ke_135[@i_141])) then
    out(@2_c4[!_44], @2_x_136[@i_141])
  else
    new @2_r4_128: G;
    out(@2_c4[!_44], @2_r4_128)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_45], h0(x1, x2, x3, x4, x5))
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_70: host = cst_host in
  let x2_69: host = cst_host in
  let x3_68: G = cst_G in
  let x4_67: G = cst_G in
  let x5_66: G = cst_G in
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], x5_66[@i_85], x4_67[@i_85], x3_68[@i_85], x2_69[@i_85], x1_70[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(X[@i_83], Y_u[@i_83], K_u[@i_83], x5_78[@i_83], x4_79[@i_83], x3_80[@i_83], x1_82[@i_83], x2_81[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying simplify [Excluding set(dist 7->8, proba <= qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G|)] yields

Game 8 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_139: G = Ystar_u in
  let @2_kd_138: passwd = pw in
  find [unique] @i_171 <= qD suchthat defined(@2_m_130[@i_171], @2_kd_129[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m_130[@i_171] -> @2_r4_128[@i_171]) && ((@2_m_139 = @2_m_130[@i_171]) && (@2_kd_138 = @2_kd_129[@i_171])) then
  (
    let Y_u: G = @2_r4_128[@i_171] in
    let K_u: G = exp(Y_u, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    let x3_80: G = cst_G in
    let x4_79: G = cst_G in
    let x5_78: G = cst_G in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y_u = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(@2_m_139[@i_168], @2_r4_137[@i_168]) && otheruses(@2_m_139[@i_168] -> @2_r4_137[@i_168]) && (@2_m_139 = @2_m_139[@i_168]) then
  (
    let Y_u: G = @2_r4_137[@i_168] in
    let K_u: G = exp(Y_u, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    let x3_80: G = cst_G in
    let x4_79: G = cst_G in
    let x5_78: G = cst_G in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y_u = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke_132[@i_166], @2_x_133[@i_166]) && otheruses(@2_x_133[@i_166] -> @2_r2_131[@i_166]) && ((@2_m_139 = @2_r2_131[@i_166]) && (@2_kd_138 = @2_ke_132[@i_166])) then
  (
    let Y_u: G = @2_x_133[@i_166] in
    let K_u: G = exp(Y_u, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    let x3_80: G = cst_G in
    let x4_79: G = cst_G in
    let x5_78: G = cst_G in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y_u = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], @2_x_136[@i_165], y[@i_165]) && otheruses(@2_x_136[@i_165] -> @2_r2_134[@i_165]) && (@2_m_139 = @2_r2_134[@i_165]) then
  (
    let Y_u: G = @2_x_136[@i_165] in
    let K_u: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    let x3_80: G = cst_G in
    let x4_79: G = cst_G in
    let x5_78: G = cst_G in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y_u = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  else
    new @2_r4_137: G;
    let Y_u: G = @2_r4_137 in
    let K_u: G = exp(Y_u, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    let x3_80: G = cst_G in
    let x4_79: G = cst_G in
    let x5_78: G = cst_G in
    new r1_77: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_77, sk_u);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_136: G = Y in
  let @2_ke_135: passwd = pw in
  new @2_r2_134: G;
  let Ystar: G = @2_r2_134 in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind  suchthat defined(Y_u[j], K_u[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
  (
    if (auth_s = r1_77[j]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  let @2_x_133: G = @2_x in
  let @2_ke_132: passwd = @2_ke in
  find [unique] @i_155 <= qD suchthat defined(@2_r4_128[@i_155], @2_kd_129[@i_155], @2_m_130[@i_155]) && otheruses(@2_m_130[@i_155] -> @2_r4_128[@i_155]) && ((@2_x_133 = @2_r4_128[@i_155]) && (@2_ke_132 = @2_kd_129[@i_155])) then
    out(@2_c2[!_43], @2_m_130[@i_155])
  orfind @i_152 <= NU suchthat defined(@2_r4_137[@i_152], @2_kd_138[@i_152], @2_m_139[@i_152]) && otheruses(@2_m_139[@i_152] -> @2_r4_137[@i_152]) && ((@2_x_133 = @2_r4_137[@i_152]) && (@2_ke_132 = @2_kd_138[@i_152])) then
    out(@2_c2[!_43], @2_m_139[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x_133[@i_150], @2_ke_132[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x_133[@i_150] -> @2_r2_131[@i_150]) && ((@2_x_133 = @2_x_133[@i_150]) && (@2_ke_132 = @2_ke_132[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(@2_x_136[@i_149], @2_ke_135[@i_149], @2_r2_134[@i_149]) && otheruses(@2_x_136[@i_149] -> @2_r2_134[@i_149]) && ((@2_x_133 = @2_x_136[@i_149]) && (@2_ke_132 = @2_ke_135[@i_149])) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  let @2_m_130: G = @2_m in
  let @2_kd_129: passwd = @2_kd in
  find [unique] @i_147 <= qD suchthat defined(@2_m_130[@i_147], @2_kd_129[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m_130[@i_147] -> @2_r4_128[@i_147]) && ((@2_m_130 = @2_m_130[@i_147]) && (@2_kd_129 = @2_kd_129[@i_147])) then
    out(@2_c4[!_44], @2_r4_128[@i_147])
  orfind @i_144 <= NU suchthat defined(@2_m_139[@i_144], @2_kd_138[@i_144], @2_r4_137[@i_144]) && otheruses(@2_m_139[@i_144] -> @2_r4_137[@i_144]) && ((@2_m_130 = @2_m_139[@i_144]) && (@2_kd_129 = @2_kd_138[@i_144])) then
    out(@2_c4[!_44], @2_r4_137[@i_144])
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke_132[@i_142], @2_x_133[@i_142]) && otheruses(@2_x_133[@i_142] -> @2_r2_131[@i_142]) && ((@2_m_130 = @2_r2_131[@i_142]) && (@2_kd_129 = @2_ke_132[@i_142])) then
    out(@2_c4[!_44], @2_x_133[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], @2_ke_135[@i_141], @2_x_136[@i_141]) && otheruses(@2_x_136[@i_141] -> @2_r2_134[@i_141]) && ((@2_m_130 = @2_r2_134[@i_141]) && (@2_kd_129 = @2_ke_135[@i_141])) then
    out(@2_c4[!_44], @2_x_136[@i_141])
  else
    new @2_r4_128: G;
    out(@2_c4[!_44], @2_r4_128)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_45], h0(x1, x2, x3, x4, x5))
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_70: host = cst_host in
  let x2_69: host = cst_host in
  let x3_68: G = cst_G in
  let x4_67: G = cst_G in
  let x5_66: G = cst_G in
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying move all binders yields

Game 9 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_139: G = Ystar_u in
  let @2_kd_138: passwd = pw in
  find [unique] @i_171 <= qD suchthat defined(@2_m_130[@i_171], @2_kd_129[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m_130[@i_171] -> @2_r4_128[@i_171]) && ((@2_m_139 = @2_m_130[@i_171]) && (@2_kd_138 = @2_kd_129[@i_171])) then
  (
    let Y_u: G = @2_r4_128[@i_171] in
    let K_u: G = exp(Y_u, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y_u = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(@2_m_139[@i_168], @2_r4_137[@i_168]) && otheruses(@2_m_139[@i_168] -> @2_r4_137[@i_168]) && (@2_m_139 = @2_m_139[@i_168]) then
  (
    let Y_u: G = @2_r4_137[@i_168] in
    let K_u: G = exp(Y_u, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y_u = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke_132[@i_166], @2_x_133[@i_166]) && otheruses(@2_x_133[@i_166] -> @2_r2_131[@i_166]) && ((@2_m_139 = @2_r2_131[@i_166]) && (@2_kd_138 = @2_ke_132[@i_166])) then
  (
    let Y_u: G = @2_x_133[@i_166] in
    let K_u: G = exp(Y_u, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y_u = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], @2_x_136[@i_165], y[@i_165]) && otheruses(@2_x_136[@i_165] -> @2_r2_134[@i_165]) && (@2_m_139 = @2_r2_134[@i_165]) then
  (
    let Y_u: G = @2_x_136[@i_165] in
    let K_u: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y_u = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  else
    new @2_r4_137: G;
    let Y_u: G = @2_r4_137 in
    let K_u: G = exp(Y_u, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    let x3_80: G = cst_G in
    let x4_79: G = cst_G in
    let x5_78: G = cst_G in
    new r1_77: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_77, sk_u);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_136: G = Y in
  let @2_ke_135: passwd = pw in
  new @2_r2_134: G;
  let Ystar: G = @2_r2_134 in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind  suchthat defined(Y_u[j], K_u[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
  (
    if (auth_s = r1_77[j]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  let @2_x_133: G = @2_x in
  let @2_ke_132: passwd = @2_ke in
  find [unique] @i_155 <= qD suchthat defined(@2_r4_128[@i_155], @2_kd_129[@i_155], @2_m_130[@i_155]) && otheruses(@2_m_130[@i_155] -> @2_r4_128[@i_155]) && ((@2_x_133 = @2_r4_128[@i_155]) && (@2_ke_132 = @2_kd_129[@i_155])) then
    out(@2_c2[!_43], @2_m_130[@i_155])
  orfind @i_152 <= NU suchthat defined(@2_r4_137[@i_152], @2_kd_138[@i_152], @2_m_139[@i_152]) && otheruses(@2_m_139[@i_152] -> @2_r4_137[@i_152]) && ((@2_x_133 = @2_r4_137[@i_152]) && (@2_ke_132 = @2_kd_138[@i_152])) then
    out(@2_c2[!_43], @2_m_139[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x_133[@i_150], @2_ke_132[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x_133[@i_150] -> @2_r2_131[@i_150]) && ((@2_x_133 = @2_x_133[@i_150]) && (@2_ke_132 = @2_ke_132[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(@2_x_136[@i_149], @2_ke_135[@i_149], @2_r2_134[@i_149]) && otheruses(@2_x_136[@i_149] -> @2_r2_134[@i_149]) && ((@2_x_133 = @2_x_136[@i_149]) && (@2_ke_132 = @2_ke_135[@i_149])) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  let @2_m_130: G = @2_m in
  let @2_kd_129: passwd = @2_kd in
  find [unique] @i_147 <= qD suchthat defined(@2_m_130[@i_147], @2_kd_129[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m_130[@i_147] -> @2_r4_128[@i_147]) && ((@2_m_130 = @2_m_130[@i_147]) && (@2_kd_129 = @2_kd_129[@i_147])) then
    out(@2_c4[!_44], @2_r4_128[@i_147])
  orfind @i_144 <= NU suchthat defined(@2_m_139[@i_144], @2_kd_138[@i_144], @2_r4_137[@i_144]) && otheruses(@2_m_139[@i_144] -> @2_r4_137[@i_144]) && ((@2_m_130 = @2_m_139[@i_144]) && (@2_kd_129 = @2_kd_138[@i_144])) then
    out(@2_c4[!_44], @2_r4_137[@i_144])
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke_132[@i_142], @2_x_133[@i_142]) && otheruses(@2_x_133[@i_142] -> @2_r2_131[@i_142]) && ((@2_m_130 = @2_r2_131[@i_142]) && (@2_kd_129 = @2_ke_132[@i_142])) then
    out(@2_c4[!_44], @2_x_133[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], @2_ke_135[@i_141], @2_x_136[@i_141]) && otheruses(@2_x_136[@i_141] -> @2_r2_134[@i_141]) && ((@2_m_130 = @2_r2_134[@i_141]) && (@2_kd_129 = @2_ke_135[@i_141])) then
    out(@2_c4[!_44], @2_x_136[@i_141])
  else
    new @2_r4_128: G;
    out(@2_c4[!_44], @2_r4_128)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_45], h0(x1, x2, x3, x4, x5))
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying remove assignments of useless yields

Game 10 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_139: G = cst_G in
  let @2_kd_138: passwd = cst_passwd in
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @2_kd_129[@i_171], @2_m_130[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @2_r4_128[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = @2_r4_128[@i_171] in
    let K_u: G = exp(@2_r4_128[@i_171], x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((@2_r4_128[@i_171] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_128[@i_171], K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_128[@i_171], K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @2_m_139[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @2_r4_137[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = @2_r4_137[@i_168] in
    let K_u: G = exp(@2_r4_137[@i_168], x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((@2_r4_137[@i_168] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_137[@i_168], K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_137[@i_168], K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_ke[@i_166], @2_x[@i_166], @2_x_133[@i_166], @2_ke_132[@i_166], @2_r2_131[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
  (
    let Y_u: G = @2_x[@i_166] in
    let K_u: G = exp(@2_x[@i_166], x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((@2_x[@i_166] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_x[@i_166], K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_x[@i_166], K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  orfind @i_165 <= NS suchthat defined(Y[@i_165], @2_x_136[@i_165], @2_r2_134[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y[@i_165], K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, Y[@i_165], K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  else
    new @2_r4_137: G;
    let Y_u: G = @2_r4_137 in
    let K_u: G = exp(@2_r4_137, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let sk_u: hash0 = h0(U, S, X, @2_r4_137, K_u) in
    event termU(U, X, S, Ystar_u, r1_77, sk_u);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_136: G = cst_G in
  let @2_ke_135: passwd = cst_passwd in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
  )
  orfind  suchthat defined(Y_u[j], K_u[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
  (
    if (auth_s = r1_77[j]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  let @2_x_133: G = cst_G in
  let @2_ke_132: passwd = cst_passwd in
  find [unique] @i_155 <= qD suchthat defined(@2_kd[@i_155], @2_m[@i_155], @2_m_130[@i_155], @2_kd_129[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @2_r4_128[@i_155]) && ((@2_x = @2_r4_128[@i_155]) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(pw, Ystar_u[@i_152], @2_m_139[@i_152], @2_kd_138[@i_152], @2_r4_137[@i_152]) && otheruses(Ystar_u[@i_152] -> @2_r4_137[@i_152]) && ((@2_x = @2_r4_137[@i_152]) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_ke_132[@i_150], @2_x_133[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], pw, @2_ke_135[@i_149], @2_x_136[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  let @2_m_130: G = cst_G in
  let @2_kd_129: passwd = cst_passwd in
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @2_kd_129[@i_147], @2_m_130[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @2_r4_128[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @2_r4_128[@i_147])
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], pw, @2_kd_138[@i_144], @2_m_139[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @2_r4_137[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], @2_r4_137[@i_144])
  orfind @i_142 <= qE suchthat defined(@2_ke[@i_142], @2_x[@i_142], @2_x_133[@i_142], @2_ke_132[@i_142], @2_r2_131[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(pw, Y[@i_141], @2_x_136[@i_141], @2_ke_135[@i_141], @2_r2_134[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @2_r4_128: G;
    out(@2_c4[!_44], @2_r4_128)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_45], h0(x1, x2, x3, x4, x5))
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying insert event Encrypt at occurrence 1105 [Excluding set(event Encrypt in game 11)] yields

Game 11 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_139: G = cst_G in
  let @2_kd_138: passwd = cst_passwd in
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @2_kd_129[@i_171], @2_m_130[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @2_r4_128[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = @2_r4_128[@i_171] in
    let K_u: G = exp(@2_r4_128[@i_171], x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((@2_r4_128[@i_171] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_128[@i_171], K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_128[@i_171], K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @2_m_139[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @2_r4_137[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = @2_r4_137[@i_168] in
    let K_u: G = exp(@2_r4_137[@i_168], x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((@2_r4_137[@i_168] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_137[@i_168], K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_137[@i_168], K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_ke[@i_166], @2_x[@i_166], @2_x_133[@i_166], @2_ke_132[@i_166], @2_r2_131[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(Y[@i_165], @2_x_136[@i_165], @2_r2_134[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y[@i_165], K_u) in
      event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
      out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let sk_u: hash0 = h0(U, S, X, Y[@i_165], K_u) in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
  )
  else
    new @2_r4_137: G;
    let Y_u: G = @2_r4_137 in
    let K_u: G = exp(@2_r4_137, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let sk_u: hash0 = h0(U, S, X, @2_r4_137, K_u) in
    event termU(U, X, S, Ystar_u, r1_77, sk_u);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_136: G = cst_G in
  let @2_ke_135: passwd = cst_passwd in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
  )
  orfind  suchthat defined(Y_u[j], K_u[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
  (
    if (auth_s = r1_77[j]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  let @2_x_133: G = cst_G in
  let @2_ke_132: passwd = cst_passwd in
  find [unique] @i_155 <= qD suchthat defined(@2_kd[@i_155], @2_m[@i_155], @2_m_130[@i_155], @2_kd_129[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @2_r4_128[@i_155]) && ((@2_x = @2_r4_128[@i_155]) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(pw, Ystar_u[@i_152], @2_m_139[@i_152], @2_kd_138[@i_152], @2_r4_137[@i_152]) && otheruses(Ystar_u[@i_152] -> @2_r4_137[@i_152]) && ((@2_x = @2_r4_137[@i_152]) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_ke_132[@i_150], @2_x_133[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], pw, @2_ke_135[@i_149], @2_x_136[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  let @2_m_130: G = cst_G in
  let @2_kd_129: passwd = cst_passwd in
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @2_kd_129[@i_147], @2_m_130[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @2_r4_128[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @2_r4_128[@i_147])
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], pw, @2_kd_138[@i_144], @2_m_139[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @2_r4_137[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], @2_r4_137[@i_144])
  orfind @i_142 <= qE suchthat defined(@2_ke[@i_142], @2_x[@i_142], @2_x_133[@i_142], @2_ke_132[@i_142], @2_r2_131[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(pw, Y[@i_141], @2_x_136[@i_141], @2_ke_135[@i_141], @2_r2_134[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @2_r4_128: G;
    out(@2_c4[!_44], @2_r4_128)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_45], h0(x1, x2, x3, x4, x5))
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_60: host, x2_59: host, x3_58: G, x4_57: G, x5_56: G) -> let x1: host = x1_60 in let x2: host = x2_59 in let x3: G = x3_58 in let x4: G = x4_57 in let x5: G = x5_56 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
 yields

Game 12 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_139: G = cst_G in
  let @2_kd_138: passwd = cst_passwd in
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @2_kd_129[@i_171], @2_m_130[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @2_r4_128[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = @2_r4_128[@i_171] in
    let K_u: G = exp(@2_r4_128[@i_171], x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((@2_r4_128[@i_171] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_289: host = U in
      let x2_288: host = S in
      let x3_287: G = X in
      let x4_286: G = @2_r4_128[@i_171] in
      let x5_285: G = K_u in
      find [unique] @i_373 <= qH0 suchthat defined(x1_259[@i_373], x2_258[@i_373], x3_257[@i_373], x4_256[@i_373], x5_255[@i_373], r_254[@i_373]) && otheruses(r_254[@i_373]) && ((x1_289 = x1_259[@i_373]) && ((x2_288 = x2_258[@i_373]) && ((x3_287 = x3_257[@i_373]) && ((x4_286 = x4_256[@i_373]) && (x5_285 = x5_255[@i_373]))))) then
      (
        let sk_u: hash0 = r_254[@i_373] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_372 <= NS suchthat defined(x1_265[@i_372], x2_264[@i_372], x3_263[@i_372], x4_262[@i_372], x5_261[@i_372], r_260[@i_372]) && otheruses(r_260[@i_372]) && ((x1_289 = x1_265[@i_372]) && ((x2_288 = x2_264[@i_372]) && ((x3_287 = x3_263[@i_372]) && ((x4_286 = x4_262[@i_372]) && (x5_285 = x5_261[@i_372]))))) then
      (
        let sk_u: hash0 = r_260[@i_372] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_371 <= NS suchthat defined(x1_271[@i_371], x2_270[@i_371], x3_269[@i_371], x4_268[@i_371], x5_267[@i_371], r_266[@i_371]) && otheruses(r_266[@i_371]) && ((x1_289 = x1_271[@i_371]) && ((x2_288 = x2_270[@i_371]) && ((x3_287 = x3_269[@i_371]) && ((x4_286 = x4_268[@i_371]) && (x5_285 = x5_267[@i_371]))))) then
      (
        let sk_u: hash0 = r_266[@i_371] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_370 <= NU suchthat defined(x1_277[@i_370], x2_276[@i_370], x3_275[@i_370], x4_274[@i_370], x5_273[@i_370], r_272[@i_370]) && otheruses(r_272[@i_370]) && ((x1_289 = x1_277[@i_370]) && ((x2_288 = x2_276[@i_370]) && ((x3_287 = x3_275[@i_370]) && ((x4_286 = x4_274[@i_370]) && (x5_285 = x5_273[@i_370]))))) then
      (
        let sk_u: hash0 = r_272[@i_370] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_369 <= NU suchthat defined(x1_283[@i_369], x2_282[@i_369], x3_281[@i_369], x4_280[@i_369], x5_279[@i_369], r_278[@i_369]) && otheruses(r_278[@i_369]) && ((x1_289 = x1_283[@i_369]) && ((x2_288 = x2_282[@i_369]) && ((x3_287 = x3_281[@i_369]) && ((x4_286 = x4_280[@i_369]) && (x5_285 = x5_279[@i_369]))))) then
      (
        let sk_u: hash0 = r_278[@i_369] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_368 <= NU suchthat defined(x1_289[@i_368], x2_288[@i_368], x3_287[@i_368], x4_286[@i_368], x5_285[@i_368], r_284[@i_368]) && otheruses(r_284[@i_368]) && ((x1_289 = x1_289[@i_368]) && ((x2_288 = x2_288[@i_368]) && ((x3_287 = x3_287[@i_368]) && ((x4_286 = x4_286[@i_368]) && (x5_285 = x5_285[@i_368]))))) then
      (
        let sk_u: hash0 = r_284[@i_368] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_367 <= NU suchthat defined(x1_295[@i_367], x2_294[@i_367], x3_293[@i_367], x4_292[@i_367], x5_291[@i_367], r_290[@i_367]) && otheruses(r_290[@i_367]) && ((x1_289 = x1_295[@i_367]) && ((x2_288 = x2_294[@i_367]) && ((x3_287 = x3_293[@i_367]) && ((x4_286 = x4_292[@i_367]) && (x5_285 = x5_291[@i_367]))))) then
      (
        let sk_u: hash0 = r_290[@i_367] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_366 <= NU suchthat defined(x1_301[@i_366], x2_300[@i_366], x3_299[@i_366], x4_298[@i_366], x5_297[@i_366], r_296[@i_366]) && otheruses(r_296[@i_366]) && ((x1_289 = x1_301[@i_366]) && ((x2_288 = x2_300[@i_366]) && ((x3_287 = x3_299[@i_366]) && ((x4_286 = x4_298[@i_366]) && (x5_285 = x5_297[@i_366]))))) then
      (
        let sk_u: hash0 = r_296[@i_366] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_365 <= NU suchthat defined(x1_307[@i_365], x2_306[@i_365], x3_305[@i_365], x4_304[@i_365], x5_303[@i_365], r_302[@i_365]) && otheruses(r_302[@i_365]) && ((x1_289 = x1_307[@i_365]) && ((x2_288 = x2_306[@i_365]) && ((x3_287 = x3_305[@i_365]) && ((x4_286 = x4_304[@i_365]) && (x5_285 = x5_303[@i_365]))))) then
      (
        let sk_u: hash0 = r_302[@i_365] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_364 <= NU suchthat defined(x1_313[@i_364], x2_312[@i_364], x3_311[@i_364], x4_310[@i_364], x5_309[@i_364], r_308[@i_364]) && otheruses(r_308[@i_364]) && ((x1_289 = x1_313[@i_364]) && ((x2_288 = x2_312[@i_364]) && ((x3_287 = x3_311[@i_364]) && ((x4_286 = x4_310[@i_364]) && (x5_285 = x5_309[@i_364]))))) then
      (
        let sk_u: hash0 = r_308[@i_364] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_284: hash0;
        let sk_u: hash0 = r_284 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let x1_283: host = U in
      let x2_282: host = S in
      let x3_281: G = X in
      let x4_280: G = @2_r4_128[@i_171] in
      let x5_279: G = K_u in
      find [unique] @i_363 <= qH0 suchthat defined(x1_259[@i_363], x2_258[@i_363], x3_257[@i_363], x4_256[@i_363], x5_255[@i_363], r_254[@i_363]) && otheruses(r_254[@i_363]) && ((x1_283 = x1_259[@i_363]) && ((x2_282 = x2_258[@i_363]) && ((x3_281 = x3_257[@i_363]) && ((x4_280 = x4_256[@i_363]) && (x5_279 = x5_255[@i_363]))))) then
      (
        let sk_u: hash0 = r_254[@i_363] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_362 <= NS suchthat defined(x1_265[@i_362], x2_264[@i_362], x3_263[@i_362], x4_262[@i_362], x5_261[@i_362], r_260[@i_362]) && otheruses(r_260[@i_362]) && ((x1_283 = x1_265[@i_362]) && ((x2_282 = x2_264[@i_362]) && ((x3_281 = x3_263[@i_362]) && ((x4_280 = x4_262[@i_362]) && (x5_279 = x5_261[@i_362]))))) then
      (
        let sk_u: hash0 = r_260[@i_362] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_361 <= NS suchthat defined(x1_271[@i_361], x2_270[@i_361], x3_269[@i_361], x4_268[@i_361], x5_267[@i_361], r_266[@i_361]) && otheruses(r_266[@i_361]) && ((x1_283 = x1_271[@i_361]) && ((x2_282 = x2_270[@i_361]) && ((x3_281 = x3_269[@i_361]) && ((x4_280 = x4_268[@i_361]) && (x5_279 = x5_267[@i_361]))))) then
      (
        let sk_u: hash0 = r_266[@i_361] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_360 <= NU suchthat defined(x1_277[@i_360], x2_276[@i_360], x3_275[@i_360], x4_274[@i_360], x5_273[@i_360], r_272[@i_360]) && otheruses(r_272[@i_360]) && ((x1_283 = x1_277[@i_360]) && ((x2_282 = x2_276[@i_360]) && ((x3_281 = x3_275[@i_360]) && ((x4_280 = x4_274[@i_360]) && (x5_279 = x5_273[@i_360]))))) then
      (
        let sk_u: hash0 = r_272[@i_360] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_359 <= NU suchthat defined(x1_283[@i_359], x2_282[@i_359], x3_281[@i_359], x4_280[@i_359], x5_279[@i_359], r_278[@i_359]) && otheruses(r_278[@i_359]) && ((x1_283 = x1_283[@i_359]) && ((x2_282 = x2_282[@i_359]) && ((x3_281 = x3_281[@i_359]) && ((x4_280 = x4_280[@i_359]) && (x5_279 = x5_279[@i_359]))))) then
      (
        let sk_u: hash0 = r_278[@i_359] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_358 <= NU suchthat defined(x1_289[@i_358], x2_288[@i_358], x3_287[@i_358], x4_286[@i_358], x5_285[@i_358], r_284[@i_358]) && otheruses(r_284[@i_358]) && ((x1_283 = x1_289[@i_358]) && ((x2_282 = x2_288[@i_358]) && ((x3_281 = x3_287[@i_358]) && ((x4_280 = x4_286[@i_358]) && (x5_279 = x5_285[@i_358]))))) then
      (
        let sk_u: hash0 = r_284[@i_358] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_357 <= NU suchthat defined(x1_295[@i_357], x2_294[@i_357], x3_293[@i_357], x4_292[@i_357], x5_291[@i_357], r_290[@i_357]) && otheruses(r_290[@i_357]) && ((x1_283 = x1_295[@i_357]) && ((x2_282 = x2_294[@i_357]) && ((x3_281 = x3_293[@i_357]) && ((x4_280 = x4_292[@i_357]) && (x5_279 = x5_291[@i_357]))))) then
      (
        let sk_u: hash0 = r_290[@i_357] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_356 <= NU suchthat defined(x1_301[@i_356], x2_300[@i_356], x3_299[@i_356], x4_298[@i_356], x5_297[@i_356], r_296[@i_356]) && otheruses(r_296[@i_356]) && ((x1_283 = x1_301[@i_356]) && ((x2_282 = x2_300[@i_356]) && ((x3_281 = x3_299[@i_356]) && ((x4_280 = x4_298[@i_356]) && (x5_279 = x5_297[@i_356]))))) then
      (
        let sk_u: hash0 = r_296[@i_356] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_355 <= NU suchthat defined(x1_307[@i_355], x2_306[@i_355], x3_305[@i_355], x4_304[@i_355], x5_303[@i_355], r_302[@i_355]) && otheruses(r_302[@i_355]) && ((x1_283 = x1_307[@i_355]) && ((x2_282 = x2_306[@i_355]) && ((x3_281 = x3_305[@i_355]) && ((x4_280 = x4_304[@i_355]) && (x5_279 = x5_303[@i_355]))))) then
      (
        let sk_u: hash0 = r_302[@i_355] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_354 <= NU suchthat defined(x1_313[@i_354], x2_312[@i_354], x3_311[@i_354], x4_310[@i_354], x5_309[@i_354], r_308[@i_354]) && otheruses(r_308[@i_354]) && ((x1_283 = x1_313[@i_354]) && ((x2_282 = x2_312[@i_354]) && ((x3_281 = x3_311[@i_354]) && ((x4_280 = x4_310[@i_354]) && (x5_279 = x5_309[@i_354]))))) then
      (
        let sk_u: hash0 = r_308[@i_354] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      else
        new r_278: hash0;
        let sk_u: hash0 = r_278 in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @2_m_139[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @2_r4_137[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = @2_r4_137[@i_168] in
    let K_u: G = exp(@2_r4_137[@i_168], x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((@2_r4_137[@i_168] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_301: host = U in
      let x2_300: host = S in
      let x3_299: G = X in
      let x4_298: G = @2_r4_137[@i_168] in
      let x5_297: G = K_u in
      find [unique] @i_393 <= qH0 suchthat defined(x1_259[@i_393], x2_258[@i_393], x3_257[@i_393], x4_256[@i_393], x5_255[@i_393], r_254[@i_393]) && otheruses(r_254[@i_393]) && ((x1_301 = x1_259[@i_393]) && ((x2_300 = x2_258[@i_393]) && ((x3_299 = x3_257[@i_393]) && ((x4_298 = x4_256[@i_393]) && (x5_297 = x5_255[@i_393]))))) then
      (
        let sk_u: hash0 = r_254[@i_393] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_392 <= NS suchthat defined(x1_265[@i_392], x2_264[@i_392], x3_263[@i_392], x4_262[@i_392], x5_261[@i_392], r_260[@i_392]) && otheruses(r_260[@i_392]) && ((x1_301 = x1_265[@i_392]) && ((x2_300 = x2_264[@i_392]) && ((x3_299 = x3_263[@i_392]) && ((x4_298 = x4_262[@i_392]) && (x5_297 = x5_261[@i_392]))))) then
      (
        let sk_u: hash0 = r_260[@i_392] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_391 <= NS suchthat defined(x1_271[@i_391], x2_270[@i_391], x3_269[@i_391], x4_268[@i_391], x5_267[@i_391], r_266[@i_391]) && otheruses(r_266[@i_391]) && ((x1_301 = x1_271[@i_391]) && ((x2_300 = x2_270[@i_391]) && ((x3_299 = x3_269[@i_391]) && ((x4_298 = x4_268[@i_391]) && (x5_297 = x5_267[@i_391]))))) then
      (
        let sk_u: hash0 = r_266[@i_391] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_390 <= NU suchthat defined(x1_277[@i_390], x2_276[@i_390], x3_275[@i_390], x4_274[@i_390], x5_273[@i_390], r_272[@i_390]) && otheruses(r_272[@i_390]) && ((x1_301 = x1_277[@i_390]) && ((x2_300 = x2_276[@i_390]) && ((x3_299 = x3_275[@i_390]) && ((x4_298 = x4_274[@i_390]) && (x5_297 = x5_273[@i_390]))))) then
      (
        let sk_u: hash0 = r_272[@i_390] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_389 <= NU suchthat defined(x1_283[@i_389], x2_282[@i_389], x3_281[@i_389], x4_280[@i_389], x5_279[@i_389], r_278[@i_389]) && otheruses(r_278[@i_389]) && ((x1_301 = x1_283[@i_389]) && ((x2_300 = x2_282[@i_389]) && ((x3_299 = x3_281[@i_389]) && ((x4_298 = x4_280[@i_389]) && (x5_297 = x5_279[@i_389]))))) then
      (
        let sk_u: hash0 = r_278[@i_389] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_388 <= NU suchthat defined(x1_289[@i_388], x2_288[@i_388], x3_287[@i_388], x4_286[@i_388], x5_285[@i_388], r_284[@i_388]) && otheruses(r_284[@i_388]) && ((x1_301 = x1_289[@i_388]) && ((x2_300 = x2_288[@i_388]) && ((x3_299 = x3_287[@i_388]) && ((x4_298 = x4_286[@i_388]) && (x5_297 = x5_285[@i_388]))))) then
      (
        let sk_u: hash0 = r_284[@i_388] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_387 <= NU suchthat defined(x1_295[@i_387], x2_294[@i_387], x3_293[@i_387], x4_292[@i_387], x5_291[@i_387], r_290[@i_387]) && otheruses(r_290[@i_387]) && ((x1_301 = x1_295[@i_387]) && ((x2_300 = x2_294[@i_387]) && ((x3_299 = x3_293[@i_387]) && ((x4_298 = x4_292[@i_387]) && (x5_297 = x5_291[@i_387]))))) then
      (
        let sk_u: hash0 = r_290[@i_387] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_386 <= NU suchthat defined(x1_301[@i_386], x2_300[@i_386], x3_299[@i_386], x4_298[@i_386], x5_297[@i_386], r_296[@i_386]) && otheruses(r_296[@i_386]) && ((x1_301 = x1_301[@i_386]) && ((x2_300 = x2_300[@i_386]) && ((x3_299 = x3_299[@i_386]) && ((x4_298 = x4_298[@i_386]) && (x5_297 = x5_297[@i_386]))))) then
      (
        let sk_u: hash0 = r_296[@i_386] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_385 <= NU suchthat defined(x1_307[@i_385], x2_306[@i_385], x3_305[@i_385], x4_304[@i_385], x5_303[@i_385], r_302[@i_385]) && otheruses(r_302[@i_385]) && ((x1_301 = x1_307[@i_385]) && ((x2_300 = x2_306[@i_385]) && ((x3_299 = x3_305[@i_385]) && ((x4_298 = x4_304[@i_385]) && (x5_297 = x5_303[@i_385]))))) then
      (
        let sk_u: hash0 = r_302[@i_385] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_384 <= NU suchthat defined(x1_313[@i_384], x2_312[@i_384], x3_311[@i_384], x4_310[@i_384], x5_309[@i_384], r_308[@i_384]) && otheruses(r_308[@i_384]) && ((x1_301 = x1_313[@i_384]) && ((x2_300 = x2_312[@i_384]) && ((x3_299 = x3_311[@i_384]) && ((x4_298 = x4_310[@i_384]) && (x5_297 = x5_309[@i_384]))))) then
      (
        let sk_u: hash0 = r_308[@i_384] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_296: hash0;
        let sk_u: hash0 = r_296 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let x1_295: host = U in
      let x2_294: host = S in
      let x3_293: G = X in
      let x4_292: G = @2_r4_137[@i_168] in
      let x5_291: G = K_u in
      find [unique] @i_383 <= qH0 suchthat defined(x1_259[@i_383], x2_258[@i_383], x3_257[@i_383], x4_256[@i_383], x5_255[@i_383], r_254[@i_383]) && otheruses(r_254[@i_383]) && ((x1_295 = x1_259[@i_383]) && ((x2_294 = x2_258[@i_383]) && ((x3_293 = x3_257[@i_383]) && ((x4_292 = x4_256[@i_383]) && (x5_291 = x5_255[@i_383]))))) then
      (
        let sk_u: hash0 = r_254[@i_383] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_382 <= NS suchthat defined(x1_265[@i_382], x2_264[@i_382], x3_263[@i_382], x4_262[@i_382], x5_261[@i_382], r_260[@i_382]) && otheruses(r_260[@i_382]) && ((x1_295 = x1_265[@i_382]) && ((x2_294 = x2_264[@i_382]) && ((x3_293 = x3_263[@i_382]) && ((x4_292 = x4_262[@i_382]) && (x5_291 = x5_261[@i_382]))))) then
      (
        let sk_u: hash0 = r_260[@i_382] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_381 <= NS suchthat defined(x1_271[@i_381], x2_270[@i_381], x3_269[@i_381], x4_268[@i_381], x5_267[@i_381], r_266[@i_381]) && otheruses(r_266[@i_381]) && ((x1_295 = x1_271[@i_381]) && ((x2_294 = x2_270[@i_381]) && ((x3_293 = x3_269[@i_381]) && ((x4_292 = x4_268[@i_381]) && (x5_291 = x5_267[@i_381]))))) then
      (
        let sk_u: hash0 = r_266[@i_381] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_380 <= NU suchthat defined(x1_277[@i_380], x2_276[@i_380], x3_275[@i_380], x4_274[@i_380], x5_273[@i_380], r_272[@i_380]) && otheruses(r_272[@i_380]) && ((x1_295 = x1_277[@i_380]) && ((x2_294 = x2_276[@i_380]) && ((x3_293 = x3_275[@i_380]) && ((x4_292 = x4_274[@i_380]) && (x5_291 = x5_273[@i_380]))))) then
      (
        let sk_u: hash0 = r_272[@i_380] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_379 <= NU suchthat defined(x1_283[@i_379], x2_282[@i_379], x3_281[@i_379], x4_280[@i_379], x5_279[@i_379], r_278[@i_379]) && otheruses(r_278[@i_379]) && ((x1_295 = x1_283[@i_379]) && ((x2_294 = x2_282[@i_379]) && ((x3_293 = x3_281[@i_379]) && ((x4_292 = x4_280[@i_379]) && (x5_291 = x5_279[@i_379]))))) then
      (
        let sk_u: hash0 = r_278[@i_379] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_378 <= NU suchthat defined(x1_289[@i_378], x2_288[@i_378], x3_287[@i_378], x4_286[@i_378], x5_285[@i_378], r_284[@i_378]) && otheruses(r_284[@i_378]) && ((x1_295 = x1_289[@i_378]) && ((x2_294 = x2_288[@i_378]) && ((x3_293 = x3_287[@i_378]) && ((x4_292 = x4_286[@i_378]) && (x5_291 = x5_285[@i_378]))))) then
      (
        let sk_u: hash0 = r_284[@i_378] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_377 <= NU suchthat defined(x1_295[@i_377], x2_294[@i_377], x3_293[@i_377], x4_292[@i_377], x5_291[@i_377], r_290[@i_377]) && otheruses(r_290[@i_377]) && ((x1_295 = x1_295[@i_377]) && ((x2_294 = x2_294[@i_377]) && ((x3_293 = x3_293[@i_377]) && ((x4_292 = x4_292[@i_377]) && (x5_291 = x5_291[@i_377]))))) then
      (
        let sk_u: hash0 = r_290[@i_377] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_376 <= NU suchthat defined(x1_301[@i_376], x2_300[@i_376], x3_299[@i_376], x4_298[@i_376], x5_297[@i_376], r_296[@i_376]) && otheruses(r_296[@i_376]) && ((x1_295 = x1_301[@i_376]) && ((x2_294 = x2_300[@i_376]) && ((x3_293 = x3_299[@i_376]) && ((x4_292 = x4_298[@i_376]) && (x5_291 = x5_297[@i_376]))))) then
      (
        let sk_u: hash0 = r_296[@i_376] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_375 <= NU suchthat defined(x1_307[@i_375], x2_306[@i_375], x3_305[@i_375], x4_304[@i_375], x5_303[@i_375], r_302[@i_375]) && otheruses(r_302[@i_375]) && ((x1_295 = x1_307[@i_375]) && ((x2_294 = x2_306[@i_375]) && ((x3_293 = x3_305[@i_375]) && ((x4_292 = x4_304[@i_375]) && (x5_291 = x5_303[@i_375]))))) then
      (
        let sk_u: hash0 = r_302[@i_375] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_374 <= NU suchthat defined(x1_313[@i_374], x2_312[@i_374], x3_311[@i_374], x4_310[@i_374], x5_309[@i_374], r_308[@i_374]) && otheruses(r_308[@i_374]) && ((x1_295 = x1_313[@i_374]) && ((x2_294 = x2_312[@i_374]) && ((x3_293 = x3_311[@i_374]) && ((x4_292 = x4_310[@i_374]) && (x5_291 = x5_309[@i_374]))))) then
      (
        let sk_u: hash0 = r_308[@i_374] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      else
        new r_290: hash0;
        let sk_u: hash0 = r_290 in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_ke[@i_166], @2_x[@i_166], @2_x_133[@i_166], @2_ke_132[@i_166], @2_r2_131[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(Y[@i_165], @2_x_136[@i_165], @2_r2_134[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_313: host = U in
      let x2_312: host = S in
      let x3_311: G = X in
      let x4_310: G = Y[@i_165] in
      let x5_309: G = K_u in
      find [unique] @i_413 <= qH0 suchthat defined(x1_259[@i_413], x2_258[@i_413], x3_257[@i_413], x4_256[@i_413], x5_255[@i_413], r_254[@i_413]) && otheruses(r_254[@i_413]) && ((x1_313 = x1_259[@i_413]) && ((x2_312 = x2_258[@i_413]) && ((x3_311 = x3_257[@i_413]) && ((x4_310 = x4_256[@i_413]) && (x5_309 = x5_255[@i_413]))))) then
      (
        let sk_u: hash0 = r_254[@i_413] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_412 <= NS suchthat defined(x1_265[@i_412], x2_264[@i_412], x3_263[@i_412], x4_262[@i_412], x5_261[@i_412], r_260[@i_412]) && otheruses(r_260[@i_412]) && ((x1_313 = x1_265[@i_412]) && ((x2_312 = x2_264[@i_412]) && ((x3_311 = x3_263[@i_412]) && ((x4_310 = x4_262[@i_412]) && (x5_309 = x5_261[@i_412]))))) then
      (
        let sk_u: hash0 = r_260[@i_412] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_411 <= NS suchthat defined(x1_271[@i_411], x2_270[@i_411], x3_269[@i_411], x4_268[@i_411], x5_267[@i_411], r_266[@i_411]) && otheruses(r_266[@i_411]) && ((x1_313 = x1_271[@i_411]) && ((x2_312 = x2_270[@i_411]) && ((x3_311 = x3_269[@i_411]) && ((x4_310 = x4_268[@i_411]) && (x5_309 = x5_267[@i_411]))))) then
      (
        let sk_u: hash0 = r_266[@i_411] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_410 <= NU suchthat defined(x1_277[@i_410], x2_276[@i_410], x3_275[@i_410], x4_274[@i_410], x5_273[@i_410], r_272[@i_410]) && otheruses(r_272[@i_410]) && ((x1_313 = x1_277[@i_410]) && ((x2_312 = x2_276[@i_410]) && ((x3_311 = x3_275[@i_410]) && ((x4_310 = x4_274[@i_410]) && (x5_309 = x5_273[@i_410]))))) then
      (
        let sk_u: hash0 = r_272[@i_410] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_409 <= NU suchthat defined(x1_283[@i_409], x2_282[@i_409], x3_281[@i_409], x4_280[@i_409], x5_279[@i_409], r_278[@i_409]) && otheruses(r_278[@i_409]) && ((x1_313 = x1_283[@i_409]) && ((x2_312 = x2_282[@i_409]) && ((x3_311 = x3_281[@i_409]) && ((x4_310 = x4_280[@i_409]) && (x5_309 = x5_279[@i_409]))))) then
      (
        let sk_u: hash0 = r_278[@i_409] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_408 <= NU suchthat defined(x1_289[@i_408], x2_288[@i_408], x3_287[@i_408], x4_286[@i_408], x5_285[@i_408], r_284[@i_408]) && otheruses(r_284[@i_408]) && ((x1_313 = x1_289[@i_408]) && ((x2_312 = x2_288[@i_408]) && ((x3_311 = x3_287[@i_408]) && ((x4_310 = x4_286[@i_408]) && (x5_309 = x5_285[@i_408]))))) then
      (
        let sk_u: hash0 = r_284[@i_408] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_407 <= NU suchthat defined(x1_295[@i_407], x2_294[@i_407], x3_293[@i_407], x4_292[@i_407], x5_291[@i_407], r_290[@i_407]) && otheruses(r_290[@i_407]) && ((x1_313 = x1_295[@i_407]) && ((x2_312 = x2_294[@i_407]) && ((x3_311 = x3_293[@i_407]) && ((x4_310 = x4_292[@i_407]) && (x5_309 = x5_291[@i_407]))))) then
      (
        let sk_u: hash0 = r_290[@i_407] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_406 <= NU suchthat defined(x1_301[@i_406], x2_300[@i_406], x3_299[@i_406], x4_298[@i_406], x5_297[@i_406], r_296[@i_406]) && otheruses(r_296[@i_406]) && ((x1_313 = x1_301[@i_406]) && ((x2_312 = x2_300[@i_406]) && ((x3_311 = x3_299[@i_406]) && ((x4_310 = x4_298[@i_406]) && (x5_309 = x5_297[@i_406]))))) then
      (
        let sk_u: hash0 = r_296[@i_406] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_405 <= NU suchthat defined(x1_307[@i_405], x2_306[@i_405], x3_305[@i_405], x4_304[@i_405], x5_303[@i_405], r_302[@i_405]) && otheruses(r_302[@i_405]) && ((x1_313 = x1_307[@i_405]) && ((x2_312 = x2_306[@i_405]) && ((x3_311 = x3_305[@i_405]) && ((x4_310 = x4_304[@i_405]) && (x5_309 = x5_303[@i_405]))))) then
      (
        let sk_u: hash0 = r_302[@i_405] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind @i_404 <= NU suchthat defined(x1_313[@i_404], x2_312[@i_404], x3_311[@i_404], x4_310[@i_404], x5_309[@i_404], r_308[@i_404]) && otheruses(r_308[@i_404]) && ((x1_313 = x1_313[@i_404]) && ((x2_312 = x2_312[@i_404]) && ((x3_311 = x3_311[@i_404]) && ((x4_310 = x4_310[@i_404]) && (x5_309 = x5_309[@i_404]))))) then
      (
        let sk_u: hash0 = r_308[@i_404] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_308: hash0;
        let sk_u: hash0 = r_308 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let x1_307: host = U in
      let x2_306: host = S in
      let x3_305: G = X in
      let x4_304: G = Y[@i_165] in
      let x5_303: G = K_u in
      find [unique] @i_403 <= qH0 suchthat defined(x1_259[@i_403], x2_258[@i_403], x3_257[@i_403], x4_256[@i_403], x5_255[@i_403], r_254[@i_403]) && otheruses(r_254[@i_403]) && ((x1_307 = x1_259[@i_403]) && ((x2_306 = x2_258[@i_403]) && ((x3_305 = x3_257[@i_403]) && ((x4_304 = x4_256[@i_403]) && (x5_303 = x5_255[@i_403]))))) then
      (
        let sk_u: hash0 = r_254[@i_403] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_402 <= NS suchthat defined(x1_265[@i_402], x2_264[@i_402], x3_263[@i_402], x4_262[@i_402], x5_261[@i_402], r_260[@i_402]) && otheruses(r_260[@i_402]) && ((x1_307 = x1_265[@i_402]) && ((x2_306 = x2_264[@i_402]) && ((x3_305 = x3_263[@i_402]) && ((x4_304 = x4_262[@i_402]) && (x5_303 = x5_261[@i_402]))))) then
      (
        let sk_u: hash0 = r_260[@i_402] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_401 <= NS suchthat defined(x1_271[@i_401], x2_270[@i_401], x3_269[@i_401], x4_268[@i_401], x5_267[@i_401], r_266[@i_401]) && otheruses(r_266[@i_401]) && ((x1_307 = x1_271[@i_401]) && ((x2_306 = x2_270[@i_401]) && ((x3_305 = x3_269[@i_401]) && ((x4_304 = x4_268[@i_401]) && (x5_303 = x5_267[@i_401]))))) then
      (
        let sk_u: hash0 = r_266[@i_401] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_400 <= NU suchthat defined(x1_277[@i_400], x2_276[@i_400], x3_275[@i_400], x4_274[@i_400], x5_273[@i_400], r_272[@i_400]) && otheruses(r_272[@i_400]) && ((x1_307 = x1_277[@i_400]) && ((x2_306 = x2_276[@i_400]) && ((x3_305 = x3_275[@i_400]) && ((x4_304 = x4_274[@i_400]) && (x5_303 = x5_273[@i_400]))))) then
      (
        let sk_u: hash0 = r_272[@i_400] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_399 <= NU suchthat defined(x1_283[@i_399], x2_282[@i_399], x3_281[@i_399], x4_280[@i_399], x5_279[@i_399], r_278[@i_399]) && otheruses(r_278[@i_399]) && ((x1_307 = x1_283[@i_399]) && ((x2_306 = x2_282[@i_399]) && ((x3_305 = x3_281[@i_399]) && ((x4_304 = x4_280[@i_399]) && (x5_303 = x5_279[@i_399]))))) then
      (
        let sk_u: hash0 = r_278[@i_399] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_398 <= NU suchthat defined(x1_289[@i_398], x2_288[@i_398], x3_287[@i_398], x4_286[@i_398], x5_285[@i_398], r_284[@i_398]) && otheruses(r_284[@i_398]) && ((x1_307 = x1_289[@i_398]) && ((x2_306 = x2_288[@i_398]) && ((x3_305 = x3_287[@i_398]) && ((x4_304 = x4_286[@i_398]) && (x5_303 = x5_285[@i_398]))))) then
      (
        let sk_u: hash0 = r_284[@i_398] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_397 <= NU suchthat defined(x1_295[@i_397], x2_294[@i_397], x3_293[@i_397], x4_292[@i_397], x5_291[@i_397], r_290[@i_397]) && otheruses(r_290[@i_397]) && ((x1_307 = x1_295[@i_397]) && ((x2_306 = x2_294[@i_397]) && ((x3_305 = x3_293[@i_397]) && ((x4_304 = x4_292[@i_397]) && (x5_303 = x5_291[@i_397]))))) then
      (
        let sk_u: hash0 = r_290[@i_397] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_396 <= NU suchthat defined(x1_301[@i_396], x2_300[@i_396], x3_299[@i_396], x4_298[@i_396], x5_297[@i_396], r_296[@i_396]) && otheruses(r_296[@i_396]) && ((x1_307 = x1_301[@i_396]) && ((x2_306 = x2_300[@i_396]) && ((x3_305 = x3_299[@i_396]) && ((x4_304 = x4_298[@i_396]) && (x5_303 = x5_297[@i_396]))))) then
      (
        let sk_u: hash0 = r_296[@i_396] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_395 <= NU suchthat defined(x1_307[@i_395], x2_306[@i_395], x3_305[@i_395], x4_304[@i_395], x5_303[@i_395], r_302[@i_395]) && otheruses(r_302[@i_395]) && ((x1_307 = x1_307[@i_395]) && ((x2_306 = x2_306[@i_395]) && ((x3_305 = x3_305[@i_395]) && ((x4_304 = x4_304[@i_395]) && (x5_303 = x5_303[@i_395]))))) then
      (
        let sk_u: hash0 = r_302[@i_395] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      orfind @i_394 <= NU suchthat defined(x1_313[@i_394], x2_312[@i_394], x3_311[@i_394], x4_310[@i_394], x5_309[@i_394], r_308[@i_394]) && otheruses(r_308[@i_394]) && ((x1_307 = x1_313[@i_394]) && ((x2_306 = x2_312[@i_394]) && ((x3_305 = x3_311[@i_394]) && ((x4_304 = x4_310[@i_394]) && (x5_303 = x5_309[@i_394]))))) then
      (
        let sk_u: hash0 = r_308[@i_394] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      else
        new r_302: hash0;
        let sk_u: hash0 = r_302 in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
  )
  else
    new @2_r4_137: G;
    let Y_u: G = @2_r4_137 in
    let K_u: G = exp(@2_r4_137, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    let x3_275: G = X in
    let x4_274: G = @2_r4_137 in
    let x5_273: G = K_u in
    find [unique] @i_353 <= qH0 suchthat defined(x1_259[@i_353], x2_258[@i_353], x3_257[@i_353], x4_256[@i_353], x5_255[@i_353], r_254[@i_353]) && otheruses(r_254[@i_353]) && ((x1_277 = x1_259[@i_353]) && ((x2_276 = x2_258[@i_353]) && ((x3_275 = x3_257[@i_353]) && ((x4_274 = x4_256[@i_353]) && (x5_273 = x5_255[@i_353]))))) then
    (
      let sk_u: hash0 = r_254[@i_353] in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
    )
    orfind @i_352 <= NS suchthat defined(x1_265[@i_352], x2_264[@i_352], x3_263[@i_352], x4_262[@i_352], x5_261[@i_352], r_260[@i_352]) && otheruses(r_260[@i_352]) && ((x1_277 = x1_265[@i_352]) && ((x2_276 = x2_264[@i_352]) && ((x3_275 = x3_263[@i_352]) && ((x4_274 = x4_262[@i_352]) && (x5_273 = x5_261[@i_352]))))) then
    (
      let sk_u: hash0 = r_260[@i_352] in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
    )
    orfind @i_351 <= NS suchthat defined(x1_271[@i_351], x2_270[@i_351], x3_269[@i_351], x4_268[@i_351], x5_267[@i_351], r_266[@i_351]) && otheruses(r_266[@i_351]) && ((x1_277 = x1_271[@i_351]) && ((x2_276 = x2_270[@i_351]) && ((x3_275 = x3_269[@i_351]) && ((x4_274 = x4_268[@i_351]) && (x5_273 = x5_267[@i_351]))))) then
    (
      let sk_u: hash0 = r_266[@i_351] in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
    )
    orfind @i_350 <= NU suchthat defined(x1_277[@i_350], x2_276[@i_350], x3_275[@i_350], x4_274[@i_350], x5_273[@i_350], r_272[@i_350]) && otheruses(r_272[@i_350]) && ((x1_277 = x1_277[@i_350]) && ((x2_276 = x2_276[@i_350]) && ((x3_275 = x3_275[@i_350]) && ((x4_274 = x4_274[@i_350]) && (x5_273 = x5_273[@i_350]))))) then
    (
      let sk_u: hash0 = r_272[@i_350] in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
    )
    orfind @i_349 <= NU suchthat defined(x1_283[@i_349], x2_282[@i_349], x3_281[@i_349], x4_280[@i_349], x5_279[@i_349], r_278[@i_349]) && otheruses(r_278[@i_349]) && ((x1_277 = x1_283[@i_349]) && ((x2_276 = x2_282[@i_349]) && ((x3_275 = x3_281[@i_349]) && ((x4_274 = x4_280[@i_349]) && (x5_273 = x5_279[@i_349]))))) then
    (
      let sk_u: hash0 = r_278[@i_349] in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
    )
    orfind @i_348 <= NU suchthat defined(x1_289[@i_348], x2_288[@i_348], x3_287[@i_348], x4_286[@i_348], x5_285[@i_348], r_284[@i_348]) && otheruses(r_284[@i_348]) && ((x1_277 = x1_289[@i_348]) && ((x2_276 = x2_288[@i_348]) && ((x3_275 = x3_287[@i_348]) && ((x4_274 = x4_286[@i_348]) && (x5_273 = x5_285[@i_348]))))) then
    (
      let sk_u: hash0 = r_284[@i_348] in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
    )
    orfind @i_347 <= NU suchthat defined(x1_295[@i_347], x2_294[@i_347], x3_293[@i_347], x4_292[@i_347], x5_291[@i_347], r_290[@i_347]) && otheruses(r_290[@i_347]) && ((x1_277 = x1_295[@i_347]) && ((x2_276 = x2_294[@i_347]) && ((x3_275 = x3_293[@i_347]) && ((x4_274 = x4_292[@i_347]) && (x5_273 = x5_291[@i_347]))))) then
    (
      let sk_u: hash0 = r_290[@i_347] in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
    )
    orfind @i_346 <= NU suchthat defined(x1_301[@i_346], x2_300[@i_346], x3_299[@i_346], x4_298[@i_346], x5_297[@i_346], r_296[@i_346]) && otheruses(r_296[@i_346]) && ((x1_277 = x1_301[@i_346]) && ((x2_276 = x2_300[@i_346]) && ((x3_275 = x3_299[@i_346]) && ((x4_274 = x4_298[@i_346]) && (x5_273 = x5_297[@i_346]))))) then
    (
      let sk_u: hash0 = r_296[@i_346] in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
    )
    orfind @i_345 <= NU suchthat defined(x1_307[@i_345], x2_306[@i_345], x3_305[@i_345], x4_304[@i_345], x5_303[@i_345], r_302[@i_345]) && otheruses(r_302[@i_345]) && ((x1_277 = x1_307[@i_345]) && ((x2_276 = x2_306[@i_345]) && ((x3_275 = x3_305[@i_345]) && ((x4_274 = x4_304[@i_345]) && (x5_273 = x5_303[@i_345]))))) then
    (
      let sk_u: hash0 = r_302[@i_345] in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
    )
    orfind @i_344 <= NU suchthat defined(x1_313[@i_344], x2_312[@i_344], x3_311[@i_344], x4_310[@i_344], x5_309[@i_344], r_308[@i_344]) && otheruses(r_308[@i_344]) && ((x1_277 = x1_313[@i_344]) && ((x2_276 = x2_312[@i_344]) && ((x3_275 = x3_311[@i_344]) && ((x4_274 = x4_310[@i_344]) && (x5_273 = x5_309[@i_344]))))) then
    (
      let sk_u: hash0 = r_308[@i_344] in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
    )
    else
      new r_272: hash0;
      let sk_u: hash0 = r_272 in
      event termU(U, X, S, Ystar_u, r1_77, sk_u);
      out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_136: G = cst_G in
  let @2_ke_135: passwd = cst_passwd in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let x1_265: host = U in
    let x2_264: host = S in
    let x3_263: G = X_s in
    let x4_262: G = Y in
    let x5_261: G = K_s in
    find [unique] @i_333 <= qH0 suchthat defined(x1_259[@i_333], x2_258[@i_333], x3_257[@i_333], x4_256[@i_333], x5_255[@i_333], r_254[@i_333]) && otheruses(r_254[@i_333]) && ((x1_265 = x1_259[@i_333]) && ((x2_264 = x2_258[@i_333]) && ((x3_263 = x3_257[@i_333]) && ((x4_262 = x4_256[@i_333]) && (x5_261 = x5_255[@i_333]))))) then
    (
      let sk_s: hash0 = r_254[@i_333] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_332 <= NS suchthat defined(x1_265[@i_332], x2_264[@i_332], x3_263[@i_332], x4_262[@i_332], x5_261[@i_332], r_260[@i_332]) && otheruses(r_260[@i_332]) && ((x1_265 = x1_265[@i_332]) && ((x2_264 = x2_264[@i_332]) && ((x3_263 = x3_263[@i_332]) && ((x4_262 = x4_262[@i_332]) && (x5_261 = x5_261[@i_332]))))) then
    (
      let sk_s: hash0 = r_260[@i_332] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_331 <= NS suchthat defined(x1_271[@i_331], x2_270[@i_331], x3_269[@i_331], x4_268[@i_331], x5_267[@i_331], r_266[@i_331]) && otheruses(r_266[@i_331]) && ((x1_265 = x1_271[@i_331]) && ((x2_264 = x2_270[@i_331]) && ((x3_263 = x3_269[@i_331]) && ((x4_262 = x4_268[@i_331]) && (x5_261 = x5_267[@i_331]))))) then
    (
      let sk_s: hash0 = r_266[@i_331] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_330 <= NU suchthat defined(x1_277[@i_330], x2_276[@i_330], x3_275[@i_330], x4_274[@i_330], x5_273[@i_330], r_272[@i_330]) && otheruses(r_272[@i_330]) && ((x1_265 = x1_277[@i_330]) && ((x2_264 = x2_276[@i_330]) && ((x3_263 = x3_275[@i_330]) && ((x4_262 = x4_274[@i_330]) && (x5_261 = x5_273[@i_330]))))) then
    (
      let sk_s: hash0 = r_272[@i_330] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_329 <= NU suchthat defined(x1_283[@i_329], x2_282[@i_329], x3_281[@i_329], x4_280[@i_329], x5_279[@i_329], r_278[@i_329]) && otheruses(r_278[@i_329]) && ((x1_265 = x1_283[@i_329]) && ((x2_264 = x2_282[@i_329]) && ((x3_263 = x3_281[@i_329]) && ((x4_262 = x4_280[@i_329]) && (x5_261 = x5_279[@i_329]))))) then
    (
      let sk_s: hash0 = r_278[@i_329] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_328 <= NU suchthat defined(x1_289[@i_328], x2_288[@i_328], x3_287[@i_328], x4_286[@i_328], x5_285[@i_328], r_284[@i_328]) && otheruses(r_284[@i_328]) && ((x1_265 = x1_289[@i_328]) && ((x2_264 = x2_288[@i_328]) && ((x3_263 = x3_287[@i_328]) && ((x4_262 = x4_286[@i_328]) && (x5_261 = x5_285[@i_328]))))) then
    (
      let sk_s: hash0 = r_284[@i_328] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_327 <= NU suchthat defined(x1_295[@i_327], x2_294[@i_327], x3_293[@i_327], x4_292[@i_327], x5_291[@i_327], r_290[@i_327]) && otheruses(r_290[@i_327]) && ((x1_265 = x1_295[@i_327]) && ((x2_264 = x2_294[@i_327]) && ((x3_263 = x3_293[@i_327]) && ((x4_262 = x4_292[@i_327]) && (x5_261 = x5_291[@i_327]))))) then
    (
      let sk_s: hash0 = r_290[@i_327] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_326 <= NU suchthat defined(x1_301[@i_326], x2_300[@i_326], x3_299[@i_326], x4_298[@i_326], x5_297[@i_326], r_296[@i_326]) && otheruses(r_296[@i_326]) && ((x1_265 = x1_301[@i_326]) && ((x2_264 = x2_300[@i_326]) && ((x3_263 = x3_299[@i_326]) && ((x4_262 = x4_298[@i_326]) && (x5_261 = x5_297[@i_326]))))) then
    (
      let sk_s: hash0 = r_296[@i_326] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_325 <= NU suchthat defined(x1_307[@i_325], x2_306[@i_325], x3_305[@i_325], x4_304[@i_325], x5_303[@i_325], r_302[@i_325]) && otheruses(r_302[@i_325]) && ((x1_265 = x1_307[@i_325]) && ((x2_264 = x2_306[@i_325]) && ((x3_263 = x3_305[@i_325]) && ((x4_262 = x4_304[@i_325]) && (x5_261 = x5_303[@i_325]))))) then
    (
      let sk_s: hash0 = r_302[@i_325] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_324 <= NU suchthat defined(x1_313[@i_324], x2_312[@i_324], x3_311[@i_324], x4_310[@i_324], x5_309[@i_324], r_308[@i_324]) && otheruses(r_308[@i_324]) && ((x1_265 = x1_313[@i_324]) && ((x2_264 = x2_312[@i_324]) && ((x3_263 = x3_311[@i_324]) && ((x4_262 = x4_310[@i_324]) && (x5_261 = x5_309[@i_324]))))) then
    (
      let sk_s: hash0 = r_308[@i_324] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    else
      new r_260: hash0;
      let sk_s: hash0 = r_260 in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
  )
  orfind  suchthat defined(Y_u[j], K_u[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = X_s in
    let x4_268: G = Y in
    let x5_267: G = K_s in
    find [unique] @i_343 <= qH0 suchthat defined(x1_259[@i_343], x2_258[@i_343], x3_257[@i_343], x4_256[@i_343], x5_255[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1_259[@i_343]) && ((x2_270 = x2_258[@i_343]) && ((x3_269 = x3_257[@i_343]) && ((x4_268 = x4_256[@i_343]) && (x5_267 = x5_255[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_342 <= NS suchthat defined(x1_265[@i_342], x2_264[@i_342], x3_263[@i_342], x4_262[@i_342], x5_261[@i_342], r_260[@i_342]) && otheruses(r_260[@i_342]) && ((x1_271 = x1_265[@i_342]) && ((x2_270 = x2_264[@i_342]) && ((x3_269 = x3_263[@i_342]) && ((x4_268 = x4_262[@i_342]) && (x5_267 = x5_261[@i_342]))))) then
    (
      let sk_s: hash0 = r_260[@i_342] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_341 <= NS suchthat defined(x1_271[@i_341], x2_270[@i_341], x3_269[@i_341], x4_268[@i_341], x5_267[@i_341], r_266[@i_341]) && otheruses(r_266[@i_341]) && ((x1_271 = x1_271[@i_341]) && ((x2_270 = x2_270[@i_341]) && ((x3_269 = x3_269[@i_341]) && ((x4_268 = x4_268[@i_341]) && (x5_267 = x5_267[@i_341]))))) then
    (
      let sk_s: hash0 = r_266[@i_341] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_340 <= NU suchthat defined(x1_277[@i_340], x2_276[@i_340], x3_275[@i_340], x4_274[@i_340], x5_273[@i_340], r_272[@i_340]) && otheruses(r_272[@i_340]) && ((x1_271 = x1_277[@i_340]) && ((x2_270 = x2_276[@i_340]) && ((x3_269 = x3_275[@i_340]) && ((x4_268 = x4_274[@i_340]) && (x5_267 = x5_273[@i_340]))))) then
    (
      let sk_s: hash0 = r_272[@i_340] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_339 <= NU suchthat defined(x1_283[@i_339], x2_282[@i_339], x3_281[@i_339], x4_280[@i_339], x5_279[@i_339], r_278[@i_339]) && otheruses(r_278[@i_339]) && ((x1_271 = x1_283[@i_339]) && ((x2_270 = x2_282[@i_339]) && ((x3_269 = x3_281[@i_339]) && ((x4_268 = x4_280[@i_339]) && (x5_267 = x5_279[@i_339]))))) then
    (
      let sk_s: hash0 = r_278[@i_339] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_338 <= NU suchthat defined(x1_289[@i_338], x2_288[@i_338], x3_287[@i_338], x4_286[@i_338], x5_285[@i_338], r_284[@i_338]) && otheruses(r_284[@i_338]) && ((x1_271 = x1_289[@i_338]) && ((x2_270 = x2_288[@i_338]) && ((x3_269 = x3_287[@i_338]) && ((x4_268 = x4_286[@i_338]) && (x5_267 = x5_285[@i_338]))))) then
    (
      let sk_s: hash0 = r_284[@i_338] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_337 <= NU suchthat defined(x1_295[@i_337], x2_294[@i_337], x3_293[@i_337], x4_292[@i_337], x5_291[@i_337], r_290[@i_337]) && otheruses(r_290[@i_337]) && ((x1_271 = x1_295[@i_337]) && ((x2_270 = x2_294[@i_337]) && ((x3_269 = x3_293[@i_337]) && ((x4_268 = x4_292[@i_337]) && (x5_267 = x5_291[@i_337]))))) then
    (
      let sk_s: hash0 = r_290[@i_337] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_336 <= NU suchthat defined(x1_301[@i_336], x2_300[@i_336], x3_299[@i_336], x4_298[@i_336], x5_297[@i_336], r_296[@i_336]) && otheruses(r_296[@i_336]) && ((x1_271 = x1_301[@i_336]) && ((x2_270 = x2_300[@i_336]) && ((x3_269 = x3_299[@i_336]) && ((x4_268 = x4_298[@i_336]) && (x5_267 = x5_297[@i_336]))))) then
    (
      let sk_s: hash0 = r_296[@i_336] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_335 <= NU suchthat defined(x1_307[@i_335], x2_306[@i_335], x3_305[@i_335], x4_304[@i_335], x5_303[@i_335], r_302[@i_335]) && otheruses(r_302[@i_335]) && ((x1_271 = x1_307[@i_335]) && ((x2_270 = x2_306[@i_335]) && ((x3_269 = x3_305[@i_335]) && ((x4_268 = x4_304[@i_335]) && (x5_267 = x5_303[@i_335]))))) then
    (
      let sk_s: hash0 = r_302[@i_335] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind @i_334 <= NU suchthat defined(x1_313[@i_334], x2_312[@i_334], x3_311[@i_334], x4_310[@i_334], x5_309[@i_334], r_308[@i_334]) && otheruses(r_308[@i_334]) && ((x1_271 = x1_313[@i_334]) && ((x2_270 = x2_312[@i_334]) && ((x3_269 = x3_311[@i_334]) && ((x4_268 = x4_310[@i_334]) && (x5_267 = x5_309[@i_334]))))) then
    (
      let sk_s: hash0 = r_308[@i_334] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  let @2_x_133: G = cst_G in
  let @2_ke_132: passwd = cst_passwd in
  find [unique] @i_155 <= qD suchthat defined(@2_kd[@i_155], @2_m[@i_155], @2_m_130[@i_155], @2_kd_129[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @2_r4_128[@i_155]) && ((@2_x = @2_r4_128[@i_155]) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(pw, Ystar_u[@i_152], @2_m_139[@i_152], @2_kd_138[@i_152], @2_r4_137[@i_152]) && otheruses(Ystar_u[@i_152] -> @2_r4_137[@i_152]) && ((@2_x = @2_r4_137[@i_152]) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_ke_132[@i_150], @2_x_133[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], pw, @2_ke_135[@i_149], @2_x_136[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  let @2_m_130: G = cst_G in
  let @2_kd_129: passwd = cst_passwd in
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @2_kd_129[@i_147], @2_m_130[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @2_r4_128[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @2_r4_128[@i_147])
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], pw, @2_kd_138[@i_144], @2_m_139[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @2_r4_137[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], @2_r4_137[@i_144])
  orfind @i_142 <= qE suchthat defined(@2_ke[@i_142], @2_x[@i_142], @2_x_133[@i_142], @2_ke_132[@i_142], @2_r2_131[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(pw, Y[@i_141], @2_x_136[@i_141], @2_ke_135[@i_141], @2_r2_134[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @2_r4_128: G;
    out(@2_c4[!_44], @2_r4_128)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_259: host = x1 in
  let x2_258: host = x2 in
  let x3_257: G = x3 in
  let x4_256: G = x4 in
  let x5_255: G = x5 in
  find [unique] @i_323 <= qH0 suchthat defined(x1_259[@i_323], x2_258[@i_323], x3_257[@i_323], x4_256[@i_323], x5_255[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1_259 = x1_259[@i_323]) && ((x2_258 = x2_258[@i_323]) && ((x3_257 = x3_257[@i_323]) && ((x4_256 = x4_256[@i_323]) && (x5_255 = x5_255[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  orfind @i_322 <= NS suchthat defined(x1_265[@i_322], x2_264[@i_322], x3_263[@i_322], x4_262[@i_322], x5_261[@i_322], r_260[@i_322]) && otheruses(r_260[@i_322]) && ((x1_259 = x1_265[@i_322]) && ((x2_258 = x2_264[@i_322]) && ((x3_257 = x3_263[@i_322]) && ((x4_256 = x4_262[@i_322]) && (x5_255 = x5_261[@i_322]))))) then
    out(c20[!_45], r_260[@i_322])
  orfind @i_321 <= NS suchthat defined(x1_271[@i_321], x2_270[@i_321], x3_269[@i_321], x4_268[@i_321], x5_267[@i_321], r_266[@i_321]) && otheruses(r_266[@i_321]) && ((x1_259 = x1_271[@i_321]) && ((x2_258 = x2_270[@i_321]) && ((x3_257 = x3_269[@i_321]) && ((x4_256 = x4_268[@i_321]) && (x5_255 = x5_267[@i_321]))))) then
    out(c20[!_45], r_266[@i_321])
  orfind @i_320 <= NU suchthat defined(x1_277[@i_320], x2_276[@i_320], x3_275[@i_320], x4_274[@i_320], x5_273[@i_320], r_272[@i_320]) && otheruses(r_272[@i_320]) && ((x1_259 = x1_277[@i_320]) && ((x2_258 = x2_276[@i_320]) && ((x3_257 = x3_275[@i_320]) && ((x4_256 = x4_274[@i_320]) && (x5_255 = x5_273[@i_320]))))) then
    out(c20[!_45], r_272[@i_320])
  orfind @i_319 <= NU suchthat defined(x1_283[@i_319], x2_282[@i_319], x3_281[@i_319], x4_280[@i_319], x5_279[@i_319], r_278[@i_319]) && otheruses(r_278[@i_319]) && ((x1_259 = x1_283[@i_319]) && ((x2_258 = x2_282[@i_319]) && ((x3_257 = x3_281[@i_319]) && ((x4_256 = x4_280[@i_319]) && (x5_255 = x5_279[@i_319]))))) then
    out(c20[!_45], r_278[@i_319])
  orfind @i_318 <= NU suchthat defined(x1_289[@i_318], x2_288[@i_318], x3_287[@i_318], x4_286[@i_318], x5_285[@i_318], r_284[@i_318]) && otheruses(r_284[@i_318]) && ((x1_259 = x1_289[@i_318]) && ((x2_258 = x2_288[@i_318]) && ((x3_257 = x3_287[@i_318]) && ((x4_256 = x4_286[@i_318]) && (x5_255 = x5_285[@i_318]))))) then
    out(c20[!_45], r_284[@i_318])
  orfind @i_317 <= NU suchthat defined(x1_295[@i_317], x2_294[@i_317], x3_293[@i_317], x4_292[@i_317], x5_291[@i_317], r_290[@i_317]) && otheruses(r_290[@i_317]) && ((x1_259 = x1_295[@i_317]) && ((x2_258 = x2_294[@i_317]) && ((x3_257 = x3_293[@i_317]) && ((x4_256 = x4_292[@i_317]) && (x5_255 = x5_291[@i_317]))))) then
    out(c20[!_45], r_290[@i_317])
  orfind @i_316 <= NU suchthat defined(x1_301[@i_316], x2_300[@i_316], x3_299[@i_316], x4_298[@i_316], x5_297[@i_316], r_296[@i_316]) && otheruses(r_296[@i_316]) && ((x1_259 = x1_301[@i_316]) && ((x2_258 = x2_300[@i_316]) && ((x3_257 = x3_299[@i_316]) && ((x4_256 = x4_298[@i_316]) && (x5_255 = x5_297[@i_316]))))) then
    out(c20[!_45], r_296[@i_316])
  orfind @i_315 <= NU suchthat defined(x1_307[@i_315], x2_306[@i_315], x3_305[@i_315], x4_304[@i_315], x5_303[@i_315], r_302[@i_315]) && otheruses(r_302[@i_315]) && ((x1_259 = x1_307[@i_315]) && ((x2_258 = x2_306[@i_315]) && ((x3_257 = x3_305[@i_315]) && ((x4_256 = x4_304[@i_315]) && (x5_255 = x5_303[@i_315]))))) then
    out(c20[!_45], r_302[@i_315])
  orfind @i_314 <= NU suchthat defined(x1_313[@i_314], x2_312[@i_314], x3_311[@i_314], x4_310[@i_314], x5_309[@i_314], r_308[@i_314]) && otheruses(r_308[@i_314]) && ((x1_259 = x1_313[@i_314]) && ((x2_258 = x2_312[@i_314]) && ((x3_257 = x3_311[@i_314]) && ((x4_256 = x4_310[@i_314]) && (x5_255 = x5_309[@i_314]))))) then
    out(c20[!_45], r_308[@i_314])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying simplify [Excluding set(dist 12->13, proba <= 9. * 1. / |exponent| * NS + 8. * 1. / |exponent| * NU + NU * NS / |exponent| + qD * NS / |exponent| + 6.5 * NU * NU / |G| + 3. * NS * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|)] yields

Game 13 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_139: G = cst_G in
  let @2_kd_138: passwd = cst_passwd in
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @2_r4_128[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = @2_r4_128[@i_171] in
    let K_u: G = exp(@2_r4_128[@i_171], x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((@2_r4_128[@i_171] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_289: host = U in
      let x2_288: host = S in
      let x3_287: G = X in
      let x4_286: G = @2_r4_128[@i_171] in
      let x5_285: G = K_u in
      find [unique] @i_373 <= qH0 suchthat defined(x1_259[@i_373], x2_258[@i_373], x3_257[@i_373], x4_256[@i_373], x5_255[@i_373], r_254[@i_373]) && otheruses(r_254[@i_373]) && ((x1_289 = x1_259[@i_373]) && ((x2_288 = x2_258[@i_373]) && ((x3_287 = x3_257[@i_373]) && ((x4_286 = x4_256[@i_373]) && (x5_285 = x5_255[@i_373]))))) then
      (
        let sk_u: hash0 = r_254[@i_373] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_284: hash0;
        let sk_u: hash0 = r_284 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let x1_283: host = U in
      let x2_282: host = S in
      let x3_281: G = X in
      let x4_280: G = @2_r4_128[@i_171] in
      let x5_279: G = K_u in
      find [unique] @i_363 <= qH0 suchthat defined(x1_259[@i_363], x2_258[@i_363], x3_257[@i_363], x4_256[@i_363], x5_255[@i_363], r_254[@i_363]) && otheruses(r_254[@i_363]) && ((x1_283 = x1_259[@i_363]) && ((x2_282 = x2_258[@i_363]) && ((x3_281 = x3_257[@i_363]) && ((x4_280 = x4_256[@i_363]) && (x5_279 = x5_255[@i_363]))))) then
      (
        let sk_u: hash0 = r_254[@i_363] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      else
        new r_278: hash0;
        let sk_u: hash0 = r_278 in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @2_r4_137[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = @2_r4_137[@i_168] in
    let K_u: G = exp(@2_r4_137[@i_168], x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((@2_r4_137[@i_168] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_301: host = U in
      let x2_300: host = S in
      let x3_299: G = X in
      let x4_298: G = @2_r4_137[@i_168] in
      let x5_297: G = K_u in
      find [unique] @i_393 <= qH0 suchthat defined(x1_259[@i_393], x2_258[@i_393], x3_257[@i_393], x4_256[@i_393], x5_255[@i_393], r_254[@i_393]) && otheruses(r_254[@i_393]) && ((x1_301 = x1_259[@i_393]) && ((x2_300 = x2_258[@i_393]) && ((x3_299 = x3_257[@i_393]) && ((x4_298 = x4_256[@i_393]) && (x5_297 = x5_255[@i_393]))))) then
      (
        let sk_u: hash0 = r_254[@i_393] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_296: hash0;
        let sk_u: hash0 = r_296 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let x1_295: host = U in
      let x2_294: host = S in
      let x3_293: G = X in
      let x4_292: G = @2_r4_137[@i_168] in
      let x5_291: G = K_u in
      find [unique] @i_383 <= qH0 suchthat defined(x1_259[@i_383], x2_258[@i_383], x3_257[@i_383], x4_256[@i_383], x5_255[@i_383], r_254[@i_383]) && otheruses(r_254[@i_383]) && ((x1_295 = x1_259[@i_383]) && ((x2_294 = x2_258[@i_383]) && ((x3_293 = x3_257[@i_383]) && ((x4_292 = x4_256[@i_383]) && (x5_291 = x5_255[@i_383]))))) then
      (
        let sk_u: hash0 = r_254[@i_383] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      else
        new r_290: hash0;
        let sk_u: hash0 = r_290 in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_313: host = U in
      let x2_312: host = S in
      let x3_311: G = X in
      let x4_310: G = Y[@i_165] in
      let x5_309: G = K_u in
      find [unique] @i_413 <= qH0 suchthat defined(x1_259[@i_413], x2_258[@i_413], x3_257[@i_413], x4_256[@i_413], x5_255[@i_413], r_254[@i_413]) && otheruses(r_254[@i_413]) && ((x1_313 = x1_259[@i_413]) && ((x2_312 = x2_258[@i_413]) && ((x3_311 = x3_257[@i_413]) && ((x4_310 = x4_256[@i_413]) && (x5_309 = x5_255[@i_413]))))) then
      (
        let sk_u: hash0 = r_254[@i_413] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind  suchthat defined(j[@i_165], r_260[@i_165]) && otheruses(r_260[@i_165]) && (!_41 = j[@i_165]) then
      (
        let @i_412 <= NS = @i_165 in
        let sk_u: hash0 = r_260[@i_165] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_308: hash0;
        let sk_u: hash0 = r_308 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      new r1_77: hash1;
      let x1_307: host = U in
      let x2_306: host = S in
      let x3_305: G = X in
      let x4_304: G = Y[@i_165] in
      let x5_303: G = K_u in
      find [unique] @i_403 <= qH0 suchthat defined(x1_259[@i_403], x2_258[@i_403], x3_257[@i_403], x4_256[@i_403], x5_255[@i_403], r_254[@i_403]) && otheruses(r_254[@i_403]) && ((x1_307 = x1_259[@i_403]) && ((x2_306 = x2_258[@i_403]) && ((x3_305 = x3_257[@i_403]) && ((x4_304 = x4_256[@i_403]) && (x5_303 = x5_255[@i_403]))))) then
      (
        let sk_u: hash0 = r_254[@i_403] in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      else
        new r_302: hash0;
        let sk_u: hash0 = r_302 in
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
  )
  else
    new @2_r4_137: G;
    let Y_u: G = @2_r4_137 in
    let K_u: G = exp(@2_r4_137, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    let x3_275: G = X in
    let x4_274: G = @2_r4_137 in
    let x5_273: G = K_u in
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, sk_u);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_136: G = cst_G in
  let @2_ke_135: passwd = cst_passwd in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let x1_265: host = U in
    let x2_264: host = S in
    let x3_263: G = X_s in
    let x4_262: G = Y in
    let x5_261: G = K_s in
    find [unique] @i_333 <= qH0 suchthat defined(x1_259[@i_333], x2_258[@i_333], x3_257[@i_333], x4_256[@i_333], x5_255[@i_333], r_254[@i_333]) && otheruses(r_254[@i_333]) && ((x1_265 = x1_259[@i_333]) && ((x2_264 = x2_258[@i_333]) && ((x3_263 = x3_257[@i_333]) && ((x4_262 = x4_256[@i_333]) && (x5_261 = x5_255[@i_333]))))) then
    (
      let sk_s: hash0 = r_254[@i_333] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind  suchthat defined(@i_165[j], r_302[j]) && otheruses(r_302[j]) && (!_42 = @i_165[j]) then
    (
      let @i_325 <= NU = j in
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind  suchthat defined(@i_165[j], r_308[j]) && otheruses(r_308[j]) && (!_42 = @i_165[j]) then
    (
      let @i_324 <= NU = j in
      let sk_s: hash0 = r_308[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    else
      new r_260: hash0;
      let sk_s: hash0 = r_260 in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
  )
  orfind  suchthat defined(Y_u[j], K_u[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = X_s in
    let x4_268: G = Y in
    let x5_267: G = K_s in
    find [unique] @i_343 <= qH0 suchthat defined(x1_259[@i_343], x2_258[@i_343], x3_257[@i_343], x4_256[@i_343], x5_255[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1_259[@i_343]) && ((x2_270 = x2_258[@i_343]) && ((x3_269 = x3_257[@i_343]) && ((x4_268 = x4_256[@i_343]) && (x5_267 = x5_255[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let @i_335 <= NU = j in
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  let @2_x_133: G = cst_G in
  let @2_ke_132: passwd = cst_passwd in
  find [unique] @i_155 <= qD suchthat defined(@2_r4_128[@i_155], @2_kd[@i_155], @2_m[@i_155]) && otheruses(@2_m[@i_155] -> @2_r4_128[@i_155]) && ((@2_x = @2_r4_128[@i_155]) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@2_r4_137[@i_152], Ystar_u[@i_152]) && otheruses(Ystar_u[@i_152] -> @2_r4_137[@i_152]) && ((@2_x = @2_r4_137[@i_152]) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  let @2_m_130: G = cst_G in
  let @2_kd_129: passwd = cst_passwd in
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @2_r4_128[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @2_r4_128[@i_147])
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @2_r4_137[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], @2_r4_137[@i_144])
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @2_r4_128: G;
    out(@2_c4[!_44], @2_r4_128)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_259: host = x1 in
  let x2_258: host = x2 in
  let x3_257: G = x3 in
  let x4_256: G = x4 in
  let x5_255: G = x5 in
  find [unique] @i_323 <= qH0 suchthat defined(x1_259[@i_323], x2_258[@i_323], x3_257[@i_323], x4_256[@i_323], x5_255[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1_259 = x1_259[@i_323]) && ((x2_258 = x2_258[@i_323]) && ((x3_257 = x3_257[@i_323]) && ((x4_256 = x4_256[@i_323]) && (x5_255 = x5_255[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  orfind @i_322 <= NS suchthat defined(x1_265[@i_322], x2_264[@i_322], x3_263[@i_322], x4_262[@i_322], x5_261[@i_322], r_260[@i_322]) && otheruses(r_260[@i_322]) && ((x1_259 = x1_265[@i_322]) && ((x2_258 = x2_264[@i_322]) && ((x3_257 = x3_263[@i_322]) && ((x4_256 = x4_262[@i_322]) && (x5_255 = x5_261[@i_322]))))) then
    out(c20[!_45], r_260[@i_322])
  orfind @i_321 <= NS suchthat defined(x1_271[@i_321], x2_270[@i_321], x3_269[@i_321], x4_268[@i_321], x5_267[@i_321], r_266[@i_321]) && otheruses(r_266[@i_321]) && ((x1_259 = x1_271[@i_321]) && ((x2_258 = x2_270[@i_321]) && ((x3_257 = x3_269[@i_321]) && ((x4_256 = x4_268[@i_321]) && (x5_255 = x5_267[@i_321]))))) then
    out(c20[!_45], r_266[@i_321])
  orfind @i_320 <= NU suchthat defined(x1_277[@i_320], x2_276[@i_320], x3_275[@i_320], x4_274[@i_320], x5_273[@i_320], r_272[@i_320]) && otheruses(r_272[@i_320]) && ((x1_259 = x1_277[@i_320]) && ((x2_258 = x2_276[@i_320]) && ((x3_257 = x3_275[@i_320]) && ((x4_256 = x4_274[@i_320]) && (x5_255 = x5_273[@i_320]))))) then
    out(c20[!_45], r_272[@i_320])
  orfind @i_319 <= NU suchthat defined(x1_283[@i_319], x2_282[@i_319], x3_281[@i_319], x4_280[@i_319], x5_279[@i_319], r_278[@i_319]) && otheruses(r_278[@i_319]) && ((x1_259 = x1_283[@i_319]) && ((x2_258 = x2_282[@i_319]) && ((x3_257 = x3_281[@i_319]) && ((x4_256 = x4_280[@i_319]) && (x5_255 = x5_279[@i_319]))))) then
    out(c20[!_45], r_278[@i_319])
  orfind @i_318 <= NU suchthat defined(x1_289[@i_318], x2_288[@i_318], x3_287[@i_318], x4_286[@i_318], x5_285[@i_318], r_284[@i_318]) && otheruses(r_284[@i_318]) && ((x1_259 = x1_289[@i_318]) && ((x2_258 = x2_288[@i_318]) && ((x3_257 = x3_287[@i_318]) && ((x4_256 = x4_286[@i_318]) && (x5_255 = x5_285[@i_318]))))) then
    out(c20[!_45], r_284[@i_318])
  orfind @i_317 <= NU suchthat defined(x1_295[@i_317], x2_294[@i_317], x3_293[@i_317], x4_292[@i_317], x5_291[@i_317], r_290[@i_317]) && otheruses(r_290[@i_317]) && ((x1_259 = x1_295[@i_317]) && ((x2_258 = x2_294[@i_317]) && ((x3_257 = x3_293[@i_317]) && ((x4_256 = x4_292[@i_317]) && (x5_255 = x5_291[@i_317]))))) then
    out(c20[!_45], r_290[@i_317])
  orfind @i_316 <= NU suchthat defined(x1_301[@i_316], x2_300[@i_316], x3_299[@i_316], x4_298[@i_316], x5_297[@i_316], r_296[@i_316]) && otheruses(r_296[@i_316]) && ((x1_259 = x1_301[@i_316]) && ((x2_258 = x2_300[@i_316]) && ((x3_257 = x3_299[@i_316]) && ((x4_256 = x4_298[@i_316]) && (x5_255 = x5_297[@i_316]))))) then
    out(c20[!_45], r_296[@i_316])
  orfind @i_315 <= NU suchthat defined(x1_307[@i_315], x2_306[@i_315], x3_305[@i_315], x4_304[@i_315], x5_303[@i_315], r_302[@i_315]) && otheruses(r_302[@i_315]) && ((x1_259 = x1_307[@i_315]) && ((x2_258 = x2_306[@i_315]) && ((x3_257 = x3_305[@i_315]) && ((x4_256 = x4_304[@i_315]) && (x5_255 = x5_303[@i_315]))))) then
    out(c20[!_45], r_302[@i_315])
  orfind @i_314 <= NU suchthat defined(x1_313[@i_314], x2_312[@i_314], x3_311[@i_314], x4_310[@i_314], x5_309[@i_314], r_308[@i_314]) && otheruses(r_308[@i_314]) && ((x1_259 = x1_313[@i_314]) && ((x2_258 = x2_312[@i_314]) && ((x3_257 = x3_311[@i_314]) && ((x4_256 = x4_310[@i_314]) && (x5_255 = x5_309[@i_314]))))) then
    out(c20[!_45], r_308[@i_314])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying move all binders yields

Game 14 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @2_r4_128[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = @2_r4_128[@i_171] in
    let K_u: G = exp(@2_r4_128[@i_171], x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((@2_r4_128[@i_171] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_289: host = U in
      let x2_288: host = S in
      let x3_287: G = X in
      let x4_286: G = @2_r4_128[@i_171] in
      let x5_285: G = K_u in
      find [unique] @i_373 <= qH0 suchthat defined(x1_259[@i_373], x2_258[@i_373], x3_257[@i_373], x4_256[@i_373], x5_255[@i_373], r_254[@i_373]) && otheruses(r_254[@i_373]) && ((x1_289 = x1_259[@i_373]) && ((x2_288 = x2_258[@i_373]) && ((x3_287 = x3_257[@i_373]) && ((x4_286 = x4_256[@i_373]) && (x5_285 = x5_255[@i_373]))))) then
      (
        let sk_u: hash0 = r_254[@i_373] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_284: hash0;
        let sk_u: hash0 = r_284 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_283: host = U in
      let x2_282: host = S in
      let x3_281: G = X in
      let x4_280: G = @2_r4_128[@i_171] in
      let x5_279: G = K_u in
      find [unique] @i_363 <= qH0 suchthat defined(x1_259[@i_363], x2_258[@i_363], x3_257[@i_363], x4_256[@i_363], x5_255[@i_363], r_254[@i_363]) && otheruses(r_254[@i_363]) && ((x1_283 = x1_259[@i_363]) && ((x2_282 = x2_258[@i_363]) && ((x3_281 = x3_257[@i_363]) && ((x4_280 = x4_256[@i_363]) && (x5_279 = x5_255[@i_363]))))) then
      (
        let sk_u: hash0 = r_254[@i_363] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      else
        new r_278: hash0;
        let sk_u: hash0 = r_278 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @2_r4_137[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = @2_r4_137[@i_168] in
    let K_u: G = exp(@2_r4_137[@i_168], x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((@2_r4_137[@i_168] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_301: host = U in
      let x2_300: host = S in
      let x3_299: G = X in
      let x4_298: G = @2_r4_137[@i_168] in
      let x5_297: G = K_u in
      find [unique] @i_393 <= qH0 suchthat defined(x1_259[@i_393], x2_258[@i_393], x3_257[@i_393], x4_256[@i_393], x5_255[@i_393], r_254[@i_393]) && otheruses(r_254[@i_393]) && ((x1_301 = x1_259[@i_393]) && ((x2_300 = x2_258[@i_393]) && ((x3_299 = x3_257[@i_393]) && ((x4_298 = x4_256[@i_393]) && (x5_297 = x5_255[@i_393]))))) then
      (
        let sk_u: hash0 = r_254[@i_393] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_296: hash0;
        let sk_u: hash0 = r_296 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_295: host = U in
      let x2_294: host = S in
      let x3_293: G = X in
      let x4_292: G = @2_r4_137[@i_168] in
      let x5_291: G = K_u in
      find [unique] @i_383 <= qH0 suchthat defined(x1_259[@i_383], x2_258[@i_383], x3_257[@i_383], x4_256[@i_383], x5_255[@i_383], r_254[@i_383]) && otheruses(r_254[@i_383]) && ((x1_295 = x1_259[@i_383]) && ((x2_294 = x2_258[@i_383]) && ((x3_293 = x3_257[@i_383]) && ((x4_292 = x4_256[@i_383]) && (x5_291 = x5_255[@i_383]))))) then
      (
        let sk_u: hash0 = r_254[@i_383] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      else
        new r_290: hash0;
        let sk_u: hash0 = r_290 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_313: host = U in
      let x2_312: host = S in
      let x3_311: G = X in
      let x4_310: G = Y[@i_165] in
      let x5_309: G = K_u in
      find [unique] @i_413 <= qH0 suchthat defined(x1_259[@i_413], x2_258[@i_413], x3_257[@i_413], x4_256[@i_413], x5_255[@i_413], r_254[@i_413]) && otheruses(r_254[@i_413]) && ((x1_313 = x1_259[@i_413]) && ((x2_312 = x2_258[@i_413]) && ((x3_311 = x3_257[@i_413]) && ((x4_310 = x4_256[@i_413]) && (x5_309 = x5_255[@i_413]))))) then
      (
        let sk_u: hash0 = r_254[@i_413] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind  suchthat defined(j[@i_165], r_260[@i_165]) && otheruses(r_260[@i_165]) && (!_41 = j[@i_165]) then
      (
        let @i_412 <= NS = @i_165 in
        let sk_u: hash0 = r_260[@i_165] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_308: hash0;
        let sk_u: hash0 = r_308 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], sk_u);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_307: host = U in
      let x2_306: host = S in
      let x3_305: G = X in
      let x4_304: G = Y[@i_165] in
      let x5_303: G = K_u in
      find [unique] @i_403 <= qH0 suchthat defined(x1_259[@i_403], x2_258[@i_403], x3_257[@i_403], x4_256[@i_403], x5_255[@i_403], r_254[@i_403]) && otheruses(r_254[@i_403]) && ((x1_307 = x1_259[@i_403]) && ((x2_306 = x2_258[@i_403]) && ((x3_305 = x3_257[@i_403]) && ((x4_304 = x4_256[@i_403]) && (x5_303 = x5_255[@i_403]))))) then
      (
        let sk_u: hash0 = r_254[@i_403] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
      )
      else
        new r_302: hash0;
        let sk_u: hash0 = r_302 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, sk_u);
        out(c6[!_41], r1_77)
  )
  else
    new @2_r4_137: G;
    let Y_u: G = @2_r4_137 in
    let K_u: G = exp(@2_r4_137, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    let x3_275: G = X in
    let x4_274: G = @2_r4_137 in
    let x5_273: G = K_u in
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, sk_u);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let x1_265: host = U in
    let x2_264: host = S in
    let x3_263: G = X_s in
    let x4_262: G = Y in
    let x5_261: G = K_s in
    find [unique] @i_333 <= qH0 suchthat defined(x1_259[@i_333], x2_258[@i_333], x3_257[@i_333], x4_256[@i_333], x5_255[@i_333], r_254[@i_333]) && otheruses(r_254[@i_333]) && ((x1_265 = x1_259[@i_333]) && ((x2_264 = x2_258[@i_333]) && ((x3_263 = x3_257[@i_333]) && ((x4_262 = x4_256[@i_333]) && (x5_261 = x5_255[@i_333]))))) then
    (
      let sk_s: hash0 = r_254[@i_333] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind  suchthat defined(@i_165[j], r_302[j]) && otheruses(r_302[j]) && (!_42 = @i_165[j]) then
    (
      let @i_325 <= NU = j in
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind  suchthat defined(@i_165[j], r_308[j]) && otheruses(r_308[j]) && (!_42 = @i_165[j]) then
    (
      let @i_324 <= NU = j in
      let sk_s: hash0 = r_308[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    else
      new r_260: hash0;
      let sk_s: hash0 = r_260 in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
  )
  orfind  suchthat defined(Y_u[j], K_u[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = X_s in
    let x4_268: G = Y in
    let x5_267: G = K_s in
    find [unique] @i_343 <= qH0 suchthat defined(x1_259[@i_343], x2_258[@i_343], x3_257[@i_343], x4_256[@i_343], x5_255[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1_259[@i_343]) && ((x2_270 = x2_258[@i_343]) && ((x3_269 = x3_257[@i_343]) && ((x4_268 = x4_256[@i_343]) && (x5_267 = x5_255[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let @i_335 <= NU = j in
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, sk_s)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@2_r4_128[@i_155], @2_kd[@i_155], @2_m[@i_155]) && otheruses(@2_m[@i_155] -> @2_r4_128[@i_155]) && ((@2_x = @2_r4_128[@i_155]) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@2_r4_137[@i_152], Ystar_u[@i_152]) && otheruses(Ystar_u[@i_152] -> @2_r4_137[@i_152]) && ((@2_x = @2_r4_137[@i_152]) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @2_r4_128[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @2_r4_128[@i_147])
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @2_r4_137[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], @2_r4_137[@i_144])
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @2_r4_128: G;
    out(@2_c4[!_44], @2_r4_128)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_259: host = x1 in
  let x2_258: host = x2 in
  let x3_257: G = x3 in
  let x4_256: G = x4 in
  let x5_255: G = x5 in
  find [unique] @i_323 <= qH0 suchthat defined(x1_259[@i_323], x2_258[@i_323], x3_257[@i_323], x4_256[@i_323], x5_255[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1_259 = x1_259[@i_323]) && ((x2_258 = x2_258[@i_323]) && ((x3_257 = x3_257[@i_323]) && ((x4_256 = x4_256[@i_323]) && (x5_255 = x5_255[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  orfind @i_322 <= NS suchthat defined(x1_265[@i_322], x2_264[@i_322], x3_263[@i_322], x4_262[@i_322], x5_261[@i_322], r_260[@i_322]) && otheruses(r_260[@i_322]) && ((x1_259 = x1_265[@i_322]) && ((x2_258 = x2_264[@i_322]) && ((x3_257 = x3_263[@i_322]) && ((x4_256 = x4_262[@i_322]) && (x5_255 = x5_261[@i_322]))))) then
    out(c20[!_45], r_260[@i_322])
  orfind @i_321 <= NS suchthat defined(x1_271[@i_321], x2_270[@i_321], x3_269[@i_321], x4_268[@i_321], x5_267[@i_321], r_266[@i_321]) && otheruses(r_266[@i_321]) && ((x1_259 = x1_271[@i_321]) && ((x2_258 = x2_270[@i_321]) && ((x3_257 = x3_269[@i_321]) && ((x4_256 = x4_268[@i_321]) && (x5_255 = x5_267[@i_321]))))) then
    out(c20[!_45], r_266[@i_321])
  orfind @i_320 <= NU suchthat defined(x1_277[@i_320], x2_276[@i_320], x3_275[@i_320], x4_274[@i_320], x5_273[@i_320], r_272[@i_320]) && otheruses(r_272[@i_320]) && ((x1_259 = x1_277[@i_320]) && ((x2_258 = x2_276[@i_320]) && ((x3_257 = x3_275[@i_320]) && ((x4_256 = x4_274[@i_320]) && (x5_255 = x5_273[@i_320]))))) then
    out(c20[!_45], r_272[@i_320])
  orfind @i_319 <= NU suchthat defined(x1_283[@i_319], x2_282[@i_319], x3_281[@i_319], x4_280[@i_319], x5_279[@i_319], r_278[@i_319]) && otheruses(r_278[@i_319]) && ((x1_259 = x1_283[@i_319]) && ((x2_258 = x2_282[@i_319]) && ((x3_257 = x3_281[@i_319]) && ((x4_256 = x4_280[@i_319]) && (x5_255 = x5_279[@i_319]))))) then
    out(c20[!_45], r_278[@i_319])
  orfind @i_318 <= NU suchthat defined(x1_289[@i_318], x2_288[@i_318], x3_287[@i_318], x4_286[@i_318], x5_285[@i_318], r_284[@i_318]) && otheruses(r_284[@i_318]) && ((x1_259 = x1_289[@i_318]) && ((x2_258 = x2_288[@i_318]) && ((x3_257 = x3_287[@i_318]) && ((x4_256 = x4_286[@i_318]) && (x5_255 = x5_285[@i_318]))))) then
    out(c20[!_45], r_284[@i_318])
  orfind @i_317 <= NU suchthat defined(x1_295[@i_317], x2_294[@i_317], x3_293[@i_317], x4_292[@i_317], x5_291[@i_317], r_290[@i_317]) && otheruses(r_290[@i_317]) && ((x1_259 = x1_295[@i_317]) && ((x2_258 = x2_294[@i_317]) && ((x3_257 = x3_293[@i_317]) && ((x4_256 = x4_292[@i_317]) && (x5_255 = x5_291[@i_317]))))) then
    out(c20[!_45], r_290[@i_317])
  orfind @i_316 <= NU suchthat defined(x1_301[@i_316], x2_300[@i_316], x3_299[@i_316], x4_298[@i_316], x5_297[@i_316], r_296[@i_316]) && otheruses(r_296[@i_316]) && ((x1_259 = x1_301[@i_316]) && ((x2_258 = x2_300[@i_316]) && ((x3_257 = x3_299[@i_316]) && ((x4_256 = x4_298[@i_316]) && (x5_255 = x5_297[@i_316]))))) then
    out(c20[!_45], r_296[@i_316])
  orfind @i_315 <= NU suchthat defined(x1_307[@i_315], x2_306[@i_315], x3_305[@i_315], x4_304[@i_315], x5_303[@i_315], r_302[@i_315]) && otheruses(r_302[@i_315]) && ((x1_259 = x1_307[@i_315]) && ((x2_258 = x2_306[@i_315]) && ((x3_257 = x3_305[@i_315]) && ((x4_256 = x4_304[@i_315]) && (x5_255 = x5_303[@i_315]))))) then
    out(c20[!_45], r_302[@i_315])
  orfind @i_314 <= NU suchthat defined(x1_313[@i_314], x2_312[@i_314], x3_311[@i_314], x4_310[@i_314], x5_309[@i_314], r_308[@i_314]) && otheruses(r_308[@i_314]) && ((x1_259 = x1_313[@i_314]) && ((x2_258 = x2_312[@i_314]) && ((x3_257 = x3_311[@i_314]) && ((x4_256 = x4_310[@i_314]) && (x5_255 = x5_309[@i_314]))))) then
    out(c20[!_45], r_308[@i_314])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying remove assignments of useless yields

Game 15 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @2_r4_128[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = @2_r4_128[@i_171] in
    let K_u: G = exp(@2_r4_128[@i_171], x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((@2_r4_128[@i_171] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_289: host = U in
      let x2_288: host = S in
      let x3_287: G = cst_G in
      let x4_286: G = cst_G in
      let x5_285: G = cst_G in
      find [unique] @i_373 <= qH0 suchthat defined(x1[@i_373], x2[@i_373], x3[@i_373], x4[@i_373], x5[@i_373], x5_255[@i_373], x4_256[@i_373], x3_257[@i_373], x2_258[@i_373], x1_259[@i_373], r_254[@i_373]) && otheruses(r_254[@i_373]) && ((x1_289 = x1[@i_373]) && ((x2_288 = x2[@i_373]) && ((X = x3[@i_373]) && ((@2_r4_128[@i_171] = x4[@i_373]) && (K_u = x5[@i_373]))))) then
      (
        let sk_u: hash0 = r_254[@i_373] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_373]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_284: hash0;
        let sk_u: hash0 = r_284 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_284);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_283: host = U in
      let x2_282: host = S in
      let x3_281: G = cst_G in
      let x4_280: G = cst_G in
      let x5_279: G = cst_G in
      find [unique] @i_363 <= qH0 suchthat defined(x1[@i_363], x2[@i_363], x3[@i_363], x4[@i_363], x5[@i_363], x5_255[@i_363], x4_256[@i_363], x3_257[@i_363], x2_258[@i_363], x1_259[@i_363], r_254[@i_363]) && otheruses(r_254[@i_363]) && ((x1_283 = x1[@i_363]) && ((x2_282 = x2[@i_363]) && ((X = x3[@i_363]) && ((@2_r4_128[@i_171] = x4[@i_363]) && (K_u = x5[@i_363]))))) then
      (
        let sk_u: hash0 = r_254[@i_363] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_363]);
        out(c6[!_41], r1_77)
      )
      else
        new r_278: hash0;
        let sk_u: hash0 = r_278 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_278);
        out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @2_r4_137[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = @2_r4_137[@i_168] in
    let K_u: G = exp(@2_r4_137[@i_168], x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((@2_r4_137[@i_168] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_301: host = U in
      let x2_300: host = S in
      let x3_299: G = cst_G in
      let x4_298: G = cst_G in
      let x5_297: G = cst_G in
      find [unique] @i_393 <= qH0 suchthat defined(x1[@i_393], x2[@i_393], x3[@i_393], x4[@i_393], x5[@i_393], x5_255[@i_393], x4_256[@i_393], x3_257[@i_393], x2_258[@i_393], x1_259[@i_393], r_254[@i_393]) && otheruses(r_254[@i_393]) && ((x1_301 = x1[@i_393]) && ((x2_300 = x2[@i_393]) && ((X = x3[@i_393]) && ((@2_r4_137[@i_168] = x4[@i_393]) && (K_u = x5[@i_393]))))) then
      (
        let sk_u: hash0 = r_254[@i_393] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_393]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_296: hash0;
        let sk_u: hash0 = r_296 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_296);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_295: host = U in
      let x2_294: host = S in
      let x3_293: G = cst_G in
      let x4_292: G = cst_G in
      let x5_291: G = cst_G in
      find [unique] @i_383 <= qH0 suchthat defined(x1[@i_383], x2[@i_383], x3[@i_383], x4[@i_383], x5[@i_383], x5_255[@i_383], x4_256[@i_383], x3_257[@i_383], x2_258[@i_383], x1_259[@i_383], r_254[@i_383]) && otheruses(r_254[@i_383]) && ((x1_295 = x1[@i_383]) && ((x2_294 = x2[@i_383]) && ((X = x3[@i_383]) && ((@2_r4_137[@i_168] = x4[@i_383]) && (K_u = x5[@i_383]))))) then
      (
        let sk_u: hash0 = r_254[@i_383] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_383]);
        out(c6[!_41], r1_77)
      )
      else
        new r_290: hash0;
        let sk_u: hash0 = r_290 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_290);
        out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_313: host = U in
      let x2_312: host = S in
      let x3_311: G = cst_G in
      let x4_310: G = cst_G in
      let x5_309: G = cst_G in
      find [unique] @i_413 <= qH0 suchthat defined(x1[@i_413], x2[@i_413], x3[@i_413], x4[@i_413], x5[@i_413], x5_255[@i_413], x4_256[@i_413], x3_257[@i_413], x2_258[@i_413], x1_259[@i_413], r_254[@i_413]) && otheruses(r_254[@i_413]) && ((x1_313 = x1[@i_413]) && ((x2_312 = x2[@i_413]) && ((X = x3[@i_413]) && ((Y[@i_165] = x4[@i_413]) && (K_u = x5[@i_413]))))) then
      (
        let sk_u: hash0 = r_254[@i_413] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_413]);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind  suchthat defined(j[@i_165], r_260[@i_165]) && otheruses(r_260[@i_165]) && (!_41 = j[@i_165]) then
      (
        let sk_u: hash0 = r_260[@i_165] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_260[@i_165]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_308: hash0;
        let sk_u: hash0 = r_308 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_308);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_307: host = U in
      let x2_306: host = S in
      let x3_305: G = cst_G in
      let x4_304: G = cst_G in
      let x5_303: G = cst_G in
      find [unique] @i_403 <= qH0 suchthat defined(x1[@i_403], x2[@i_403], x3[@i_403], x4[@i_403], x5[@i_403], x5_255[@i_403], x4_256[@i_403], x3_257[@i_403], x2_258[@i_403], x1_259[@i_403], r_254[@i_403]) && otheruses(r_254[@i_403]) && ((x1_307 = x1[@i_403]) && ((x2_306 = x2[@i_403]) && ((X = x3[@i_403]) && ((Y[@i_165] = x4[@i_403]) && (K_u = x5[@i_403]))))) then
      (
        let sk_u: hash0 = r_254[@i_403] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_403]);
        out(c6[!_41], r1_77)
      )
      else
        new r_302: hash0;
        let sk_u: hash0 = r_302 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_302);
        out(c6[!_41], r1_77)
  )
  else
    new @2_r4_137: G;
    let Y_u: G = @2_r4_137 in
    let K_u: G = exp(@2_r4_137, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    let x3_275: G = cst_G in
    let x4_274: G = cst_G in
    let x5_273: G = cst_G in
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, r_272);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let x1_265: host = U in
    let x2_264: host = S in
    let x3_263: G = cst_G in
    let x4_262: G = cst_G in
    let x5_261: G = cst_G in
    find [unique] @i_333 <= qH0 suchthat defined(x1[@i_333], x2[@i_333], x3[@i_333], x4[@i_333], x5[@i_333], x5_255[@i_333], x4_256[@i_333], x3_257[@i_333], x2_258[@i_333], x1_259[@i_333], r_254[@i_333]) && otheruses(r_254[@i_333]) && ((x1_265 = x1[@i_333]) && ((x2_264 = x2[@i_333]) && ((X_s = x3[@i_333]) && ((Y = x4[@i_333]) && (K_s = x5[@i_333]))))) then
    (
      let sk_s: hash0 = r_254[@i_333] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_333])
    )
    orfind  suchthat defined(@i_165[j], r_302[j]) && otheruses(r_302[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    orfind  suchthat defined(@i_165[j], r_308[j]) && otheruses(r_308[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_308[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_308[j])
    )
    else
      new r_260: hash0;
      let sk_s: hash0 = r_260 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_260)
  )
  orfind  suchthat defined(Y_u[j], K_u[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = cst_G in
    let x4_268: G = cst_G in
    let x5_267: G = cst_G in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], x5_255[@i_343], x4_256[@i_343], x3_257[@i_343], x2_258[@i_343], x1_259[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (K_s = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@2_r4_128[@i_155], @2_kd[@i_155], @2_m[@i_155]) && otheruses(@2_m[@i_155] -> @2_r4_128[@i_155]) && ((@2_x = @2_r4_128[@i_155]) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@2_r4_137[@i_152], Ystar_u[@i_152]) && otheruses(Ystar_u[@i_152] -> @2_r4_137[@i_152]) && ((@2_x = @2_r4_137[@i_152]) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @2_r4_128[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @2_r4_128[@i_147])
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @2_r4_137[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], @2_r4_137[@i_144])
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @2_r4_128: G;
    out(@2_c4[!_44], @2_r4_128)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_259: host = cst_host in
  let x2_258: host = cst_host in
  let x3_257: G = cst_G in
  let x4_256: G = cst_G in
  let x5_255: G = cst_G in
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], x5_255[@i_323], x4_256[@i_323], x3_257[@i_323], x2_258[@i_323], x1_259[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  orfind @i_322 <= NS suchthat defined(X_s[@i_322], Y[@i_322], K_s[@i_322], x5_261[@i_322], x4_262[@i_322], x3_263[@i_322], x1_265[@i_322], x2_264[@i_322], r_260[@i_322]) && otheruses(r_260[@i_322]) && ((x1 = x1_265[@i_322]) && ((x2 = x2_264[@i_322]) && ((x3 = X_s[@i_322]) && ((x4 = Y[@i_322]) && (x5 = K_s[@i_322]))))) then
    out(c20[!_45], r_260[@i_322])
  orfind @i_321 <= NS suchthat defined(X_s[@i_321], Y[@i_321], K_s[@i_321], x5_267[@i_321], x4_268[@i_321], x3_269[@i_321], x1_271[@i_321], x2_270[@i_321], r_266[@i_321]) && otheruses(r_266[@i_321]) && ((x1 = x1_271[@i_321]) && ((x2 = x2_270[@i_321]) && ((x3 = X_s[@i_321]) && ((x4 = Y[@i_321]) && (x5 = K_s[@i_321]))))) then
    out(c20[!_45], r_266[@i_321])
  orfind @i_320 <= NU suchthat defined(X[@i_320], @2_r4_137[@i_320], K_u[@i_320], x5_273[@i_320], x4_274[@i_320], x3_275[@i_320], x1_277[@i_320], x2_276[@i_320], r_272[@i_320]) && otheruses(r_272[@i_320]) && ((x1 = x1_277[@i_320]) && ((x2 = x2_276[@i_320]) && ((x3 = X[@i_320]) && ((x4 = @2_r4_137[@i_320]) && (x5 = K_u[@i_320]))))) then
    out(c20[!_45], r_272[@i_320])
  orfind @i_319 <= NU suchthat defined(X[@i_319], @2_r4_128[@i_171[@i_319]], K_u[@i_319], x5_279[@i_319], x4_280[@i_319], x3_281[@i_319], x1_283[@i_319], x2_282[@i_319], r_278[@i_319]) && otheruses(r_278[@i_319]) && ((x1 = x1_283[@i_319]) && ((x2 = x2_282[@i_319]) && ((x3 = X[@i_319]) && ((x4 = @2_r4_128[@i_171[@i_319]]) && (x5 = K_u[@i_319]))))) then
    out(c20[!_45], r_278[@i_319])
  orfind @i_318 <= NU suchthat defined(X[@i_318], @2_r4_128[@i_171[@i_318]], K_u[@i_318], x5_285[@i_318], x4_286[@i_318], x3_287[@i_318], x1_289[@i_318], x2_288[@i_318], r_284[@i_318]) && otheruses(r_284[@i_318]) && ((x1 = x1_289[@i_318]) && ((x2 = x2_288[@i_318]) && ((x3 = X[@i_318]) && ((x4 = @2_r4_128[@i_171[@i_318]]) && (x5 = K_u[@i_318]))))) then
    out(c20[!_45], r_284[@i_318])
  orfind @i_317 <= NU suchthat defined(X[@i_317], @2_r4_137[@i_168[@i_317]], K_u[@i_317], x5_291[@i_317], x4_292[@i_317], x3_293[@i_317], x1_295[@i_317], x2_294[@i_317], r_290[@i_317]) && otheruses(r_290[@i_317]) && ((x1 = x1_295[@i_317]) && ((x2 = x2_294[@i_317]) && ((x3 = X[@i_317]) && ((x4 = @2_r4_137[@i_168[@i_317]]) && (x5 = K_u[@i_317]))))) then
    out(c20[!_45], r_290[@i_317])
  orfind @i_316 <= NU suchthat defined(X[@i_316], @2_r4_137[@i_168[@i_316]], K_u[@i_316], x5_297[@i_316], x4_298[@i_316], x3_299[@i_316], x1_301[@i_316], x2_300[@i_316], r_296[@i_316]) && otheruses(r_296[@i_316]) && ((x1 = x1_301[@i_316]) && ((x2 = x2_300[@i_316]) && ((x3 = X[@i_316]) && ((x4 = @2_r4_137[@i_168[@i_316]]) && (x5 = K_u[@i_316]))))) then
    out(c20[!_45], r_296[@i_316])
  orfind @i_315 <= NU suchthat defined(X[@i_315], Y[@i_165[@i_315]], K_u[@i_315], x5_303[@i_315], x4_304[@i_315], x3_305[@i_315], x1_307[@i_315], x2_306[@i_315], r_302[@i_315]) && otheruses(r_302[@i_315]) && ((x1 = x1_307[@i_315]) && ((x2 = x2_306[@i_315]) && ((x3 = X[@i_315]) && ((x4 = Y[@i_165[@i_315]]) && (x5 = K_u[@i_315]))))) then
    out(c20[!_45], r_302[@i_315])
  orfind @i_314 <= NU suchthat defined(X[@i_314], Y[@i_165[@i_314]], K_u[@i_314], x5_309[@i_314], x4_310[@i_314], x3_311[@i_314], x1_313[@i_314], x2_312[@i_314], r_308[@i_314]) && otheruses(r_308[@i_314]) && ((x1 = x1_313[@i_314]) && ((x2 = x2_312[@i_314]) && ((x3 = X[@i_314]) && ((x4 = Y[@i_165[@i_314]]) && (x5 = K_u[@i_314]))))) then
    out(c20[!_45], r_308[@i_314])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
 yields

Game 16 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@1_x_535[@i_171], @2_m[@i_171], @2_kd[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_x_535[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = exp(g, @1_x_535[@i_171]) in
    let K_u: G = exp(g, mult(@1_x_535[@i_171], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_535[@i_171]) = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_289: host = U in
      let x2_288: host = S in
      let x3_287: G = cst_G in
      let x4_286: G = cst_G in
      let x5_285: G = cst_G in
      find [unique] @i_373 <= qH0 suchthat defined(x1[@i_373], x2[@i_373], x3[@i_373], x4[@i_373], x5[@i_373], x5_255[@i_373], x4_256[@i_373], x3_257[@i_373], x2_258[@i_373], x1_259[@i_373], r_254[@i_373]) && otheruses(r_254[@i_373]) && ((x1_289 = x1[@i_373]) && ((x2_288 = x2[@i_373]) && ((X = x3[@i_373]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_373]) && (K_u = x5[@i_373]))))) then
      (
        let sk_u: hash0 = r_254[@i_373] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_373]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_284: hash0;
        let sk_u: hash0 = r_284 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_284);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_283: host = U in
      let x2_282: host = S in
      let x3_281: G = cst_G in
      let x4_280: G = cst_G in
      let x5_279: G = cst_G in
      find [unique] @i_363 <= qH0 suchthat defined(x1[@i_363], x2[@i_363], x3[@i_363], x4[@i_363], x5[@i_363], x5_255[@i_363], x4_256[@i_363], x3_257[@i_363], x2_258[@i_363], x1_259[@i_363], r_254[@i_363]) && otheruses(r_254[@i_363]) && ((x1_283 = x1[@i_363]) && ((x2_282 = x2[@i_363]) && ((X = x3[@i_363]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_363]) && (K_u = x5[@i_363]))))) then
      (
        let sk_u: hash0 = r_254[@i_363] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_363]);
        out(c6[!_41], r1_77)
      )
      else
        new r_278: hash0;
        let sk_u: hash0 = r_278 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_278);
        out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @2_r4_137[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = @2_r4_137[@i_168] in
    let K_u: G = exp(@2_r4_137[@i_168], x) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((@2_r4_137[@i_168] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_301: host = U in
      let x2_300: host = S in
      let x3_299: G = cst_G in
      let x4_298: G = cst_G in
      let x5_297: G = cst_G in
      find [unique] @i_393 <= qH0 suchthat defined(x1[@i_393], x2[@i_393], x3[@i_393], x4[@i_393], x5[@i_393], x5_255[@i_393], x4_256[@i_393], x3_257[@i_393], x2_258[@i_393], x1_259[@i_393], r_254[@i_393]) && otheruses(r_254[@i_393]) && ((x1_301 = x1[@i_393]) && ((x2_300 = x2[@i_393]) && ((X = x3[@i_393]) && ((@2_r4_137[@i_168] = x4[@i_393]) && (K_u = x5[@i_393]))))) then
      (
        let sk_u: hash0 = r_254[@i_393] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_393]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_296: hash0;
        let sk_u: hash0 = r_296 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_296);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_295: host = U in
      let x2_294: host = S in
      let x3_293: G = cst_G in
      let x4_292: G = cst_G in
      let x5_291: G = cst_G in
      find [unique] @i_383 <= qH0 suchthat defined(x1[@i_383], x2[@i_383], x3[@i_383], x4[@i_383], x5[@i_383], x5_255[@i_383], x4_256[@i_383], x3_257[@i_383], x2_258[@i_383], x1_259[@i_383], r_254[@i_383]) && otheruses(r_254[@i_383]) && ((x1_295 = x1[@i_383]) && ((x2_294 = x2[@i_383]) && ((X = x3[@i_383]) && ((@2_r4_137[@i_168] = x4[@i_383]) && (K_u = x5[@i_383]))))) then
      (
        let sk_u: hash0 = r_254[@i_383] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_383]);
        out(c6[!_41], r1_77)
      )
      else
        new r_290: hash0;
        let sk_u: hash0 = r_290 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_290);
        out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_313: host = U in
      let x2_312: host = S in
      let x3_311: G = cst_G in
      let x4_310: G = cst_G in
      let x5_309: G = cst_G in
      find [unique] @i_413 <= qH0 suchthat defined(x1[@i_413], x2[@i_413], x3[@i_413], x4[@i_413], x5[@i_413], x5_255[@i_413], x4_256[@i_413], x3_257[@i_413], x2_258[@i_413], x1_259[@i_413], r_254[@i_413]) && otheruses(r_254[@i_413]) && ((x1_313 = x1[@i_413]) && ((x2_312 = x2[@i_413]) && ((X = x3[@i_413]) && ((Y[@i_165] = x4[@i_413]) && (K_u = x5[@i_413]))))) then
      (
        let sk_u: hash0 = r_254[@i_413] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_413]);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind  suchthat defined(j[@i_165], r_260[@i_165]) && otheruses(r_260[@i_165]) && (!_41 = j[@i_165]) then
      (
        let sk_u: hash0 = r_260[@i_165] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_260[@i_165]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_308: hash0;
        let sk_u: hash0 = r_308 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_308);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_307: host = U in
      let x2_306: host = S in
      let x3_305: G = cst_G in
      let x4_304: G = cst_G in
      let x5_303: G = cst_G in
      find [unique] @i_403 <= qH0 suchthat defined(x1[@i_403], x2[@i_403], x3[@i_403], x4[@i_403], x5[@i_403], x5_255[@i_403], x4_256[@i_403], x3_257[@i_403], x2_258[@i_403], x1_259[@i_403], r_254[@i_403]) && otheruses(r_254[@i_403]) && ((x1_307 = x1[@i_403]) && ((x2_306 = x2[@i_403]) && ((X = x3[@i_403]) && ((Y[@i_165] = x4[@i_403]) && (K_u = x5[@i_403]))))) then
      (
        let sk_u: hash0 = r_254[@i_403] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_403]);
        out(c6[!_41], r1_77)
      )
      else
        new r_302: hash0;
        let sk_u: hash0 = r_302 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_302);
        out(c6[!_41], r1_77)
  )
  else
    new @2_r4_137: G;
    let Y_u: G = @2_r4_137 in
    let K_u: G = exp(@2_r4_137, x) in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    let x3_275: G = cst_G in
    let x4_274: G = cst_G in
    let x5_273: G = cst_G in
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, r_272);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let x1_265: host = U in
    let x2_264: host = S in
    let x3_263: G = cst_G in
    let x4_262: G = cst_G in
    let x5_261: G = cst_G in
    find [unique] @i_333 <= qH0 suchthat defined(x1[@i_333], x2[@i_333], x3[@i_333], x4[@i_333], x5[@i_333], x5_255[@i_333], x4_256[@i_333], x3_257[@i_333], x2_258[@i_333], x1_259[@i_333], r_254[@i_333]) && otheruses(r_254[@i_333]) && ((x1_265 = x1[@i_333]) && ((x2_264 = x2[@i_333]) && ((X_s = x3[@i_333]) && ((Y = x4[@i_333]) && (K_s = x5[@i_333]))))) then
    (
      let sk_s: hash0 = r_254[@i_333] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_333])
    )
    orfind  suchthat defined(@i_165[j], r_302[j]) && otheruses(r_302[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    orfind  suchthat defined(@i_165[j], r_308[j]) && otheruses(r_308[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_308[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_308[j])
    )
    else
      new r_260: hash0;
      let sk_s: hash0 = r_260 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_260)
  )
  orfind  suchthat defined(Y_u[j], K_u[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = cst_G in
    let x4_268: G = cst_G in
    let x5_267: G = cst_G in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], x5_255[@i_343], x4_256[@i_343], x3_257[@i_343], x2_258[@i_343], x1_259[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (K_s = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_x_535[@i_155], @2_r4_128[@i_155], @2_kd[@i_155], @2_m[@i_155]) && otheruses(@2_m[@i_155] -> @1_x_535[@i_155]) && ((@2_x = exp(g, @1_x_535[@i_155])) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@2_r4_137[@i_152], Ystar_u[@i_152]) && otheruses(Ystar_u[@i_152] -> @2_r4_137[@i_152]) && ((@2_x = @2_r4_137[@i_152]) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@1_x_535[@i_147], @2_m[@i_147], @2_kd[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_x_535[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], exp(g, @1_x_535[@i_147]))
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @2_r4_137[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], @2_r4_137[@i_144])
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_x_535: exponent;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], exp(g, @1_x_535))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_259: host = cst_host in
  let x2_258: host = cst_host in
  let x3_257: G = cst_G in
  let x4_256: G = cst_G in
  let x5_255: G = cst_G in
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], x5_255[@i_323], x4_256[@i_323], x3_257[@i_323], x2_258[@i_323], x1_259[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  orfind @i_322 <= NS suchthat defined(X_s[@i_322], Y[@i_322], K_s[@i_322], x5_261[@i_322], x4_262[@i_322], x3_263[@i_322], x1_265[@i_322], x2_264[@i_322], r_260[@i_322]) && otheruses(r_260[@i_322]) && ((x1 = x1_265[@i_322]) && ((x2 = x2_264[@i_322]) && ((x3 = X_s[@i_322]) && ((x4 = Y[@i_322]) && (x5 = K_s[@i_322]))))) then
    out(c20[!_45], r_260[@i_322])
  orfind @i_321 <= NS suchthat defined(X_s[@i_321], Y[@i_321], K_s[@i_321], x5_267[@i_321], x4_268[@i_321], x3_269[@i_321], x1_271[@i_321], x2_270[@i_321], r_266[@i_321]) && otheruses(r_266[@i_321]) && ((x1 = x1_271[@i_321]) && ((x2 = x2_270[@i_321]) && ((x3 = X_s[@i_321]) && ((x4 = Y[@i_321]) && (x5 = K_s[@i_321]))))) then
    out(c20[!_45], r_266[@i_321])
  orfind @i_320 <= NU suchthat defined(X[@i_320], @2_r4_137[@i_320], K_u[@i_320], x5_273[@i_320], x4_274[@i_320], x3_275[@i_320], x1_277[@i_320], x2_276[@i_320], r_272[@i_320]) && otheruses(r_272[@i_320]) && ((x1 = x1_277[@i_320]) && ((x2 = x2_276[@i_320]) && ((x3 = X[@i_320]) && ((x4 = @2_r4_137[@i_320]) && (x5 = K_u[@i_320]))))) then
    out(c20[!_45], r_272[@i_320])
  orfind @i_319 <= NU suchthat defined(@1_x_535[@i_171[@i_319]], X[@i_319], @2_r4_128[@i_171[@i_319]], K_u[@i_319], x5_279[@i_319], x4_280[@i_319], x3_281[@i_319], x1_283[@i_319], x2_282[@i_319], r_278[@i_319]) && otheruses(r_278[@i_319]) && ((x1 = x1_283[@i_319]) && ((x2 = x2_282[@i_319]) && ((x3 = X[@i_319]) && ((x4 = exp(g, @1_x_535[@i_171[@i_319]])) && (x5 = K_u[@i_319]))))) then
    out(c20[!_45], r_278[@i_319])
  orfind @i_318 <= NU suchthat defined(@1_x_535[@i_171[@i_318]], X[@i_318], @2_r4_128[@i_171[@i_318]], K_u[@i_318], x5_285[@i_318], x4_286[@i_318], x3_287[@i_318], x1_289[@i_318], x2_288[@i_318], r_284[@i_318]) && otheruses(r_284[@i_318]) && ((x1 = x1_289[@i_318]) && ((x2 = x2_288[@i_318]) && ((x3 = X[@i_318]) && ((x4 = exp(g, @1_x_535[@i_171[@i_318]])) && (x5 = K_u[@i_318]))))) then
    out(c20[!_45], r_284[@i_318])
  orfind @i_317 <= NU suchthat defined(X[@i_317], @2_r4_137[@i_168[@i_317]], K_u[@i_317], x5_291[@i_317], x4_292[@i_317], x3_293[@i_317], x1_295[@i_317], x2_294[@i_317], r_290[@i_317]) && otheruses(r_290[@i_317]) && ((x1 = x1_295[@i_317]) && ((x2 = x2_294[@i_317]) && ((x3 = X[@i_317]) && ((x4 = @2_r4_137[@i_168[@i_317]]) && (x5 = K_u[@i_317]))))) then
    out(c20[!_45], r_290[@i_317])
  orfind @i_316 <= NU suchthat defined(X[@i_316], @2_r4_137[@i_168[@i_316]], K_u[@i_316], x5_297[@i_316], x4_298[@i_316], x3_299[@i_316], x1_301[@i_316], x2_300[@i_316], r_296[@i_316]) && otheruses(r_296[@i_316]) && ((x1 = x1_301[@i_316]) && ((x2 = x2_300[@i_316]) && ((x3 = X[@i_316]) && ((x4 = @2_r4_137[@i_168[@i_316]]) && (x5 = K_u[@i_316]))))) then
    out(c20[!_45], r_296[@i_316])
  orfind @i_315 <= NU suchthat defined(X[@i_315], Y[@i_165[@i_315]], K_u[@i_315], x5_303[@i_315], x4_304[@i_315], x3_305[@i_315], x1_307[@i_315], x2_306[@i_315], r_302[@i_315]) && otheruses(r_302[@i_315]) && ((x1 = x1_307[@i_315]) && ((x2 = x2_306[@i_315]) && ((x3 = X[@i_315]) && ((x4 = Y[@i_165[@i_315]]) && (x5 = K_u[@i_315]))))) then
    out(c20[!_45], r_302[@i_315])
  orfind @i_314 <= NU suchthat defined(X[@i_314], Y[@i_165[@i_314]], K_u[@i_314], x5_309[@i_314], x4_310[@i_314], x3_311[@i_314], x1_313[@i_314], x2_312[@i_314], r_308[@i_314]) && otheruses(r_308[@i_314]) && ((x1 = x1_313[@i_314]) && ((x2 = x2_312[@i_314]) && ((x3 = X[@i_314]) && ((x4 = Y[@i_165[@i_314]]) && (x5 = K_u[@i_314]))))) then
    out(c20[!_45], r_308[@i_314])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
 yields

Game 17 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@1_x_535[@i_171], @2_m[@i_171], @2_kd[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_x_535[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = exp(g, @1_x_535[@i_171]) in
    let K_u: G = exp(g, mult(@1_x_535[@i_171], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_535[@i_171]) = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_289: host = U in
      let x2_288: host = S in
      let x3_287: G = cst_G in
      let x4_286: G = cst_G in
      let x5_285: G = cst_G in
      find [unique] @i_373 <= qH0 suchthat defined(x1[@i_373], x2[@i_373], x3[@i_373], x4[@i_373], x5[@i_373], x5_255[@i_373], x4_256[@i_373], x3_257[@i_373], x2_258[@i_373], x1_259[@i_373], r_254[@i_373]) && otheruses(r_254[@i_373]) && ((x1_289 = x1[@i_373]) && ((x2_288 = x2[@i_373]) && ((X = x3[@i_373]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_373]) && (K_u = x5[@i_373]))))) then
      (
        let sk_u: hash0 = r_254[@i_373] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_373]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_284: hash0;
        let sk_u: hash0 = r_284 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_284);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_283: host = U in
      let x2_282: host = S in
      let x3_281: G = cst_G in
      let x4_280: G = cst_G in
      let x5_279: G = cst_G in
      find [unique] @i_363 <= qH0 suchthat defined(x1[@i_363], x2[@i_363], x3[@i_363], x4[@i_363], x5[@i_363], x5_255[@i_363], x4_256[@i_363], x3_257[@i_363], x2_258[@i_363], x1_259[@i_363], r_254[@i_363]) && otheruses(r_254[@i_363]) && ((x1_283 = x1[@i_363]) && ((x2_282 = x2[@i_363]) && ((X = x3[@i_363]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_363]) && (K_u = x5[@i_363]))))) then
      (
        let sk_u: hash0 = r_254[@i_363] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_363]);
        out(c6[!_41], r1_77)
      )
      else
        new r_278: hash0;
        let sk_u: hash0 = r_278 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_278);
        out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(@1_x_650[@i_168], Ystar_u[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @1_x_650[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = exp(g, @1_x_650[@i_168]) in
    let K_u: G = exp(g, mult(@1_x_650[@i_168], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_650[@i_168]) = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_301: host = U in
      let x2_300: host = S in
      let x3_299: G = cst_G in
      let x4_298: G = cst_G in
      let x5_297: G = cst_G in
      find [unique] @i_393 <= qH0 suchthat defined(x1[@i_393], x2[@i_393], x3[@i_393], x4[@i_393], x5[@i_393], x5_255[@i_393], x4_256[@i_393], x3_257[@i_393], x2_258[@i_393], x1_259[@i_393], r_254[@i_393]) && otheruses(r_254[@i_393]) && ((x1_301 = x1[@i_393]) && ((x2_300 = x2[@i_393]) && ((X = x3[@i_393]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_393]) && (K_u = x5[@i_393]))))) then
      (
        let sk_u: hash0 = r_254[@i_393] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_393]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_296: hash0;
        let sk_u: hash0 = r_296 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_296);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_295: host = U in
      let x2_294: host = S in
      let x3_293: G = cst_G in
      let x4_292: G = cst_G in
      let x5_291: G = cst_G in
      find [unique] @i_383 <= qH0 suchthat defined(x1[@i_383], x2[@i_383], x3[@i_383], x4[@i_383], x5[@i_383], x5_255[@i_383], x4_256[@i_383], x3_257[@i_383], x2_258[@i_383], x1_259[@i_383], r_254[@i_383]) && otheruses(r_254[@i_383]) && ((x1_295 = x1[@i_383]) && ((x2_294 = x2[@i_383]) && ((X = x3[@i_383]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_383]) && (K_u = x5[@i_383]))))) then
      (
        let sk_u: hash0 = r_254[@i_383] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_383]);
        out(c6[!_41], r1_77)
      )
      else
        new r_290: hash0;
        let sk_u: hash0 = r_290 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_290);
        out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && (K_u = x15[@i_91]))))) then
    (
      let x1_313: host = U in
      let x2_312: host = S in
      let x3_311: G = cst_G in
      let x4_310: G = cst_G in
      let x5_309: G = cst_G in
      find [unique] @i_413 <= qH0 suchthat defined(x1[@i_413], x2[@i_413], x3[@i_413], x4[@i_413], x5[@i_413], x5_255[@i_413], x4_256[@i_413], x3_257[@i_413], x2_258[@i_413], x1_259[@i_413], r_254[@i_413]) && otheruses(r_254[@i_413]) && ((x1_313 = x1[@i_413]) && ((x2_312 = x2[@i_413]) && ((X = x3[@i_413]) && ((Y[@i_165] = x4[@i_413]) && (K_u = x5[@i_413]))))) then
      (
        let sk_u: hash0 = r_254[@i_413] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_413]);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind  suchthat defined(j[@i_165], r_260[@i_165]) && otheruses(r_260[@i_165]) && (!_41 = j[@i_165]) then
      (
        let sk_u: hash0 = r_260[@i_165] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_260[@i_165]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_308: hash0;
        let sk_u: hash0 = r_308 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_308);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_307: host = U in
      let x2_306: host = S in
      let x3_305: G = cst_G in
      let x4_304: G = cst_G in
      let x5_303: G = cst_G in
      find [unique] @i_403 <= qH0 suchthat defined(x1[@i_403], x2[@i_403], x3[@i_403], x4[@i_403], x5[@i_403], x5_255[@i_403], x4_256[@i_403], x3_257[@i_403], x2_258[@i_403], x1_259[@i_403], r_254[@i_403]) && otheruses(r_254[@i_403]) && ((x1_307 = x1[@i_403]) && ((x2_306 = x2[@i_403]) && ((X = x3[@i_403]) && ((Y[@i_165] = x4[@i_403]) && (K_u = x5[@i_403]))))) then
      (
        let sk_u: hash0 = r_254[@i_403] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_403]);
        out(c6[!_41], r1_77)
      )
      else
        new r_302: hash0;
        let sk_u: hash0 = r_302 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_302);
        out(c6[!_41], r1_77)
  )
  else
    new @1_x_650: exponent;
    let @2_r4_137: G = cst_G in
    let Y_u: G = exp(g, @1_x_650) in
    let K_u: G = exp(g, mult(@1_x_650, x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    let x3_275: G = cst_G in
    let x4_274: G = cst_G in
    let x5_273: G = cst_G in
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, r_272);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let x1_265: host = U in
    let x2_264: host = S in
    let x3_263: G = cst_G in
    let x4_262: G = cst_G in
    let x5_261: G = cst_G in
    find [unique] @i_333 <= qH0 suchthat defined(x1[@i_333], x2[@i_333], x3[@i_333], x4[@i_333], x5[@i_333], x5_255[@i_333], x4_256[@i_333], x3_257[@i_333], x2_258[@i_333], x1_259[@i_333], r_254[@i_333]) && otheruses(r_254[@i_333]) && ((x1_265 = x1[@i_333]) && ((x2_264 = x2[@i_333]) && ((X_s = x3[@i_333]) && ((Y = x4[@i_333]) && (K_s = x5[@i_333]))))) then
    (
      let sk_s: hash0 = r_254[@i_333] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_333])
    )
    orfind  suchthat defined(@i_165[j], r_302[j]) && otheruses(r_302[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    orfind  suchthat defined(@i_165[j], r_308[j]) && otheruses(r_308[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_308[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_308[j])
    )
    else
      new r_260: hash0;
      let sk_s: hash0 = r_260 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_260)
  )
  orfind  suchthat defined(Y_u[j], K_u[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = cst_G in
    let x4_268: G = cst_G in
    let x5_267: G = cst_G in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], x5_255[@i_343], x4_256[@i_343], x3_257[@i_343], x2_258[@i_343], x1_259[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (K_s = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_x_535[@i_155], @2_r4_128[@i_155], @2_kd[@i_155], @2_m[@i_155]) && otheruses(@2_m[@i_155] -> @1_x_535[@i_155]) && ((@2_x = exp(g, @1_x_535[@i_155])) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@1_x_650[@i_152], @2_r4_137[@i_152], Ystar_u[@i_152]) && otheruses(Ystar_u[@i_152] -> @1_x_650[@i_152]) && ((@2_x = exp(g, @1_x_650[@i_152])) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@1_x_535[@i_147], @2_m[@i_147], @2_kd[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_x_535[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], exp(g, @1_x_535[@i_147]))
  orfind @i_144 <= NU suchthat defined(@1_x_650[@i_144], Ystar_u[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @1_x_650[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], exp(g, @1_x_650[@i_144]))
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_x_535: exponent;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], exp(g, @1_x_535))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_259: host = cst_host in
  let x2_258: host = cst_host in
  let x3_257: G = cst_G in
  let x4_256: G = cst_G in
  let x5_255: G = cst_G in
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], x5_255[@i_323], x4_256[@i_323], x3_257[@i_323], x2_258[@i_323], x1_259[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  orfind @i_322 <= NS suchthat defined(X_s[@i_322], Y[@i_322], K_s[@i_322], x5_261[@i_322], x4_262[@i_322], x3_263[@i_322], x1_265[@i_322], x2_264[@i_322], r_260[@i_322]) && otheruses(r_260[@i_322]) && ((x1 = x1_265[@i_322]) && ((x2 = x2_264[@i_322]) && ((x3 = X_s[@i_322]) && ((x4 = Y[@i_322]) && (x5 = K_s[@i_322]))))) then
    out(c20[!_45], r_260[@i_322])
  orfind @i_321 <= NS suchthat defined(X_s[@i_321], Y[@i_321], K_s[@i_321], x5_267[@i_321], x4_268[@i_321], x3_269[@i_321], x1_271[@i_321], x2_270[@i_321], r_266[@i_321]) && otheruses(r_266[@i_321]) && ((x1 = x1_271[@i_321]) && ((x2 = x2_270[@i_321]) && ((x3 = X_s[@i_321]) && ((x4 = Y[@i_321]) && (x5 = K_s[@i_321]))))) then
    out(c20[!_45], r_266[@i_321])
  orfind @i_320 <= NU suchthat defined(@1_x_650[@i_320], X[@i_320], @2_r4_137[@i_320], K_u[@i_320], x5_273[@i_320], x4_274[@i_320], x3_275[@i_320], x1_277[@i_320], x2_276[@i_320], r_272[@i_320]) && otheruses(r_272[@i_320]) && ((x1 = x1_277[@i_320]) && ((x2 = x2_276[@i_320]) && ((x3 = X[@i_320]) && ((x4 = exp(g, @1_x_650[@i_320])) && (x5 = K_u[@i_320]))))) then
    out(c20[!_45], r_272[@i_320])
  orfind @i_319 <= NU suchthat defined(@1_x_535[@i_171[@i_319]], X[@i_319], @2_r4_128[@i_171[@i_319]], K_u[@i_319], x5_279[@i_319], x4_280[@i_319], x3_281[@i_319], x1_283[@i_319], x2_282[@i_319], r_278[@i_319]) && otheruses(r_278[@i_319]) && ((x1 = x1_283[@i_319]) && ((x2 = x2_282[@i_319]) && ((x3 = X[@i_319]) && ((x4 = exp(g, @1_x_535[@i_171[@i_319]])) && (x5 = K_u[@i_319]))))) then
    out(c20[!_45], r_278[@i_319])
  orfind @i_318 <= NU suchthat defined(@1_x_535[@i_171[@i_318]], X[@i_318], @2_r4_128[@i_171[@i_318]], K_u[@i_318], x5_285[@i_318], x4_286[@i_318], x3_287[@i_318], x1_289[@i_318], x2_288[@i_318], r_284[@i_318]) && otheruses(r_284[@i_318]) && ((x1 = x1_289[@i_318]) && ((x2 = x2_288[@i_318]) && ((x3 = X[@i_318]) && ((x4 = exp(g, @1_x_535[@i_171[@i_318]])) && (x5 = K_u[@i_318]))))) then
    out(c20[!_45], r_284[@i_318])
  orfind @i_317 <= NU suchthat defined(@1_x_650[@i_168[@i_317]], X[@i_317], @2_r4_137[@i_168[@i_317]], K_u[@i_317], x5_291[@i_317], x4_292[@i_317], x3_293[@i_317], x1_295[@i_317], x2_294[@i_317], r_290[@i_317]) && otheruses(r_290[@i_317]) && ((x1 = x1_295[@i_317]) && ((x2 = x2_294[@i_317]) && ((x3 = X[@i_317]) && ((x4 = exp(g, @1_x_650[@i_168[@i_317]])) && (x5 = K_u[@i_317]))))) then
    out(c20[!_45], r_290[@i_317])
  orfind @i_316 <= NU suchthat defined(@1_x_650[@i_168[@i_316]], X[@i_316], @2_r4_137[@i_168[@i_316]], K_u[@i_316], x5_297[@i_316], x4_298[@i_316], x3_299[@i_316], x1_301[@i_316], x2_300[@i_316], r_296[@i_316]) && otheruses(r_296[@i_316]) && ((x1 = x1_301[@i_316]) && ((x2 = x2_300[@i_316]) && ((x3 = X[@i_316]) && ((x4 = exp(g, @1_x_650[@i_168[@i_316]])) && (x5 = K_u[@i_316]))))) then
    out(c20[!_45], r_296[@i_316])
  orfind @i_315 <= NU suchthat defined(X[@i_315], Y[@i_165[@i_315]], K_u[@i_315], x5_303[@i_315], x4_304[@i_315], x3_305[@i_315], x1_307[@i_315], x2_306[@i_315], r_302[@i_315]) && otheruses(r_302[@i_315]) && ((x1 = x1_307[@i_315]) && ((x2 = x2_306[@i_315]) && ((x3 = X[@i_315]) && ((x4 = Y[@i_165[@i_315]]) && (x5 = K_u[@i_315]))))) then
    out(c20[!_45], r_302[@i_315])
  orfind @i_314 <= NU suchthat defined(X[@i_314], Y[@i_165[@i_314]], K_u[@i_314], x5_309[@i_314], x4_310[@i_314], x3_311[@i_314], x1_313[@i_314], x2_312[@i_314], r_308[@i_314]) && otheruses(r_308[@i_314]) && ((x1 = x1_313[@i_314]) && ((x2 = x2_312[@i_314]) && ((x3 = X[@i_314]) && ((x4 = Y[@i_165[@i_314]]) && (x5 = K_u[@i_314]))))) then
    out(c20[!_45], r_308[@i_314])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying SA rename K_u yields

Game 18 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@1_x_535[@i_171], @2_m[@i_171], @2_kd[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_x_535[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = exp(g, @1_x_535[@i_171]) in
    let K_u_787: G = exp(g, mult(@1_x_535[@i_171], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_535[@i_171]) = x14[@i_91]) && (K_u_787 = x15[@i_91]))))) then
    (
      let x1_289: host = U in
      let x2_288: host = S in
      let x3_287: G = cst_G in
      let x4_286: G = cst_G in
      let x5_285: G = cst_G in
      find [unique] @i_373 <= qH0 suchthat defined(x1[@i_373], x2[@i_373], x3[@i_373], x4[@i_373], x5[@i_373], x5_255[@i_373], x4_256[@i_373], x3_257[@i_373], x2_258[@i_373], x1_259[@i_373], r_254[@i_373]) && otheruses(r_254[@i_373]) && ((x1_289 = x1[@i_373]) && ((x2_288 = x2[@i_373]) && ((X = x3[@i_373]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_373]) && (K_u_787 = x5[@i_373]))))) then
      (
        let sk_u: hash0 = r_254[@i_373] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_373]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_284: hash0;
        let sk_u: hash0 = r_284 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_284);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_283: host = U in
      let x2_282: host = S in
      let x3_281: G = cst_G in
      let x4_280: G = cst_G in
      let x5_279: G = cst_G in
      find [unique] @i_363 <= qH0 suchthat defined(x1[@i_363], x2[@i_363], x3[@i_363], x4[@i_363], x5[@i_363], x5_255[@i_363], x4_256[@i_363], x3_257[@i_363], x2_258[@i_363], x1_259[@i_363], r_254[@i_363]) && otheruses(r_254[@i_363]) && ((x1_283 = x1[@i_363]) && ((x2_282 = x2[@i_363]) && ((X = x3[@i_363]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_363]) && (K_u_787 = x5[@i_363]))))) then
      (
        let sk_u: hash0 = r_254[@i_363] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_363]);
        out(c6[!_41], r1_77)
      )
      else
        new r_278: hash0;
        let sk_u: hash0 = r_278 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_278);
        out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(@1_x_650[@i_168], Ystar_u[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @1_x_650[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = exp(g, @1_x_650[@i_168]) in
    let K_u_788: G = exp(g, mult(@1_x_650[@i_168], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_650[@i_168]) = x14[@i_91]) && (K_u_788 = x15[@i_91]))))) then
    (
      let x1_301: host = U in
      let x2_300: host = S in
      let x3_299: G = cst_G in
      let x4_298: G = cst_G in
      let x5_297: G = cst_G in
      find [unique] @i_393 <= qH0 suchthat defined(x1[@i_393], x2[@i_393], x3[@i_393], x4[@i_393], x5[@i_393], x5_255[@i_393], x4_256[@i_393], x3_257[@i_393], x2_258[@i_393], x1_259[@i_393], r_254[@i_393]) && otheruses(r_254[@i_393]) && ((x1_301 = x1[@i_393]) && ((x2_300 = x2[@i_393]) && ((X = x3[@i_393]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_393]) && (K_u_788 = x5[@i_393]))))) then
      (
        let sk_u: hash0 = r_254[@i_393] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_393]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_296: hash0;
        let sk_u: hash0 = r_296 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_296);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_295: host = U in
      let x2_294: host = S in
      let x3_293: G = cst_G in
      let x4_292: G = cst_G in
      let x5_291: G = cst_G in
      find [unique] @i_383 <= qH0 suchthat defined(x1[@i_383], x2[@i_383], x3[@i_383], x4[@i_383], x5[@i_383], x5_255[@i_383], x4_256[@i_383], x3_257[@i_383], x2_258[@i_383], x1_259[@i_383], r_254[@i_383]) && otheruses(r_254[@i_383]) && ((x1_295 = x1[@i_383]) && ((x2_294 = x2[@i_383]) && ((X = x3[@i_383]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_383]) && (K_u_788 = x5[@i_383]))))) then
      (
        let sk_u: hash0 = r_254[@i_383] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_383]);
        out(c6[!_41], r1_77)
      )
      else
        new r_290: hash0;
        let sk_u: hash0 = r_290 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_290);
        out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u_789: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && (K_u_789 = x15[@i_91]))))) then
    (
      let x1_313: host = U in
      let x2_312: host = S in
      let x3_311: G = cst_G in
      let x4_310: G = cst_G in
      let x5_309: G = cst_G in
      find [unique] @i_413 <= qH0 suchthat defined(x1[@i_413], x2[@i_413], x3[@i_413], x4[@i_413], x5[@i_413], x5_255[@i_413], x4_256[@i_413], x3_257[@i_413], x2_258[@i_413], x1_259[@i_413], r_254[@i_413]) && otheruses(r_254[@i_413]) && ((x1_313 = x1[@i_413]) && ((x2_312 = x2[@i_413]) && ((X = x3[@i_413]) && ((Y[@i_165] = x4[@i_413]) && (K_u_789 = x5[@i_413]))))) then
      (
        let sk_u: hash0 = r_254[@i_413] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_413]);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind  suchthat defined(j[@i_165], r_260[@i_165]) && otheruses(r_260[@i_165]) && (!_41 = j[@i_165]) then
      (
        let sk_u: hash0 = r_260[@i_165] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_260[@i_165]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_308: hash0;
        let sk_u: hash0 = r_308 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_308);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_307: host = U in
      let x2_306: host = S in
      let x3_305: G = cst_G in
      let x4_304: G = cst_G in
      let x5_303: G = cst_G in
      find [unique] @i_403 <= qH0 suchthat defined(x1[@i_403], x2[@i_403], x3[@i_403], x4[@i_403], x5[@i_403], x5_255[@i_403], x4_256[@i_403], x3_257[@i_403], x2_258[@i_403], x1_259[@i_403], r_254[@i_403]) && otheruses(r_254[@i_403]) && ((x1_307 = x1[@i_403]) && ((x2_306 = x2[@i_403]) && ((X = x3[@i_403]) && ((Y[@i_165] = x4[@i_403]) && (K_u_789 = x5[@i_403]))))) then
      (
        let sk_u: hash0 = r_254[@i_403] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_403]);
        out(c6[!_41], r1_77)
      )
      else
        new r_302: hash0;
        let sk_u: hash0 = r_302 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_302);
        out(c6[!_41], r1_77)
  )
  else
    new @1_x_650: exponent;
    let @2_r4_137: G = cst_G in
    let Y_u: G = exp(g, @1_x_650) in
    let K_u_790: G = exp(g, mult(@1_x_650, x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    let x3_275: G = cst_G in
    let x4_274: G = cst_G in
    let x5_273: G = cst_G in
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, r_272);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let x1_265: host = U in
    let x2_264: host = S in
    let x3_263: G = cst_G in
    let x4_262: G = cst_G in
    let x5_261: G = cst_G in
    find [unique] @i_333 <= qH0 suchthat defined(x1[@i_333], x2[@i_333], x3[@i_333], x4[@i_333], x5[@i_333], x5_255[@i_333], x4_256[@i_333], x3_257[@i_333], x2_258[@i_333], x1_259[@i_333], r_254[@i_333]) && otheruses(r_254[@i_333]) && ((x1_265 = x1[@i_333]) && ((x2_264 = x2[@i_333]) && ((X_s = x3[@i_333]) && ((Y = x4[@i_333]) && (K_s = x5[@i_333]))))) then
    (
      let sk_s: hash0 = r_254[@i_333] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_333])
    )
    orfind  suchthat defined(@i_165[j], r_302[j]) && otheruses(r_302[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    orfind  suchthat defined(@i_165[j], r_308[j]) && otheruses(r_308[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_308[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_308[j])
    )
    else
      new r_260: hash0;
      let sk_s: hash0 = r_260 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_260)
  )
  orfind  suchthat defined(Y_u[j], K_u_787[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u_787[j])) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = cst_G in
    let x4_268: G = cst_G in
    let x5_267: G = cst_G in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], x5_255[@i_343], x4_256[@i_343], x3_257[@i_343], x2_258[@i_343], x1_259[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (K_s = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
  orfind  suchthat defined(Y_u[j], K_u_788[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u_788[j])) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = cst_G in
    let x4_268: G = cst_G in
    let x5_267: G = cst_G in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], x5_255[@i_343], x4_256[@i_343], x3_257[@i_343], x2_258[@i_343], x1_259[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (K_s = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
  orfind  suchthat defined(Y_u[j], K_u_789[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u_789[j])) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = cst_G in
    let x4_268: G = cst_G in
    let x5_267: G = cst_G in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], x5_255[@i_343], x4_256[@i_343], x3_257[@i_343], x2_258[@i_343], x1_259[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (K_s = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
  orfind  suchthat defined(Y_u[j], K_u_790[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u_790[j])) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = cst_G in
    let x4_268: G = cst_G in
    let x5_267: G = cst_G in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], x5_255[@i_343], x4_256[@i_343], x3_257[@i_343], x2_258[@i_343], x1_259[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (K_s = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_x_535[@i_155], @2_r4_128[@i_155], @2_kd[@i_155], @2_m[@i_155]) && otheruses(@2_m[@i_155] -> @1_x_535[@i_155]) && ((@2_x = exp(g, @1_x_535[@i_155])) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@1_x_650[@i_152], @2_r4_137[@i_152], Ystar_u[@i_152]) && otheruses(Ystar_u[@i_152] -> @1_x_650[@i_152]) && ((@2_x = exp(g, @1_x_650[@i_152])) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@1_x_535[@i_147], @2_m[@i_147], @2_kd[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_x_535[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], exp(g, @1_x_535[@i_147]))
  orfind @i_144 <= NU suchthat defined(@1_x_650[@i_144], Ystar_u[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @1_x_650[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], exp(g, @1_x_650[@i_144]))
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_x_535: exponent;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], exp(g, @1_x_535))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_259: host = cst_host in
  let x2_258: host = cst_host in
  let x3_257: G = cst_G in
  let x4_256: G = cst_G in
  let x5_255: G = cst_G in
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], x5_255[@i_323], x4_256[@i_323], x3_257[@i_323], x2_258[@i_323], x1_259[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  orfind @i_322 <= NS suchthat defined(X_s[@i_322], Y[@i_322], K_s[@i_322], x5_261[@i_322], x4_262[@i_322], x3_263[@i_322], x1_265[@i_322], x2_264[@i_322], r_260[@i_322]) && otheruses(r_260[@i_322]) && ((x1 = x1_265[@i_322]) && ((x2 = x2_264[@i_322]) && ((x3 = X_s[@i_322]) && ((x4 = Y[@i_322]) && (x5 = K_s[@i_322]))))) then
    out(c20[!_45], r_260[@i_322])
  orfind @i_321 <= NS suchthat defined(X_s[@i_321], Y[@i_321], K_s[@i_321], x5_267[@i_321], x4_268[@i_321], x3_269[@i_321], x1_271[@i_321], x2_270[@i_321], r_266[@i_321]) && otheruses(r_266[@i_321]) && ((x1 = x1_271[@i_321]) && ((x2 = x2_270[@i_321]) && ((x3 = X_s[@i_321]) && ((x4 = Y[@i_321]) && (x5 = K_s[@i_321]))))) then
    out(c20[!_45], r_266[@i_321])
  orfind @i_320 <= NU suchthat defined(@1_x_650[@i_320], X[@i_320], @2_r4_137[@i_320], K_u_790[@i_320], x5_273[@i_320], x4_274[@i_320], x3_275[@i_320], x1_277[@i_320], x2_276[@i_320], r_272[@i_320]) && otheruses(r_272[@i_320]) && ((x1 = x1_277[@i_320]) && ((x2 = x2_276[@i_320]) && ((x3 = X[@i_320]) && ((x4 = exp(g, @1_x_650[@i_320])) && (x5 = K_u_790[@i_320]))))) then
    out(c20[!_45], r_272[@i_320])
  orfind @i_319 <= NU suchthat defined(@1_x_535[@i_171[@i_319]], X[@i_319], @2_r4_128[@i_171[@i_319]], K_u_787[@i_319], x5_279[@i_319], x4_280[@i_319], x3_281[@i_319], x1_283[@i_319], x2_282[@i_319], r_278[@i_319]) && otheruses(r_278[@i_319]) && ((x1 = x1_283[@i_319]) && ((x2 = x2_282[@i_319]) && ((x3 = X[@i_319]) && ((x4 = exp(g, @1_x_535[@i_171[@i_319]])) && (x5 = K_u_787[@i_319]))))) then
    out(c20[!_45], r_278[@i_319])
  orfind @i_318 <= NU suchthat defined(@1_x_535[@i_171[@i_318]], X[@i_318], @2_r4_128[@i_171[@i_318]], K_u_787[@i_318], x5_285[@i_318], x4_286[@i_318], x3_287[@i_318], x1_289[@i_318], x2_288[@i_318], r_284[@i_318]) && otheruses(r_284[@i_318]) && ((x1 = x1_289[@i_318]) && ((x2 = x2_288[@i_318]) && ((x3 = X[@i_318]) && ((x4 = exp(g, @1_x_535[@i_171[@i_318]])) && (x5 = K_u_787[@i_318]))))) then
    out(c20[!_45], r_284[@i_318])
  orfind @i_317 <= NU suchthat defined(@1_x_650[@i_168[@i_317]], X[@i_317], @2_r4_137[@i_168[@i_317]], K_u_788[@i_317], x5_291[@i_317], x4_292[@i_317], x3_293[@i_317], x1_295[@i_317], x2_294[@i_317], r_290[@i_317]) && otheruses(r_290[@i_317]) && ((x1 = x1_295[@i_317]) && ((x2 = x2_294[@i_317]) && ((x3 = X[@i_317]) && ((x4 = exp(g, @1_x_650[@i_168[@i_317]])) && (x5 = K_u_788[@i_317]))))) then
    out(c20[!_45], r_290[@i_317])
  orfind @i_316 <= NU suchthat defined(@1_x_650[@i_168[@i_316]], X[@i_316], @2_r4_137[@i_168[@i_316]], K_u_788[@i_316], x5_297[@i_316], x4_298[@i_316], x3_299[@i_316], x1_301[@i_316], x2_300[@i_316], r_296[@i_316]) && otheruses(r_296[@i_316]) && ((x1 = x1_301[@i_316]) && ((x2 = x2_300[@i_316]) && ((x3 = X[@i_316]) && ((x4 = exp(g, @1_x_650[@i_168[@i_316]])) && (x5 = K_u_788[@i_316]))))) then
    out(c20[!_45], r_296[@i_316])
  orfind @i_315 <= NU suchthat defined(X[@i_315], Y[@i_165[@i_315]], K_u_789[@i_315], x5_303[@i_315], x4_304[@i_315], x3_305[@i_315], x1_307[@i_315], x2_306[@i_315], r_302[@i_315]) && otheruses(r_302[@i_315]) && ((x1 = x1_307[@i_315]) && ((x2 = x2_306[@i_315]) && ((x3 = X[@i_315]) && ((x4 = Y[@i_165[@i_315]]) && (x5 = K_u_789[@i_315]))))) then
    out(c20[!_45], r_302[@i_315])
  orfind @i_314 <= NU suchthat defined(X[@i_314], Y[@i_165[@i_314]], K_u_789[@i_314], x5_309[@i_314], x4_310[@i_314], x3_311[@i_314], x1_313[@i_314], x2_312[@i_314], r_308[@i_314]) && otheruses(r_308[@i_314]) && ((x1 = x1_313[@i_314]) && ((x2 = x2_312[@i_314]) && ((x3 = X[@i_314]) && ((x4 = Y[@i_165[@i_314]]) && (x5 = K_u_789[@i_314]))))) then
    out(c20[!_45], r_308[@i_314])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_787[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_787[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_788[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_788[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_789[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_789[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_790[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_790[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying remove assignments of useless yields

Game 19 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@1_x_535[@i_171], @2_m[@i_171], @2_kd[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_x_535[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = exp(g, @1_x_535[@i_171]) in
    let K_u_787: G = exp(g, mult(@1_x_535[@i_171], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_535[@i_171]) = x14[@i_91]) && (K_u_787 = x15[@i_91]))))) then
    (
      let x1_289: host = U in
      let x2_288: host = S in
      let x3_287: G = cst_G in
      let x4_286: G = cst_G in
      let x5_285: G = cst_G in
      find [unique] @i_373 <= qH0 suchthat defined(x1[@i_373], x2[@i_373], x3[@i_373], x4[@i_373], x5[@i_373], x5_255[@i_373], x4_256[@i_373], x3_257[@i_373], x2_258[@i_373], x1_259[@i_373], r_254[@i_373]) && otheruses(r_254[@i_373]) && ((x1_289 = x1[@i_373]) && ((x2_288 = x2[@i_373]) && ((X = x3[@i_373]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_373]) && (K_u_787 = x5[@i_373]))))) then
      (
        let sk_u: hash0 = r_254[@i_373] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_373]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_284: hash0;
        let sk_u: hash0 = r_284 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_284);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_283: host = U in
      let x2_282: host = S in
      let x3_281: G = cst_G in
      let x4_280: G = cst_G in
      let x5_279: G = cst_G in
      find [unique] @i_363 <= qH0 suchthat defined(x1[@i_363], x2[@i_363], x3[@i_363], x4[@i_363], x5[@i_363], x5_255[@i_363], x4_256[@i_363], x3_257[@i_363], x2_258[@i_363], x1_259[@i_363], r_254[@i_363]) && otheruses(r_254[@i_363]) && ((x1_283 = x1[@i_363]) && ((x2_282 = x2[@i_363]) && ((X = x3[@i_363]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_363]) && (K_u_787 = x5[@i_363]))))) then
      (
        let sk_u: hash0 = r_254[@i_363] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_363]);
        out(c6[!_41], r1_77)
      )
      else
        new r_278: hash0;
        let sk_u: hash0 = r_278 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_278);
        out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(@1_x_650[@i_168], Ystar_u[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @1_x_650[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = exp(g, @1_x_650[@i_168]) in
    let K_u_788: G = exp(g, mult(@1_x_650[@i_168], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_650[@i_168]) = x14[@i_91]) && (K_u_788 = x15[@i_91]))))) then
    (
      let x1_301: host = U in
      let x2_300: host = S in
      let x3_299: G = cst_G in
      let x4_298: G = cst_G in
      let x5_297: G = cst_G in
      find [unique] @i_393 <= qH0 suchthat defined(x1[@i_393], x2[@i_393], x3[@i_393], x4[@i_393], x5[@i_393], x5_255[@i_393], x4_256[@i_393], x3_257[@i_393], x2_258[@i_393], x1_259[@i_393], r_254[@i_393]) && otheruses(r_254[@i_393]) && ((x1_301 = x1[@i_393]) && ((x2_300 = x2[@i_393]) && ((X = x3[@i_393]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_393]) && (K_u_788 = x5[@i_393]))))) then
      (
        let sk_u: hash0 = r_254[@i_393] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_393]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_296: hash0;
        let sk_u: hash0 = r_296 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_296);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_295: host = U in
      let x2_294: host = S in
      let x3_293: G = cst_G in
      let x4_292: G = cst_G in
      let x5_291: G = cst_G in
      find [unique] @i_383 <= qH0 suchthat defined(x1[@i_383], x2[@i_383], x3[@i_383], x4[@i_383], x5[@i_383], x5_255[@i_383], x4_256[@i_383], x3_257[@i_383], x2_258[@i_383], x1_259[@i_383], r_254[@i_383]) && otheruses(r_254[@i_383]) && ((x1_295 = x1[@i_383]) && ((x2_294 = x2[@i_383]) && ((X = x3[@i_383]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_383]) && (K_u_788 = x5[@i_383]))))) then
      (
        let sk_u: hash0 = r_254[@i_383] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_383]);
        out(c6[!_41], r1_77)
      )
      else
        new r_290: hash0;
        let sk_u: hash0 = r_290 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_290);
        out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u_789: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && (K_u_789 = x15[@i_91]))))) then
    (
      let x1_313: host = U in
      let x2_312: host = S in
      let x3_311: G = cst_G in
      let x4_310: G = cst_G in
      let x5_309: G = cst_G in
      find [unique] @i_413 <= qH0 suchthat defined(x1[@i_413], x2[@i_413], x3[@i_413], x4[@i_413], x5[@i_413], x5_255[@i_413], x4_256[@i_413], x3_257[@i_413], x2_258[@i_413], x1_259[@i_413], r_254[@i_413]) && otheruses(r_254[@i_413]) && ((x1_313 = x1[@i_413]) && ((x2_312 = x2[@i_413]) && ((X = x3[@i_413]) && ((Y[@i_165] = x4[@i_413]) && (K_u_789 = x5[@i_413]))))) then
      (
        let sk_u: hash0 = r_254[@i_413] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_413]);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind  suchthat defined(j[@i_165], r_260[@i_165]) && otheruses(r_260[@i_165]) && (!_41 = j[@i_165]) then
      (
        let sk_u: hash0 = r_260[@i_165] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_260[@i_165]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_308: hash0;
        let sk_u: hash0 = r_308 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_308);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_307: host = U in
      let x2_306: host = S in
      let x3_305: G = cst_G in
      let x4_304: G = cst_G in
      let x5_303: G = cst_G in
      find [unique] @i_403 <= qH0 suchthat defined(x1[@i_403], x2[@i_403], x3[@i_403], x4[@i_403], x5[@i_403], x5_255[@i_403], x4_256[@i_403], x3_257[@i_403], x2_258[@i_403], x1_259[@i_403], r_254[@i_403]) && otheruses(r_254[@i_403]) && ((x1_307 = x1[@i_403]) && ((x2_306 = x2[@i_403]) && ((X = x3[@i_403]) && ((Y[@i_165] = x4[@i_403]) && (K_u_789 = x5[@i_403]))))) then
      (
        let sk_u: hash0 = r_254[@i_403] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_403]);
        out(c6[!_41], r1_77)
      )
      else
        new r_302: hash0;
        let sk_u: hash0 = r_302 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_302);
        out(c6[!_41], r1_77)
  )
  else
    new @1_x_650: exponent;
    let @2_r4_137: G = cst_G in
    let Y_u: G = exp(g, @1_x_650) in
    let K_u_790: G = exp(g, mult(@1_x_650, x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    let x3_275: G = cst_G in
    let x4_274: G = cst_G in
    let x5_273: G = cst_G in
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, r_272);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let x1_265: host = U in
    let x2_264: host = S in
    let x3_263: G = cst_G in
    let x4_262: G = cst_G in
    let x5_261: G = cst_G in
    find [unique] @i_333 <= qH0 suchthat defined(x1[@i_333], x2[@i_333], x3[@i_333], x4[@i_333], x5[@i_333], x5_255[@i_333], x4_256[@i_333], x3_257[@i_333], x2_258[@i_333], x1_259[@i_333], r_254[@i_333]) && otheruses(r_254[@i_333]) && ((x1_265 = x1[@i_333]) && ((x2_264 = x2[@i_333]) && ((X_s = x3[@i_333]) && ((Y = x4[@i_333]) && (K_s = x5[@i_333]))))) then
    (
      let sk_s: hash0 = r_254[@i_333] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_333])
    )
    orfind  suchthat defined(@i_165[j], r_302[j]) && otheruses(r_302[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    orfind  suchthat defined(@i_165[j], r_308[j]) && otheruses(r_308[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_308[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_308[j])
    )
    else
      new r_260: hash0;
      let sk_s: hash0 = r_260 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_260)
  )
  orfind  suchthat defined(Y_u[j], K_u_787[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u_787[j])) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = cst_G in
    let x4_268: G = cst_G in
    let x5_267: G = cst_G in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], x5_255[@i_343], x4_256[@i_343], x3_257[@i_343], x2_258[@i_343], x1_259[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (K_s = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
  orfind  suchthat defined(Y_u[j], K_u_788[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u_788[j])) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = cst_G in
    let x4_268: G = cst_G in
    let x5_267: G = cst_G in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], x5_255[@i_343], x4_256[@i_343], x3_257[@i_343], x2_258[@i_343], x1_259[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (K_s = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
  orfind  suchthat defined(Y_u[j], K_u_789[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u_789[j])) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = cst_G in
    let x4_268: G = cst_G in
    let x5_267: G = cst_G in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], x5_255[@i_343], x4_256[@i_343], x3_257[@i_343], x2_258[@i_343], x1_259[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (K_s = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
  orfind  suchthat defined(Y_u[j], K_u_790[j], r1_77[j]) && otheruses(r1_77[j]) && ((Y = Y_u[j]) && (K_s = K_u_790[j])) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = cst_G in
    let x4_268: G = cst_G in
    let x5_267: G = cst_G in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], x5_255[@i_343], x4_256[@i_343], x3_257[@i_343], x2_258[@i_343], x1_259[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (K_s = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_x_535[@i_155], @2_r4_128[@i_155], @2_kd[@i_155], @2_m[@i_155]) && otheruses(@2_m[@i_155] -> @1_x_535[@i_155]) && ((@2_x = exp(g, @1_x_535[@i_155])) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@1_x_650[@i_152], @2_r4_137[@i_152], Ystar_u[@i_152]) && otheruses(Ystar_u[@i_152] -> @1_x_650[@i_152]) && ((@2_x = exp(g, @1_x_650[@i_152])) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@1_x_535[@i_147], @2_m[@i_147], @2_kd[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_x_535[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], exp(g, @1_x_535[@i_147]))
  orfind @i_144 <= NU suchthat defined(@1_x_650[@i_144], Ystar_u[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @1_x_650[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], exp(g, @1_x_650[@i_144]))
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_x_535: exponent;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], exp(g, @1_x_535))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_259: host = cst_host in
  let x2_258: host = cst_host in
  let x3_257: G = cst_G in
  let x4_256: G = cst_G in
  let x5_255: G = cst_G in
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], x5_255[@i_323], x4_256[@i_323], x3_257[@i_323], x2_258[@i_323], x1_259[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  orfind @i_322 <= NS suchthat defined(X_s[@i_322], Y[@i_322], K_s[@i_322], x5_261[@i_322], x4_262[@i_322], x3_263[@i_322], x1_265[@i_322], x2_264[@i_322], r_260[@i_322]) && otheruses(r_260[@i_322]) && ((x1 = x1_265[@i_322]) && ((x2 = x2_264[@i_322]) && ((x3 = X_s[@i_322]) && ((x4 = Y[@i_322]) && (x5 = K_s[@i_322]))))) then
    out(c20[!_45], r_260[@i_322])
  orfind @i_321 <= NS suchthat defined(X_s[@i_321], Y[@i_321], K_s[@i_321], x5_267[@i_321], x4_268[@i_321], x3_269[@i_321], x1_271[@i_321], x2_270[@i_321], r_266[@i_321]) && otheruses(r_266[@i_321]) && ((x1 = x1_271[@i_321]) && ((x2 = x2_270[@i_321]) && ((x3 = X_s[@i_321]) && ((x4 = Y[@i_321]) && (x5 = K_s[@i_321]))))) then
    out(c20[!_45], r_266[@i_321])
  orfind @i_320 <= NU suchthat defined(@1_x_650[@i_320], X[@i_320], @2_r4_137[@i_320], K_u_790[@i_320], x5_273[@i_320], x4_274[@i_320], x3_275[@i_320], x1_277[@i_320], x2_276[@i_320], r_272[@i_320]) && otheruses(r_272[@i_320]) && ((x1 = x1_277[@i_320]) && ((x2 = x2_276[@i_320]) && ((x3 = X[@i_320]) && ((x4 = exp(g, @1_x_650[@i_320])) && (x5 = K_u_790[@i_320]))))) then
    out(c20[!_45], r_272[@i_320])
  orfind @i_319 <= NU suchthat defined(@1_x_535[@i_171[@i_319]], X[@i_319], @2_r4_128[@i_171[@i_319]], K_u_787[@i_319], x5_279[@i_319], x4_280[@i_319], x3_281[@i_319], x1_283[@i_319], x2_282[@i_319], r_278[@i_319]) && otheruses(r_278[@i_319]) && ((x1 = x1_283[@i_319]) && ((x2 = x2_282[@i_319]) && ((x3 = X[@i_319]) && ((x4 = exp(g, @1_x_535[@i_171[@i_319]])) && (x5 = K_u_787[@i_319]))))) then
    out(c20[!_45], r_278[@i_319])
  orfind @i_318 <= NU suchthat defined(@1_x_535[@i_171[@i_318]], X[@i_318], @2_r4_128[@i_171[@i_318]], K_u_787[@i_318], x5_285[@i_318], x4_286[@i_318], x3_287[@i_318], x1_289[@i_318], x2_288[@i_318], r_284[@i_318]) && otheruses(r_284[@i_318]) && ((x1 = x1_289[@i_318]) && ((x2 = x2_288[@i_318]) && ((x3 = X[@i_318]) && ((x4 = exp(g, @1_x_535[@i_171[@i_318]])) && (x5 = K_u_787[@i_318]))))) then
    out(c20[!_45], r_284[@i_318])
  orfind @i_317 <= NU suchthat defined(@1_x_650[@i_168[@i_317]], X[@i_317], @2_r4_137[@i_168[@i_317]], K_u_788[@i_317], x5_291[@i_317], x4_292[@i_317], x3_293[@i_317], x1_295[@i_317], x2_294[@i_317], r_290[@i_317]) && otheruses(r_290[@i_317]) && ((x1 = x1_295[@i_317]) && ((x2 = x2_294[@i_317]) && ((x3 = X[@i_317]) && ((x4 = exp(g, @1_x_650[@i_168[@i_317]])) && (x5 = K_u_788[@i_317]))))) then
    out(c20[!_45], r_290[@i_317])
  orfind @i_316 <= NU suchthat defined(@1_x_650[@i_168[@i_316]], X[@i_316], @2_r4_137[@i_168[@i_316]], K_u_788[@i_316], x5_297[@i_316], x4_298[@i_316], x3_299[@i_316], x1_301[@i_316], x2_300[@i_316], r_296[@i_316]) && otheruses(r_296[@i_316]) && ((x1 = x1_301[@i_316]) && ((x2 = x2_300[@i_316]) && ((x3 = X[@i_316]) && ((x4 = exp(g, @1_x_650[@i_168[@i_316]])) && (x5 = K_u_788[@i_316]))))) then
    out(c20[!_45], r_296[@i_316])
  orfind @i_315 <= NU suchthat defined(X[@i_315], Y[@i_165[@i_315]], K_u_789[@i_315], x5_303[@i_315], x4_304[@i_315], x3_305[@i_315], x1_307[@i_315], x2_306[@i_315], r_302[@i_315]) && otheruses(r_302[@i_315]) && ((x1 = x1_307[@i_315]) && ((x2 = x2_306[@i_315]) && ((x3 = X[@i_315]) && ((x4 = Y[@i_165[@i_315]]) && (x5 = K_u_789[@i_315]))))) then
    out(c20[!_45], r_302[@i_315])
  orfind @i_314 <= NU suchthat defined(X[@i_314], Y[@i_165[@i_314]], K_u_789[@i_314], x5_309[@i_314], x4_310[@i_314], x3_311[@i_314], x1_313[@i_314], x2_312[@i_314], r_308[@i_314]) && otheruses(r_308[@i_314]) && ((x1 = x1_313[@i_314]) && ((x2 = x2_312[@i_314]) && ((x3 = X[@i_314]) && ((x4 = Y[@i_165[@i_314]]) && (x5 = K_u_789[@i_314]))))) then
    out(c20[!_45], r_308[@i_314])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_787[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_787[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_788[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_788[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_789[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_789[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_790[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_790[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying simplify [Excluding set(dist 19->20, proba <= 3. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|)] yields
NOTE: here, CryptoVerif makes a find on @i_165 in the server; it thinks that 
the branch taken in the client is the branch @i_165, which will be removed
later.
The other branches are removed because of the test (Y[!_42] = Y_u[j[!_42]])
The value of Y will change when we replace Y* = E_pw(Y) with Y = D_pw(Y*)
are delay the computation of Y, in such a way that Y may become equal
to Y_u[j[!_42]] while this equality is impossible in the current game.

Simplifying ((Y[!_42] = Y_u[j[!_42]]) && (K_s[!_42] = K_u_790[j[!_42]])) knowing
Substitutions:
(x1_277[j[!_42]] >>= U)
(x3_275[j[!_42]] >>= cst_G)
(x5_273[j[!_42]] >>= cst_G)
(K_u_790[j[!_42]] >>= exp(g, mult(@1_x_650[j[!_42]], x[j[!_42]])))
(@2_r4_137[j[!_42]] >>= cst_G)
(x2_81[j[!_42]] >>= S)
(x1_76[!_42] >>= U)
(X_s[!_42] = exp(g, x[j[!_42]]))
(Y[!_42] >>= exp(g, y[!_42]))
(X[j[!_42]] >>= exp(g, x[j[!_42]]))
(K_s[!_42] >>= exp(g, mult(x[j[!_42]], y[!_42])))
(x2_75[!_42] >>= S)
(x1_82[j[!_42]] >>= U)
(Y_u[j[!_42]] >>= exp(g, @1_x_650[j[!_42]]))
(sk_u[j[!_42]] >>= r_272[j[!_42]])
(x4_274[j[!_42]] >>= cst_G)
(x2_276[j[!_42]] >>= S)
Facts:
termU(U, X[j[!_42]], S, Ystar_u[j[!_42]], r1_77[j[!_42]], r_272[j[!_42]])
Elsefind:
Simplify done false

Simplifying ((Y[!_42] = Y_u[j[!_42]]) && (K_s[!_42] = K_u_789[j[!_42]])) knowing
Substitutions:
(Ystar_u[j[!_42]] = @2_r2_134[@i_165[j[!_42]]])
(K_u_789[j[!_42]] >>= exp(g, mult(y[@i_165[j[!_42]]], x[j[!_42]])))
(x1_82[j[!_42]] >>= U)
(x2_75[!_42] >>= S)
(K_s[!_42] >>= exp(g, mult(x[j[!_42]], y[!_42])))
(X[j[!_42]] >>= exp(g, x[j[!_42]]))
(Y[!_42] >>= exp(g, y[!_42]))
(X_s[!_42] = exp(g, x[j[!_42]]))
(x1_76[!_42] >>= U)
(x2_81[j[!_42]] >>= S)
(Y[@i_165[j[!_42]]] >>= exp(g, y[@i_165[j[!_42]]]))
(Y_u[j[!_42]] >>= exp(g, y[@i_165[j[!_42]]]))
Facts:
Elsefind:
Simplify done (!_42 = @i_165[j[!_42]])

Simplifying ((Y[!_42] = Y_u[j[!_42]]) && (K_s[!_42] = K_u_788[j[!_42]])) knowing
Substitutions:
(Ystar_u[@i_168[j[!_42]]] = Ystar_u[j[!_42]])
(K_u_788[j[!_42]] >>= exp(g, mult(@1_x_650[@i_168[j[!_42]]], x[j[!_42]])))
(Y_u[@i_168[j[!_42]]] >>= exp(g, @1_x_650[@i_168[j[!_42]]]))
(x1_82[@i_168[j[!_42]]] >>= U)
(x1_277[@i_168[j[!_42]]] >>= U)
(x3_275[@i_168[j[!_42]]] >>= cst_G)
(x5_273[@i_168[j[!_42]]] >>= cst_G)
(X[@i_168[j[!_42]]] >>= exp(g, x[@i_168[j[!_42]]]))
(x2_81[j[!_42]] >>= S)
(x1_76[!_42] >>= U)
(X_s[!_42] = exp(g, x[j[!_42]]))
(Y[!_42] >>= exp(g, y[!_42]))
(X[j[!_42]] >>= exp(g, x[j[!_42]]))
(K_s[!_42] >>= exp(g, mult(x[j[!_42]], y[!_42])))
(x2_75[!_42] >>= S)
(x1_82[j[!_42]] >>= U)
(sk_u[@i_168[j[!_42]]] >>= r_272[@i_168[j[!_42]]])
(x4_274[@i_168[j[!_42]]] >>= cst_G)
(x2_276[@i_168[j[!_42]]] >>= S)
(x2_81[@i_168[j[!_42]]] >>= S)
(K_u_790[@i_168[j[!_42]]] >>= exp(g, mult(@1_x_650[@i_168[j[!_42]]], x[@i_168[j[!_42]]])))
(@2_r4_137[@i_168[j[!_42]]] >>= cst_G)
(Y_u[j[!_42]] >>= exp(g, @1_x_650[@i_168[j[!_42]]]))
Facts:
termU(U, X[@i_168[j[!_42]]], S, Ystar_u[@i_168[j[!_42]]], r1_77[@i_168[j[!_42]]], r_272[@i_168[j[!_42]]])
Elsefind:
Simplify done false

Simplifying ((Y[!_42] = Y_u[j[!_42]]) && (K_s[!_42] = K_u_787[j[!_42]])) knowing
Substitutions:
(@2_kd[@i_171[j[!_42]]] = pw)
(Y_u[j[!_42]] >>= exp(g, @1_x_535[@i_171[j[!_42]]]))
(@2_r4_128[@i_171[j[!_42]]] >>= cst_G)
(x2_81[j[!_42]] >>= S)
(x1_76[!_42] >>= U)
(X_s[!_42] = exp(g, x[j[!_42]]))
(Y[!_42] >>= exp(g, y[!_42]))
(X[j[!_42]] >>= exp(g, x[j[!_42]]))
(K_s[!_42] >>= exp(g, mult(x[j[!_42]], y[!_42])))
(x2_75[!_42] >>= S)
(x1_82[j[!_42]] >>= U)
(K_u_787[j[!_42]] >>= exp(g, mult(@1_x_535[@i_171[j[!_42]]], x[j[!_42]])))
(Ystar_u[j[!_42]] = @2_m[@i_171[j[!_42]]])
Facts:
Elsefind:
Simplify done false

Game 20 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_x_535[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_x_535[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = exp(g, @1_x_535[@i_171]) in
    let K_u_787: G = exp(g, mult(@1_x_535[@i_171], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_535[@i_171]) = x14[@i_91]) && (K_u_787 = x15[@i_91]))))) then
    (
      let x1_289: host = U in
      let x2_288: host = S in
      let x3_287: G = cst_G in
      let x4_286: G = cst_G in
      let x5_285: G = cst_G in
      find [unique] @i_373 <= qH0 suchthat defined(x1[@i_373], x2[@i_373], x3[@i_373], x4[@i_373], x5[@i_373], r_254[@i_373]) && otheruses(r_254[@i_373]) && ((x1_289 = x1[@i_373]) && ((x2_288 = x2[@i_373]) && ((X = x3[@i_373]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_373]) && (K_u_787 = x5[@i_373]))))) then
      (
        let sk_u: hash0 = r_254[@i_373] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_373]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_284: hash0;
        let sk_u: hash0 = r_284 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_284);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_283: host = U in
      let x2_282: host = S in
      let x3_281: G = cst_G in
      let x4_280: G = cst_G in
      let x5_279: G = cst_G in
      find [unique] @i_363 <= qH0 suchthat defined(x1[@i_363], x2[@i_363], x3[@i_363], x4[@i_363], x5[@i_363], r_254[@i_363]) && otheruses(r_254[@i_363]) && ((x1_283 = x1[@i_363]) && ((x2_282 = x2[@i_363]) && ((X = x3[@i_363]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_363]) && (K_u_787 = x5[@i_363]))))) then
      (
        let sk_u: hash0 = r_254[@i_363] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_363]);
        out(c6[!_41], r1_77)
      )
      else
        new r_278: hash0;
        let sk_u: hash0 = r_278 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_278);
        out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @1_x_650[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @1_x_650[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = exp(g, @1_x_650[@i_168]) in
    let K_u_788: G = exp(g, mult(@1_x_650[@i_168], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_650[@i_168]) = x14[@i_91]) && (K_u_788 = x15[@i_91]))))) then
    (
      let x1_301: host = U in
      let x2_300: host = S in
      let x3_299: G = cst_G in
      let x4_298: G = cst_G in
      let x5_297: G = cst_G in
      find [unique] @i_393 <= qH0 suchthat defined(x1[@i_393], x2[@i_393], x3[@i_393], x4[@i_393], x5[@i_393], r_254[@i_393]) && otheruses(r_254[@i_393]) && ((x1_301 = x1[@i_393]) && ((x2_300 = x2[@i_393]) && ((X = x3[@i_393]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_393]) && (K_u_788 = x5[@i_393]))))) then
      (
        let sk_u: hash0 = r_254[@i_393] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_393]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_296: hash0;
        let sk_u: hash0 = r_296 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_296);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_295: host = U in
      let x2_294: host = S in
      let x3_293: G = cst_G in
      let x4_292: G = cst_G in
      let x5_291: G = cst_G in
      find [unique] @i_383 <= qH0 suchthat defined(x1[@i_383], x2[@i_383], x3[@i_383], x4[@i_383], x5[@i_383], r_254[@i_383]) && otheruses(r_254[@i_383]) && ((x1_295 = x1[@i_383]) && ((x2_294 = x2[@i_383]) && ((X = x3[@i_383]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_383]) && (K_u_788 = x5[@i_383]))))) then
      (
        let sk_u: hash0 = r_254[@i_383] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_383]);
        out(c6[!_41], r1_77)
      )
      else
        new r_290: hash0;
        let sk_u: hash0 = r_290 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_290);
        out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u_789: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && (K_u_789 = x15[@i_91]))))) then
    (
      let x1_313: host = U in
      let x2_312: host = S in
      let x3_311: G = cst_G in
      let x4_310: G = cst_G in
      let x5_309: G = cst_G in
      find [unique] @i_413 <= qH0 suchthat defined(x1[@i_413], x2[@i_413], x3[@i_413], x4[@i_413], x5[@i_413], r_254[@i_413]) && otheruses(r_254[@i_413]) && ((x1_313 = x1[@i_413]) && ((x2_312 = x2[@i_413]) && ((X = x3[@i_413]) && ((Y[@i_165] = x4[@i_413]) && (K_u_789 = x5[@i_413]))))) then
      (
        let sk_u: hash0 = r_254[@i_413] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_413]);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind  suchthat defined(j[@i_165], r_260[@i_165]) && otheruses(r_260[@i_165]) && (!_41 = j[@i_165]) then
      (
        let sk_u: hash0 = r_260[@i_165] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_260[@i_165]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_308: hash0;
        let sk_u: hash0 = r_308 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_308);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_307: host = U in
      let x2_306: host = S in
      let x3_305: G = cst_G in
      let x4_304: G = cst_G in
      let x5_303: G = cst_G in
      find [unique] @i_403 <= qH0 suchthat defined(x1[@i_403], x2[@i_403], x3[@i_403], x4[@i_403], x5[@i_403], r_254[@i_403]) && otheruses(r_254[@i_403]) && ((x1_307 = x1[@i_403]) && ((x2_306 = x2[@i_403]) && ((X = x3[@i_403]) && ((Y[@i_165] = x4[@i_403]) && (K_u_789 = x5[@i_403]))))) then
      (
        let sk_u: hash0 = r_254[@i_403] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_403]);
        out(c6[!_41], r1_77)
      )
      else
        new r_302: hash0;
        let sk_u: hash0 = r_302 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_302);
        out(c6[!_41], r1_77)
  )
  else
    new @1_x_650: exponent;
    let @2_r4_137: G = cst_G in
    let Y_u: G = exp(g, @1_x_650) in
    let K_u_790: G = exp(g, mult(@1_x_650, x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    let x3_275: G = cst_G in
    let x4_274: G = cst_G in
    let x5_273: G = cst_G in
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, r_272);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = exp(g, mult(x[j], y)) in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (K_s = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let x1_265: host = U in
    let x2_264: host = S in
    let x3_263: G = cst_G in
    let x4_262: G = cst_G in
    let x5_261: G = cst_G in
    find [unique] @i_333 <= qH0 suchthat defined(x1[@i_333], x2[@i_333], x3[@i_333], x4[@i_333], x5[@i_333], r_254[@i_333]) && otheruses(r_254[@i_333]) && ((x1_265 = x1[@i_333]) && ((x2_264 = x2[@i_333]) && ((X_s = x3[@i_333]) && ((Y = x4[@i_333]) && (K_s = x5[@i_333]))))) then
    (
      let sk_s: hash0 = r_254[@i_333] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_333])
    )
    orfind  suchthat defined(@i_165[j], r_302[j]) && otheruses(r_302[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    orfind  suchthat defined(@i_165[j], r_308[j]) && otheruses(r_308[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_308[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_308[j])
    )
    else
      new r_260: hash0;
      let sk_s: hash0 = r_260 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_260)
  )
  orfind  suchthat defined(@i_165[j], r1_77[j], K_u_789[j]) && otheruses(r1_77[j]) && (!_42 = @i_165[j]) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = cst_G in
    let x4_268: G = cst_G in
    let x5_267: G = cst_G in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (K_s = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_x_535[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_x_535[@i_155]) && ((@2_x = exp(g, @1_x_535[@i_155])) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@1_x_650[@i_152], Ystar_u[@i_152], @2_r4_137[@i_152]) && otheruses(Ystar_u[@i_152] -> @1_x_650[@i_152]) && ((@2_x = exp(g, @1_x_650[@i_152])) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_x_535[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_x_535[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], exp(g, @1_x_535[@i_147]))
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_650[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @1_x_650[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], exp(g, @1_x_650[@i_144]))
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_x_535: exponent;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], exp(g, @1_x_535))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_259: host = cst_host in
  let x2_258: host = cst_host in
  let x3_257: G = cst_G in
  let x4_256: G = cst_G in
  let x5_255: G = cst_G in
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  orfind @i_322 <= NS suchthat defined(x1_265[@i_322], x2_264[@i_322], X_s[@i_322], Y[@i_322], K_s[@i_322], r_260[@i_322]) && otheruses(r_260[@i_322]) && ((x1 = x1_265[@i_322]) && ((x2 = x2_264[@i_322]) && ((x3 = X_s[@i_322]) && ((x4 = Y[@i_322]) && (x5 = K_s[@i_322]))))) then
    out(c20[!_45], r_260[@i_322])
  orfind @i_321 <= NS suchthat defined(x1_271[@i_321], x2_270[@i_321], X_s[@i_321], Y[@i_321], K_s[@i_321], r_266[@i_321]) && otheruses(r_266[@i_321]) && ((x1 = x1_271[@i_321]) && ((x2 = x2_270[@i_321]) && ((x3 = X_s[@i_321]) && ((x4 = Y[@i_321]) && (x5 = K_s[@i_321]))))) then
    out(c20[!_45], r_266[@i_321])
  orfind @i_320 <= NU suchthat defined(x1_277[@i_320], x2_276[@i_320], X[@i_320], @1_x_650[@i_320], K_u_790[@i_320], r_272[@i_320]) && otheruses(r_272[@i_320]) && ((x1 = x1_277[@i_320]) && ((x2 = x2_276[@i_320]) && ((x3 = X[@i_320]) && ((x4 = exp(g, @1_x_650[@i_320])) && (x5 = K_u_790[@i_320]))))) then
    out(c20[!_45], r_272[@i_320])
  orfind @i_319 <= NU suchthat defined(x1_283[@i_319], x2_282[@i_319], X[@i_319], @1_x_535[@i_171[@i_319]], K_u_787[@i_319], r_278[@i_319]) && otheruses(r_278[@i_319]) && ((x1 = x1_283[@i_319]) && ((x2 = x2_282[@i_319]) && ((x3 = X[@i_319]) && ((x4 = exp(g, @1_x_535[@i_171[@i_319]])) && (x5 = K_u_787[@i_319]))))) then
    out(c20[!_45], r_278[@i_319])
  orfind @i_318 <= NU suchthat defined(x1_289[@i_318], x2_288[@i_318], X[@i_318], @1_x_535[@i_171[@i_318]], K_u_787[@i_318], r_284[@i_318]) && otheruses(r_284[@i_318]) && ((x1 = x1_289[@i_318]) && ((x2 = x2_288[@i_318]) && ((x3 = X[@i_318]) && ((x4 = exp(g, @1_x_535[@i_171[@i_318]])) && (x5 = K_u_787[@i_318]))))) then
    out(c20[!_45], r_284[@i_318])
  orfind @i_317 <= NU suchthat defined(x1_295[@i_317], x2_294[@i_317], X[@i_317], @1_x_650[@i_168[@i_317]], K_u_788[@i_317], r_290[@i_317]) && otheruses(r_290[@i_317]) && ((x1 = x1_295[@i_317]) && ((x2 = x2_294[@i_317]) && ((x3 = X[@i_317]) && ((x4 = exp(g, @1_x_650[@i_168[@i_317]])) && (x5 = K_u_788[@i_317]))))) then
    out(c20[!_45], r_290[@i_317])
  orfind @i_316 <= NU suchthat defined(x1_301[@i_316], x2_300[@i_316], X[@i_316], @1_x_650[@i_168[@i_316]], K_u_788[@i_316], r_296[@i_316]) && otheruses(r_296[@i_316]) && ((x1 = x1_301[@i_316]) && ((x2 = x2_300[@i_316]) && ((x3 = X[@i_316]) && ((x4 = exp(g, @1_x_650[@i_168[@i_316]])) && (x5 = K_u_788[@i_316]))))) then
    out(c20[!_45], r_296[@i_316])
  orfind @i_315 <= NU suchthat defined(x1_307[@i_315], x2_306[@i_315], X[@i_315], Y[@i_165[@i_315]], K_u_789[@i_315], r_302[@i_315]) && otheruses(r_302[@i_315]) && ((x1 = x1_307[@i_315]) && ((x2 = x2_306[@i_315]) && ((x3 = X[@i_315]) && ((x4 = Y[@i_165[@i_315]]) && (x5 = K_u_789[@i_315]))))) then
    out(c20[!_45], r_302[@i_315])
  orfind @i_314 <= NU suchthat defined(x1_313[@i_314], x2_312[@i_314], X[@i_314], Y[@i_165[@i_314]], K_u_789[@i_314], r_308[@i_314]) && otheruses(r_308[@i_314]) && ((x1 = x1_313[@i_314]) && ((x2 = x2_312[@i_314]) && ((x3 = X[@i_314]) && ((x4 = Y[@i_165[@i_314]]) && (x5 = K_u_789[@i_314]))))) then
    out(c20[!_45], r_308[@i_314])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_787[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_787[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_788[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_788[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_789[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_789[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_790[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_790[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying remove assignments of binder K_s yields

Game 21 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_x_535[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_x_535[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = exp(g, @1_x_535[@i_171]) in
    let K_u_787: G = exp(g, mult(@1_x_535[@i_171], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_535[@i_171]) = x14[@i_91]) && (K_u_787 = x15[@i_91]))))) then
    (
      let x1_289: host = U in
      let x2_288: host = S in
      find [unique] @i_373 <= qH0 suchthat defined(x1[@i_373], x2[@i_373], x3[@i_373], x4[@i_373], x5[@i_373], r_254[@i_373]) && otheruses(r_254[@i_373]) && ((x1_289 = x1[@i_373]) && ((x2_288 = x2[@i_373]) && ((X = x3[@i_373]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_373]) && (K_u_787 = x5[@i_373]))))) then
      (
        let sk_u: hash0 = r_254[@i_373] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_373]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_284: hash0;
        let sk_u: hash0 = r_284 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_284);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_283: host = U in
      let x2_282: host = S in
      find [unique] @i_363 <= qH0 suchthat defined(x1[@i_363], x2[@i_363], x3[@i_363], x4[@i_363], x5[@i_363], r_254[@i_363]) && otheruses(r_254[@i_363]) && ((x1_283 = x1[@i_363]) && ((x2_282 = x2[@i_363]) && ((X = x3[@i_363]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_363]) && (K_u_787 = x5[@i_363]))))) then
      (
        let sk_u: hash0 = r_254[@i_363] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_363]);
        out(c6[!_41], r1_77)
      )
      else
        new r_278: hash0;
        let sk_u: hash0 = r_278 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_278);
        out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @1_x_650[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @1_x_650[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = exp(g, @1_x_650[@i_168]) in
    let K_u_788: G = exp(g, mult(@1_x_650[@i_168], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_650[@i_168]) = x14[@i_91]) && (K_u_788 = x15[@i_91]))))) then
    (
      let x1_301: host = U in
      let x2_300: host = S in
      find [unique] @i_393 <= qH0 suchthat defined(x1[@i_393], x2[@i_393], x3[@i_393], x4[@i_393], x5[@i_393], r_254[@i_393]) && otheruses(r_254[@i_393]) && ((x1_301 = x1[@i_393]) && ((x2_300 = x2[@i_393]) && ((X = x3[@i_393]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_393]) && (K_u_788 = x5[@i_393]))))) then
      (
        let sk_u: hash0 = r_254[@i_393] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_393]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_296: hash0;
        let sk_u: hash0 = r_296 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_296);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_295: host = U in
      let x2_294: host = S in
      find [unique] @i_383 <= qH0 suchthat defined(x1[@i_383], x2[@i_383], x3[@i_383], x4[@i_383], x5[@i_383], r_254[@i_383]) && otheruses(r_254[@i_383]) && ((x1_295 = x1[@i_383]) && ((x2_294 = x2[@i_383]) && ((X = x3[@i_383]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_383]) && (K_u_788 = x5[@i_383]))))) then
      (
        let sk_u: hash0 = r_254[@i_383] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_383]);
        out(c6[!_41], r1_77)
      )
      else
        new r_290: hash0;
        let sk_u: hash0 = r_290 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_290);
        out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u_789: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && (K_u_789 = x15[@i_91]))))) then
    (
      let x1_313: host = U in
      let x2_312: host = S in
      find [unique] @i_413 <= qH0 suchthat defined(x1[@i_413], x2[@i_413], x3[@i_413], x4[@i_413], x5[@i_413], r_254[@i_413]) && otheruses(r_254[@i_413]) && ((x1_313 = x1[@i_413]) && ((x2_312 = x2[@i_413]) && ((X = x3[@i_413]) && ((Y[@i_165] = x4[@i_413]) && (K_u_789 = x5[@i_413]))))) then
      (
        let sk_u: hash0 = r_254[@i_413] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_413]);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind  suchthat defined(j[@i_165], r_260[@i_165]) && otheruses(r_260[@i_165]) && (!_41 = j[@i_165]) then
      (
        let sk_u: hash0 = r_260[@i_165] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_260[@i_165]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_308: hash0;
        let sk_u: hash0 = r_308 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_308);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_307: host = U in
      let x2_306: host = S in
      find [unique] @i_403 <= qH0 suchthat defined(x1[@i_403], x2[@i_403], x3[@i_403], x4[@i_403], x5[@i_403], r_254[@i_403]) && otheruses(r_254[@i_403]) && ((x1_307 = x1[@i_403]) && ((x2_306 = x2[@i_403]) && ((X = x3[@i_403]) && ((Y[@i_165] = x4[@i_403]) && (K_u_789 = x5[@i_403]))))) then
      (
        let sk_u: hash0 = r_254[@i_403] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_403]);
        out(c6[!_41], r1_77)
      )
      else
        new r_302: hash0;
        let sk_u: hash0 = r_302 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_302);
        out(c6[!_41], r1_77)
  )
  else
    new @1_x_650: exponent;
    let @2_r4_137: G = cst_G in
    let Y_u: G = exp(g, @1_x_650) in
    let K_u_790: G = exp(g, mult(@1_x_650, x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, r_272);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = cst_G in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (exp(g, mult(x[j], y)) = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let x1_265: host = U in
    let x2_264: host = S in
    find [unique] @i_333 <= qH0 suchthat defined(x1[@i_333], x2[@i_333], x3[@i_333], x4[@i_333], x5[@i_333], r_254[@i_333]) && otheruses(r_254[@i_333]) && ((x1_265 = x1[@i_333]) && ((x2_264 = x2[@i_333]) && ((X_s = x3[@i_333]) && ((Y = x4[@i_333]) && (exp(g, mult(x[j], y)) = x5[@i_333]))))) then
    (
      let sk_s: hash0 = r_254[@i_333] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_333])
    )
    orfind  suchthat defined(@i_165[j], r_302[j]) && otheruses(r_302[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    orfind  suchthat defined(@i_165[j], r_308[j]) && otheruses(r_308[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_308[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_308[j])
    )
    else
      new r_260: hash0;
      let sk_s: hash0 = r_260 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_260)
  )
  orfind  suchthat defined(@i_165[j], r1_77[j], K_u_789[j]) && otheruses(r1_77[j]) && (!_42 = @i_165[j]) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (exp(g, mult(x[j], y)) = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_x_535[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_x_535[@i_155]) && ((@2_x = exp(g, @1_x_535[@i_155])) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@1_x_650[@i_152], Ystar_u[@i_152], @2_r4_137[@i_152]) && otheruses(Ystar_u[@i_152] -> @1_x_650[@i_152]) && ((@2_x = exp(g, @1_x_650[@i_152])) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_x_535[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_x_535[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], exp(g, @1_x_535[@i_147]))
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_650[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @1_x_650[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], exp(g, @1_x_650[@i_144]))
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_x_535: exponent;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], exp(g, @1_x_535))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  orfind @i_322 <= NS suchthat defined(y[@i_322], x[j[@i_322]], K_s[@i_322], x1_265[@i_322], x2_264[@i_322], X_s[@i_322], Y[@i_322], r_260[@i_322]) && otheruses(r_260[@i_322]) && ((x1 = x1_265[@i_322]) && ((x2 = x2_264[@i_322]) && ((x3 = X_s[@i_322]) && ((x4 = Y[@i_322]) && (x5 = exp(g, mult(x[j[@i_322]], y[@i_322]))))))) then
    out(c20[!_45], r_260[@i_322])
  orfind @i_321 <= NS suchthat defined(y[@i_321], x[j[@i_321]], K_s[@i_321], x1_271[@i_321], x2_270[@i_321], X_s[@i_321], Y[@i_321], r_266[@i_321]) && otheruses(r_266[@i_321]) && ((x1 = x1_271[@i_321]) && ((x2 = x2_270[@i_321]) && ((x3 = X_s[@i_321]) && ((x4 = Y[@i_321]) && (x5 = exp(g, mult(x[j[@i_321]], y[@i_321]))))))) then
    out(c20[!_45], r_266[@i_321])
  orfind @i_320 <= NU suchthat defined(x1_277[@i_320], x2_276[@i_320], X[@i_320], @1_x_650[@i_320], K_u_790[@i_320], r_272[@i_320]) && otheruses(r_272[@i_320]) && ((x1 = x1_277[@i_320]) && ((x2 = x2_276[@i_320]) && ((x3 = X[@i_320]) && ((x4 = exp(g, @1_x_650[@i_320])) && (x5 = K_u_790[@i_320]))))) then
    out(c20[!_45], r_272[@i_320])
  orfind @i_319 <= NU suchthat defined(x1_283[@i_319], x2_282[@i_319], X[@i_319], @1_x_535[@i_171[@i_319]], K_u_787[@i_319], r_278[@i_319]) && otheruses(r_278[@i_319]) && ((x1 = x1_283[@i_319]) && ((x2 = x2_282[@i_319]) && ((x3 = X[@i_319]) && ((x4 = exp(g, @1_x_535[@i_171[@i_319]])) && (x5 = K_u_787[@i_319]))))) then
    out(c20[!_45], r_278[@i_319])
  orfind @i_318 <= NU suchthat defined(x1_289[@i_318], x2_288[@i_318], X[@i_318], @1_x_535[@i_171[@i_318]], K_u_787[@i_318], r_284[@i_318]) && otheruses(r_284[@i_318]) && ((x1 = x1_289[@i_318]) && ((x2 = x2_288[@i_318]) && ((x3 = X[@i_318]) && ((x4 = exp(g, @1_x_535[@i_171[@i_318]])) && (x5 = K_u_787[@i_318]))))) then
    out(c20[!_45], r_284[@i_318])
  orfind @i_317 <= NU suchthat defined(x1_295[@i_317], x2_294[@i_317], X[@i_317], @1_x_650[@i_168[@i_317]], K_u_788[@i_317], r_290[@i_317]) && otheruses(r_290[@i_317]) && ((x1 = x1_295[@i_317]) && ((x2 = x2_294[@i_317]) && ((x3 = X[@i_317]) && ((x4 = exp(g, @1_x_650[@i_168[@i_317]])) && (x5 = K_u_788[@i_317]))))) then
    out(c20[!_45], r_290[@i_317])
  orfind @i_316 <= NU suchthat defined(x1_301[@i_316], x2_300[@i_316], X[@i_316], @1_x_650[@i_168[@i_316]], K_u_788[@i_316], r_296[@i_316]) && otheruses(r_296[@i_316]) && ((x1 = x1_301[@i_316]) && ((x2 = x2_300[@i_316]) && ((x3 = X[@i_316]) && ((x4 = exp(g, @1_x_650[@i_168[@i_316]])) && (x5 = K_u_788[@i_316]))))) then
    out(c20[!_45], r_296[@i_316])
  orfind @i_315 <= NU suchthat defined(x1_307[@i_315], x2_306[@i_315], X[@i_315], Y[@i_165[@i_315]], K_u_789[@i_315], r_302[@i_315]) && otheruses(r_302[@i_315]) && ((x1 = x1_307[@i_315]) && ((x2 = x2_306[@i_315]) && ((x3 = X[@i_315]) && ((x4 = Y[@i_165[@i_315]]) && (x5 = K_u_789[@i_315]))))) then
    out(c20[!_45], r_302[@i_315])
  orfind @i_314 <= NU suchthat defined(x1_313[@i_314], x2_312[@i_314], X[@i_314], Y[@i_165[@i_314]], K_u_789[@i_314], r_308[@i_314]) && otheruses(r_308[@i_314]) && ((x1 = x1_313[@i_314]) && ((x2 = x2_312[@i_314]) && ((x3 = X[@i_314]) && ((x4 = Y[@i_165[@i_314]]) && (x5 = K_u_789[@i_314]))))) then
    out(c20[!_45], r_308[@i_314])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_787[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_787[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_788[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_788[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_789[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_789[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_790[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_790[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying remove assignments of binder K_u_790 yields

Game 22 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_x_535[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_x_535[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = exp(g, @1_x_535[@i_171]) in
    let K_u_787: G = exp(g, mult(@1_x_535[@i_171], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_535[@i_171]) = x14[@i_91]) && (K_u_787 = x15[@i_91]))))) then
    (
      let x1_289: host = U in
      let x2_288: host = S in
      find [unique] @i_373 <= qH0 suchthat defined(x1[@i_373], x2[@i_373], x3[@i_373], x4[@i_373], x5[@i_373], r_254[@i_373]) && otheruses(r_254[@i_373]) && ((x1_289 = x1[@i_373]) && ((x2_288 = x2[@i_373]) && ((X = x3[@i_373]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_373]) && (K_u_787 = x5[@i_373]))))) then
      (
        let sk_u: hash0 = r_254[@i_373] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_373]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_284: hash0;
        let sk_u: hash0 = r_284 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_284);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_283: host = U in
      let x2_282: host = S in
      find [unique] @i_363 <= qH0 suchthat defined(x1[@i_363], x2[@i_363], x3[@i_363], x4[@i_363], x5[@i_363], r_254[@i_363]) && otheruses(r_254[@i_363]) && ((x1_283 = x1[@i_363]) && ((x2_282 = x2[@i_363]) && ((X = x3[@i_363]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_363]) && (K_u_787 = x5[@i_363]))))) then
      (
        let sk_u: hash0 = r_254[@i_363] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_363]);
        out(c6[!_41], r1_77)
      )
      else
        new r_278: hash0;
        let sk_u: hash0 = r_278 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_278);
        out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @1_x_650[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @1_x_650[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = exp(g, @1_x_650[@i_168]) in
    let K_u_788: G = exp(g, mult(@1_x_650[@i_168], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_650[@i_168]) = x14[@i_91]) && (K_u_788 = x15[@i_91]))))) then
    (
      let x1_301: host = U in
      let x2_300: host = S in
      find [unique] @i_393 <= qH0 suchthat defined(x1[@i_393], x2[@i_393], x3[@i_393], x4[@i_393], x5[@i_393], r_254[@i_393]) && otheruses(r_254[@i_393]) && ((x1_301 = x1[@i_393]) && ((x2_300 = x2[@i_393]) && ((X = x3[@i_393]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_393]) && (K_u_788 = x5[@i_393]))))) then
      (
        let sk_u: hash0 = r_254[@i_393] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_393]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_296: hash0;
        let sk_u: hash0 = r_296 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_296);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_295: host = U in
      let x2_294: host = S in
      find [unique] @i_383 <= qH0 suchthat defined(x1[@i_383], x2[@i_383], x3[@i_383], x4[@i_383], x5[@i_383], r_254[@i_383]) && otheruses(r_254[@i_383]) && ((x1_295 = x1[@i_383]) && ((x2_294 = x2[@i_383]) && ((X = x3[@i_383]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_383]) && (K_u_788 = x5[@i_383]))))) then
      (
        let sk_u: hash0 = r_254[@i_383] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_383]);
        out(c6[!_41], r1_77)
      )
      else
        new r_290: hash0;
        let sk_u: hash0 = r_290 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_290);
        out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u_789: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && (K_u_789 = x15[@i_91]))))) then
    (
      let x1_313: host = U in
      let x2_312: host = S in
      find [unique] @i_413 <= qH0 suchthat defined(x1[@i_413], x2[@i_413], x3[@i_413], x4[@i_413], x5[@i_413], r_254[@i_413]) && otheruses(r_254[@i_413]) && ((x1_313 = x1[@i_413]) && ((x2_312 = x2[@i_413]) && ((X = x3[@i_413]) && ((Y[@i_165] = x4[@i_413]) && (K_u_789 = x5[@i_413]))))) then
      (
        let sk_u: hash0 = r_254[@i_413] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_413]);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind  suchthat defined(j[@i_165], r_260[@i_165]) && otheruses(r_260[@i_165]) && (!_41 = j[@i_165]) then
      (
        let sk_u: hash0 = r_260[@i_165] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_260[@i_165]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_308: hash0;
        let sk_u: hash0 = r_308 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_308);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_307: host = U in
      let x2_306: host = S in
      find [unique] @i_403 <= qH0 suchthat defined(x1[@i_403], x2[@i_403], x3[@i_403], x4[@i_403], x5[@i_403], r_254[@i_403]) && otheruses(r_254[@i_403]) && ((x1_307 = x1[@i_403]) && ((x2_306 = x2[@i_403]) && ((X = x3[@i_403]) && ((Y[@i_165] = x4[@i_403]) && (K_u_789 = x5[@i_403]))))) then
      (
        let sk_u: hash0 = r_254[@i_403] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_403]);
        out(c6[!_41], r1_77)
      )
      else
        new r_302: hash0;
        let sk_u: hash0 = r_302 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_302);
        out(c6[!_41], r1_77)
  )
  else
    new @1_x_650: exponent;
    let @2_r4_137: G = cst_G in
    let Y_u: G = exp(g, @1_x_650) in
    let K_u_790: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, r_272);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = cst_G in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (exp(g, mult(x[j], y)) = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let x1_265: host = U in
    let x2_264: host = S in
    find [unique] @i_333 <= qH0 suchthat defined(x1[@i_333], x2[@i_333], x3[@i_333], x4[@i_333], x5[@i_333], r_254[@i_333]) && otheruses(r_254[@i_333]) && ((x1_265 = x1[@i_333]) && ((x2_264 = x2[@i_333]) && ((X_s = x3[@i_333]) && ((Y = x4[@i_333]) && (exp(g, mult(x[j], y)) = x5[@i_333]))))) then
    (
      let sk_s: hash0 = r_254[@i_333] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_333])
    )
    orfind  suchthat defined(@i_165[j], r_302[j]) && otheruses(r_302[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    orfind  suchthat defined(@i_165[j], r_308[j]) && otheruses(r_308[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_308[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_308[j])
    )
    else
      new r_260: hash0;
      let sk_s: hash0 = r_260 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_260)
  )
  orfind  suchthat defined(@i_165[j], r1_77[j], K_u_789[j]) && otheruses(r1_77[j]) && (!_42 = @i_165[j]) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (exp(g, mult(x[j], y)) = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_x_535[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_x_535[@i_155]) && ((@2_x = exp(g, @1_x_535[@i_155])) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@1_x_650[@i_152], Ystar_u[@i_152], @2_r4_137[@i_152]) && otheruses(Ystar_u[@i_152] -> @1_x_650[@i_152]) && ((@2_x = exp(g, @1_x_650[@i_152])) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_x_535[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_x_535[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], exp(g, @1_x_535[@i_147]))
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_650[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @1_x_650[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], exp(g, @1_x_650[@i_144]))
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_x_535: exponent;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], exp(g, @1_x_535))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  orfind @i_322 <= NS suchthat defined(y[@i_322], x[j[@i_322]], K_s[@i_322], x1_265[@i_322], x2_264[@i_322], X_s[@i_322], Y[@i_322], r_260[@i_322]) && otheruses(r_260[@i_322]) && ((x1 = x1_265[@i_322]) && ((x2 = x2_264[@i_322]) && ((x3 = X_s[@i_322]) && ((x4 = Y[@i_322]) && (x5 = exp(g, mult(x[j[@i_322]], y[@i_322]))))))) then
    out(c20[!_45], r_260[@i_322])
  orfind @i_321 <= NS suchthat defined(y[@i_321], x[j[@i_321]], K_s[@i_321], x1_271[@i_321], x2_270[@i_321], X_s[@i_321], Y[@i_321], r_266[@i_321]) && otheruses(r_266[@i_321]) && ((x1 = x1_271[@i_321]) && ((x2 = x2_270[@i_321]) && ((x3 = X_s[@i_321]) && ((x4 = Y[@i_321]) && (x5 = exp(g, mult(x[j[@i_321]], y[@i_321]))))))) then
    out(c20[!_45], r_266[@i_321])
  orfind @i_320 <= NU suchthat defined(x[@i_320], K_u_790[@i_320], x1_277[@i_320], x2_276[@i_320], X[@i_320], @1_x_650[@i_320], r_272[@i_320]) && otheruses(r_272[@i_320]) && ((x1 = x1_277[@i_320]) && ((x2 = x2_276[@i_320]) && ((x3 = X[@i_320]) && ((x4 = exp(g, @1_x_650[@i_320])) && (x5 = exp(g, mult(@1_x_650[@i_320], x[@i_320]))))))) then
    out(c20[!_45], r_272[@i_320])
  orfind @i_319 <= NU suchthat defined(x1_283[@i_319], x2_282[@i_319], X[@i_319], @1_x_535[@i_171[@i_319]], K_u_787[@i_319], r_278[@i_319]) && otheruses(r_278[@i_319]) && ((x1 = x1_283[@i_319]) && ((x2 = x2_282[@i_319]) && ((x3 = X[@i_319]) && ((x4 = exp(g, @1_x_535[@i_171[@i_319]])) && (x5 = K_u_787[@i_319]))))) then
    out(c20[!_45], r_278[@i_319])
  orfind @i_318 <= NU suchthat defined(x1_289[@i_318], x2_288[@i_318], X[@i_318], @1_x_535[@i_171[@i_318]], K_u_787[@i_318], r_284[@i_318]) && otheruses(r_284[@i_318]) && ((x1 = x1_289[@i_318]) && ((x2 = x2_288[@i_318]) && ((x3 = X[@i_318]) && ((x4 = exp(g, @1_x_535[@i_171[@i_318]])) && (x5 = K_u_787[@i_318]))))) then
    out(c20[!_45], r_284[@i_318])
  orfind @i_317 <= NU suchthat defined(x1_295[@i_317], x2_294[@i_317], X[@i_317], @1_x_650[@i_168[@i_317]], K_u_788[@i_317], r_290[@i_317]) && otheruses(r_290[@i_317]) && ((x1 = x1_295[@i_317]) && ((x2 = x2_294[@i_317]) && ((x3 = X[@i_317]) && ((x4 = exp(g, @1_x_650[@i_168[@i_317]])) && (x5 = K_u_788[@i_317]))))) then
    out(c20[!_45], r_290[@i_317])
  orfind @i_316 <= NU suchthat defined(x1_301[@i_316], x2_300[@i_316], X[@i_316], @1_x_650[@i_168[@i_316]], K_u_788[@i_316], r_296[@i_316]) && otheruses(r_296[@i_316]) && ((x1 = x1_301[@i_316]) && ((x2 = x2_300[@i_316]) && ((x3 = X[@i_316]) && ((x4 = exp(g, @1_x_650[@i_168[@i_316]])) && (x5 = K_u_788[@i_316]))))) then
    out(c20[!_45], r_296[@i_316])
  orfind @i_315 <= NU suchthat defined(x1_307[@i_315], x2_306[@i_315], X[@i_315], Y[@i_165[@i_315]], K_u_789[@i_315], r_302[@i_315]) && otheruses(r_302[@i_315]) && ((x1 = x1_307[@i_315]) && ((x2 = x2_306[@i_315]) && ((x3 = X[@i_315]) && ((x4 = Y[@i_165[@i_315]]) && (x5 = K_u_789[@i_315]))))) then
    out(c20[!_45], r_302[@i_315])
  orfind @i_314 <= NU suchthat defined(x1_313[@i_314], x2_312[@i_314], X[@i_314], Y[@i_165[@i_314]], K_u_789[@i_314], r_308[@i_314]) && otheruses(r_308[@i_314]) && ((x1 = x1_313[@i_314]) && ((x2 = x2_312[@i_314]) && ((x3 = X[@i_314]) && ((x4 = Y[@i_165[@i_314]]) && (x5 = K_u_789[@i_314]))))) then
    out(c20[!_45], r_308[@i_314])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_787[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_787[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_788[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_788[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_789[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_789[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x[@i_83], @1_x_650[@i_83], K_u_790[@i_83], x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = exp(g, mult(@1_x_650[@i_83], x[@i_83]))))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying remove assignments of binder K_u_787 yields

Game 23 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_x_535[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_x_535[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = exp(g, @1_x_535[@i_171]) in
    let K_u_787: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_535[@i_171]) = x14[@i_91]) && (exp(g, mult(@1_x_535[@i_171], x)) = x15[@i_91]))))) then
    (
      let x1_289: host = U in
      let x2_288: host = S in
      find [unique] @i_373 <= qH0 suchthat defined(x1[@i_373], x2[@i_373], x3[@i_373], x4[@i_373], x5[@i_373], r_254[@i_373]) && otheruses(r_254[@i_373]) && ((x1_289 = x1[@i_373]) && ((x2_288 = x2[@i_373]) && ((X = x3[@i_373]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_373]) && (exp(g, mult(@1_x_535[@i_171], x)) = x5[@i_373]))))) then
      (
        let sk_u: hash0 = r_254[@i_373] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_373]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_284: hash0;
        let sk_u: hash0 = r_284 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_284);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_283: host = U in
      let x2_282: host = S in
      find [unique] @i_363 <= qH0 suchthat defined(x1[@i_363], x2[@i_363], x3[@i_363], x4[@i_363], x5[@i_363], r_254[@i_363]) && otheruses(r_254[@i_363]) && ((x1_283 = x1[@i_363]) && ((x2_282 = x2[@i_363]) && ((X = x3[@i_363]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_363]) && (exp(g, mult(@1_x_535[@i_171], x)) = x5[@i_363]))))) then
      (
        let sk_u: hash0 = r_254[@i_363] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_363]);
        out(c6[!_41], r1_77)
      )
      else
        new r_278: hash0;
        let sk_u: hash0 = r_278 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_278);
        out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @1_x_650[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @1_x_650[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = exp(g, @1_x_650[@i_168]) in
    let K_u_788: G = exp(g, mult(@1_x_650[@i_168], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_650[@i_168]) = x14[@i_91]) && (K_u_788 = x15[@i_91]))))) then
    (
      let x1_301: host = U in
      let x2_300: host = S in
      find [unique] @i_393 <= qH0 suchthat defined(x1[@i_393], x2[@i_393], x3[@i_393], x4[@i_393], x5[@i_393], r_254[@i_393]) && otheruses(r_254[@i_393]) && ((x1_301 = x1[@i_393]) && ((x2_300 = x2[@i_393]) && ((X = x3[@i_393]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_393]) && (K_u_788 = x5[@i_393]))))) then
      (
        let sk_u: hash0 = r_254[@i_393] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_393]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_296: hash0;
        let sk_u: hash0 = r_296 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_296);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_295: host = U in
      let x2_294: host = S in
      find [unique] @i_383 <= qH0 suchthat defined(x1[@i_383], x2[@i_383], x3[@i_383], x4[@i_383], x5[@i_383], r_254[@i_383]) && otheruses(r_254[@i_383]) && ((x1_295 = x1[@i_383]) && ((x2_294 = x2[@i_383]) && ((X = x3[@i_383]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_383]) && (K_u_788 = x5[@i_383]))))) then
      (
        let sk_u: hash0 = r_254[@i_383] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_383]);
        out(c6[!_41], r1_77)
      )
      else
        new r_290: hash0;
        let sk_u: hash0 = r_290 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_290);
        out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u_789: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && (K_u_789 = x15[@i_91]))))) then
    (
      let x1_313: host = U in
      let x2_312: host = S in
      find [unique] @i_413 <= qH0 suchthat defined(x1[@i_413], x2[@i_413], x3[@i_413], x4[@i_413], x5[@i_413], r_254[@i_413]) && otheruses(r_254[@i_413]) && ((x1_313 = x1[@i_413]) && ((x2_312 = x2[@i_413]) && ((X = x3[@i_413]) && ((Y[@i_165] = x4[@i_413]) && (K_u_789 = x5[@i_413]))))) then
      (
        let sk_u: hash0 = r_254[@i_413] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_413]);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind  suchthat defined(j[@i_165], r_260[@i_165]) && otheruses(r_260[@i_165]) && (!_41 = j[@i_165]) then
      (
        let sk_u: hash0 = r_260[@i_165] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_260[@i_165]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_308: hash0;
        let sk_u: hash0 = r_308 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_308);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_307: host = U in
      let x2_306: host = S in
      find [unique] @i_403 <= qH0 suchthat defined(x1[@i_403], x2[@i_403], x3[@i_403], x4[@i_403], x5[@i_403], r_254[@i_403]) && otheruses(r_254[@i_403]) && ((x1_307 = x1[@i_403]) && ((x2_306 = x2[@i_403]) && ((X = x3[@i_403]) && ((Y[@i_165] = x4[@i_403]) && (K_u_789 = x5[@i_403]))))) then
      (
        let sk_u: hash0 = r_254[@i_403] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_403]);
        out(c6[!_41], r1_77)
      )
      else
        new r_302: hash0;
        let sk_u: hash0 = r_302 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_302);
        out(c6[!_41], r1_77)
  )
  else
    new @1_x_650: exponent;
    let @2_r4_137: G = cst_G in
    let Y_u: G = exp(g, @1_x_650) in
    let K_u_790: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, r_272);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = cst_G in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (exp(g, mult(x[j], y)) = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let x1_265: host = U in
    let x2_264: host = S in
    find [unique] @i_333 <= qH0 suchthat defined(x1[@i_333], x2[@i_333], x3[@i_333], x4[@i_333], x5[@i_333], r_254[@i_333]) && otheruses(r_254[@i_333]) && ((x1_265 = x1[@i_333]) && ((x2_264 = x2[@i_333]) && ((X_s = x3[@i_333]) && ((Y = x4[@i_333]) && (exp(g, mult(x[j], y)) = x5[@i_333]))))) then
    (
      let sk_s: hash0 = r_254[@i_333] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_333])
    )
    orfind  suchthat defined(@i_165[j], r_302[j]) && otheruses(r_302[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    orfind  suchthat defined(@i_165[j], r_308[j]) && otheruses(r_308[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_308[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_308[j])
    )
    else
      new r_260: hash0;
      let sk_s: hash0 = r_260 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_260)
  )
  orfind  suchthat defined(@i_165[j], r1_77[j], K_u_789[j]) && otheruses(r1_77[j]) && (!_42 = @i_165[j]) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (exp(g, mult(x[j], y)) = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_x_535[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_x_535[@i_155]) && ((@2_x = exp(g, @1_x_535[@i_155])) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@1_x_650[@i_152], Ystar_u[@i_152], @2_r4_137[@i_152]) && otheruses(Ystar_u[@i_152] -> @1_x_650[@i_152]) && ((@2_x = exp(g, @1_x_650[@i_152])) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_x_535[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_x_535[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], exp(g, @1_x_535[@i_147]))
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_650[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @1_x_650[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], exp(g, @1_x_650[@i_144]))
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_x_535: exponent;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], exp(g, @1_x_535))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  orfind @i_322 <= NS suchthat defined(y[@i_322], x[j[@i_322]], K_s[@i_322], x1_265[@i_322], x2_264[@i_322], X_s[@i_322], Y[@i_322], r_260[@i_322]) && otheruses(r_260[@i_322]) && ((x1 = x1_265[@i_322]) && ((x2 = x2_264[@i_322]) && ((x3 = X_s[@i_322]) && ((x4 = Y[@i_322]) && (x5 = exp(g, mult(x[j[@i_322]], y[@i_322]))))))) then
    out(c20[!_45], r_260[@i_322])
  orfind @i_321 <= NS suchthat defined(y[@i_321], x[j[@i_321]], K_s[@i_321], x1_271[@i_321], x2_270[@i_321], X_s[@i_321], Y[@i_321], r_266[@i_321]) && otheruses(r_266[@i_321]) && ((x1 = x1_271[@i_321]) && ((x2 = x2_270[@i_321]) && ((x3 = X_s[@i_321]) && ((x4 = Y[@i_321]) && (x5 = exp(g, mult(x[j[@i_321]], y[@i_321]))))))) then
    out(c20[!_45], r_266[@i_321])
  orfind @i_320 <= NU suchthat defined(x[@i_320], K_u_790[@i_320], x1_277[@i_320], x2_276[@i_320], X[@i_320], @1_x_650[@i_320], r_272[@i_320]) && otheruses(r_272[@i_320]) && ((x1 = x1_277[@i_320]) && ((x2 = x2_276[@i_320]) && ((x3 = X[@i_320]) && ((x4 = exp(g, @1_x_650[@i_320])) && (x5 = exp(g, mult(@1_x_650[@i_320], x[@i_320]))))))) then
    out(c20[!_45], r_272[@i_320])
  orfind @i_319 <= NU suchthat defined(x[@i_319], K_u_787[@i_319], x1_283[@i_319], x2_282[@i_319], X[@i_319], @1_x_535[@i_171[@i_319]], r_278[@i_319]) && otheruses(r_278[@i_319]) && ((x1 = x1_283[@i_319]) && ((x2 = x2_282[@i_319]) && ((x3 = X[@i_319]) && ((x4 = exp(g, @1_x_535[@i_171[@i_319]])) && (x5 = exp(g, mult(@1_x_535[@i_171[@i_319]], x[@i_319]))))))) then
    out(c20[!_45], r_278[@i_319])
  orfind @i_318 <= NU suchthat defined(x[@i_318], K_u_787[@i_318], x1_289[@i_318], x2_288[@i_318], X[@i_318], @1_x_535[@i_171[@i_318]], r_284[@i_318]) && otheruses(r_284[@i_318]) && ((x1 = x1_289[@i_318]) && ((x2 = x2_288[@i_318]) && ((x3 = X[@i_318]) && ((x4 = exp(g, @1_x_535[@i_171[@i_318]])) && (x5 = exp(g, mult(@1_x_535[@i_171[@i_318]], x[@i_318]))))))) then
    out(c20[!_45], r_284[@i_318])
  orfind @i_317 <= NU suchthat defined(x1_295[@i_317], x2_294[@i_317], X[@i_317], @1_x_650[@i_168[@i_317]], K_u_788[@i_317], r_290[@i_317]) && otheruses(r_290[@i_317]) && ((x1 = x1_295[@i_317]) && ((x2 = x2_294[@i_317]) && ((x3 = X[@i_317]) && ((x4 = exp(g, @1_x_650[@i_168[@i_317]])) && (x5 = K_u_788[@i_317]))))) then
    out(c20[!_45], r_290[@i_317])
  orfind @i_316 <= NU suchthat defined(x1_301[@i_316], x2_300[@i_316], X[@i_316], @1_x_650[@i_168[@i_316]], K_u_788[@i_316], r_296[@i_316]) && otheruses(r_296[@i_316]) && ((x1 = x1_301[@i_316]) && ((x2 = x2_300[@i_316]) && ((x3 = X[@i_316]) && ((x4 = exp(g, @1_x_650[@i_168[@i_316]])) && (x5 = K_u_788[@i_316]))))) then
    out(c20[!_45], r_296[@i_316])
  orfind @i_315 <= NU suchthat defined(x1_307[@i_315], x2_306[@i_315], X[@i_315], Y[@i_165[@i_315]], K_u_789[@i_315], r_302[@i_315]) && otheruses(r_302[@i_315]) && ((x1 = x1_307[@i_315]) && ((x2 = x2_306[@i_315]) && ((x3 = X[@i_315]) && ((x4 = Y[@i_165[@i_315]]) && (x5 = K_u_789[@i_315]))))) then
    out(c20[!_45], r_302[@i_315])
  orfind @i_314 <= NU suchthat defined(x1_313[@i_314], x2_312[@i_314], X[@i_314], Y[@i_165[@i_314]], K_u_789[@i_314], r_308[@i_314]) && otheruses(r_308[@i_314]) && ((x1 = x1_313[@i_314]) && ((x2 = x2_312[@i_314]) && ((x3 = X[@i_314]) && ((x4 = Y[@i_165[@i_314]]) && (x5 = K_u_789[@i_314]))))) then
    out(c20[!_45], r_308[@i_314])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x[@i_83], @1_x_535[@i_171[@i_83]], K_u_787[@i_83], x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = exp(g, mult(@1_x_535[@i_171[@i_83]], x[@i_83]))))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_788[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_788[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_789[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_789[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x[@i_83], @1_x_650[@i_83], K_u_790[@i_83], x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = exp(g, mult(@1_x_650[@i_83], x[@i_83]))))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying remove assignments of binder K_u_788 yields

Game 24 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_x_535[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_x_535[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = exp(g, @1_x_535[@i_171]) in
    let K_u_787: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_535[@i_171]) = x14[@i_91]) && (exp(g, mult(@1_x_535[@i_171], x)) = x15[@i_91]))))) then
    (
      let x1_289: host = U in
      let x2_288: host = S in
      find [unique] @i_373 <= qH0 suchthat defined(x1[@i_373], x2[@i_373], x3[@i_373], x4[@i_373], x5[@i_373], r_254[@i_373]) && otheruses(r_254[@i_373]) && ((x1_289 = x1[@i_373]) && ((x2_288 = x2[@i_373]) && ((X = x3[@i_373]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_373]) && (exp(g, mult(@1_x_535[@i_171], x)) = x5[@i_373]))))) then
      (
        let sk_u: hash0 = r_254[@i_373] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_373]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_284: hash0;
        let sk_u: hash0 = r_284 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_284);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_283: host = U in
      let x2_282: host = S in
      find [unique] @i_363 <= qH0 suchthat defined(x1[@i_363], x2[@i_363], x3[@i_363], x4[@i_363], x5[@i_363], r_254[@i_363]) && otheruses(r_254[@i_363]) && ((x1_283 = x1[@i_363]) && ((x2_282 = x2[@i_363]) && ((X = x3[@i_363]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_363]) && (exp(g, mult(@1_x_535[@i_171], x)) = x5[@i_363]))))) then
      (
        let sk_u: hash0 = r_254[@i_363] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_363]);
        out(c6[!_41], r1_77)
      )
      else
        new r_278: hash0;
        let sk_u: hash0 = r_278 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_278);
        out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @1_x_650[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @1_x_650[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = exp(g, @1_x_650[@i_168]) in
    let K_u_788: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_650[@i_168]) = x14[@i_91]) && (exp(g, mult(@1_x_650[@i_168], x)) = x15[@i_91]))))) then
    (
      let x1_301: host = U in
      let x2_300: host = S in
      find [unique] @i_393 <= qH0 suchthat defined(x1[@i_393], x2[@i_393], x3[@i_393], x4[@i_393], x5[@i_393], r_254[@i_393]) && otheruses(r_254[@i_393]) && ((x1_301 = x1[@i_393]) && ((x2_300 = x2[@i_393]) && ((X = x3[@i_393]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_393]) && (exp(g, mult(@1_x_650[@i_168], x)) = x5[@i_393]))))) then
      (
        let sk_u: hash0 = r_254[@i_393] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_393]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_296: hash0;
        let sk_u: hash0 = r_296 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_296);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_295: host = U in
      let x2_294: host = S in
      find [unique] @i_383 <= qH0 suchthat defined(x1[@i_383], x2[@i_383], x3[@i_383], x4[@i_383], x5[@i_383], r_254[@i_383]) && otheruses(r_254[@i_383]) && ((x1_295 = x1[@i_383]) && ((x2_294 = x2[@i_383]) && ((X = x3[@i_383]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_383]) && (exp(g, mult(@1_x_650[@i_168], x)) = x5[@i_383]))))) then
      (
        let sk_u: hash0 = r_254[@i_383] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_383]);
        out(c6[!_41], r1_77)
      )
      else
        new r_290: hash0;
        let sk_u: hash0 = r_290 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_290);
        out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u_789: G = exp(g, mult(y[@i_165], x)) in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && (K_u_789 = x15[@i_91]))))) then
    (
      let x1_313: host = U in
      let x2_312: host = S in
      find [unique] @i_413 <= qH0 suchthat defined(x1[@i_413], x2[@i_413], x3[@i_413], x4[@i_413], x5[@i_413], r_254[@i_413]) && otheruses(r_254[@i_413]) && ((x1_313 = x1[@i_413]) && ((x2_312 = x2[@i_413]) && ((X = x3[@i_413]) && ((Y[@i_165] = x4[@i_413]) && (K_u_789 = x5[@i_413]))))) then
      (
        let sk_u: hash0 = r_254[@i_413] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_413]);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind  suchthat defined(j[@i_165], r_260[@i_165]) && otheruses(r_260[@i_165]) && (!_41 = j[@i_165]) then
      (
        let sk_u: hash0 = r_260[@i_165] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_260[@i_165]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_308: hash0;
        let sk_u: hash0 = r_308 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_308);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_307: host = U in
      let x2_306: host = S in
      find [unique] @i_403 <= qH0 suchthat defined(x1[@i_403], x2[@i_403], x3[@i_403], x4[@i_403], x5[@i_403], r_254[@i_403]) && otheruses(r_254[@i_403]) && ((x1_307 = x1[@i_403]) && ((x2_306 = x2[@i_403]) && ((X = x3[@i_403]) && ((Y[@i_165] = x4[@i_403]) && (K_u_789 = x5[@i_403]))))) then
      (
        let sk_u: hash0 = r_254[@i_403] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_403]);
        out(c6[!_41], r1_77)
      )
      else
        new r_302: hash0;
        let sk_u: hash0 = r_302 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_302);
        out(c6[!_41], r1_77)
  )
  else
    new @1_x_650: exponent;
    let @2_r4_137: G = cst_G in
    let Y_u: G = exp(g, @1_x_650) in
    let K_u_790: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, r_272);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = cst_G in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (exp(g, mult(x[j], y)) = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let x1_265: host = U in
    let x2_264: host = S in
    find [unique] @i_333 <= qH0 suchthat defined(x1[@i_333], x2[@i_333], x3[@i_333], x4[@i_333], x5[@i_333], r_254[@i_333]) && otheruses(r_254[@i_333]) && ((x1_265 = x1[@i_333]) && ((x2_264 = x2[@i_333]) && ((X_s = x3[@i_333]) && ((Y = x4[@i_333]) && (exp(g, mult(x[j], y)) = x5[@i_333]))))) then
    (
      let sk_s: hash0 = r_254[@i_333] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_333])
    )
    orfind  suchthat defined(@i_165[j], r_302[j]) && otheruses(r_302[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    orfind  suchthat defined(@i_165[j], r_308[j]) && otheruses(r_308[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_308[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_308[j])
    )
    else
      new r_260: hash0;
      let sk_s: hash0 = r_260 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_260)
  )
  orfind  suchthat defined(@i_165[j], r1_77[j], K_u_789[j]) && otheruses(r1_77[j]) && (!_42 = @i_165[j]) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (exp(g, mult(x[j], y)) = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_x_535[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_x_535[@i_155]) && ((@2_x = exp(g, @1_x_535[@i_155])) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@1_x_650[@i_152], Ystar_u[@i_152], @2_r4_137[@i_152]) && otheruses(Ystar_u[@i_152] -> @1_x_650[@i_152]) && ((@2_x = exp(g, @1_x_650[@i_152])) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_x_535[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_x_535[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], exp(g, @1_x_535[@i_147]))
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_650[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @1_x_650[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], exp(g, @1_x_650[@i_144]))
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_x_535: exponent;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], exp(g, @1_x_535))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  orfind @i_322 <= NS suchthat defined(y[@i_322], x[j[@i_322]], K_s[@i_322], x1_265[@i_322], x2_264[@i_322], X_s[@i_322], Y[@i_322], r_260[@i_322]) && otheruses(r_260[@i_322]) && ((x1 = x1_265[@i_322]) && ((x2 = x2_264[@i_322]) && ((x3 = X_s[@i_322]) && ((x4 = Y[@i_322]) && (x5 = exp(g, mult(x[j[@i_322]], y[@i_322]))))))) then
    out(c20[!_45], r_260[@i_322])
  orfind @i_321 <= NS suchthat defined(y[@i_321], x[j[@i_321]], K_s[@i_321], x1_271[@i_321], x2_270[@i_321], X_s[@i_321], Y[@i_321], r_266[@i_321]) && otheruses(r_266[@i_321]) && ((x1 = x1_271[@i_321]) && ((x2 = x2_270[@i_321]) && ((x3 = X_s[@i_321]) && ((x4 = Y[@i_321]) && (x5 = exp(g, mult(x[j[@i_321]], y[@i_321]))))))) then
    out(c20[!_45], r_266[@i_321])
  orfind @i_320 <= NU suchthat defined(x[@i_320], K_u_790[@i_320], x1_277[@i_320], x2_276[@i_320], X[@i_320], @1_x_650[@i_320], r_272[@i_320]) && otheruses(r_272[@i_320]) && ((x1 = x1_277[@i_320]) && ((x2 = x2_276[@i_320]) && ((x3 = X[@i_320]) && ((x4 = exp(g, @1_x_650[@i_320])) && (x5 = exp(g, mult(@1_x_650[@i_320], x[@i_320]))))))) then
    out(c20[!_45], r_272[@i_320])
  orfind @i_319 <= NU suchthat defined(x[@i_319], K_u_787[@i_319], x1_283[@i_319], x2_282[@i_319], X[@i_319], @1_x_535[@i_171[@i_319]], r_278[@i_319]) && otheruses(r_278[@i_319]) && ((x1 = x1_283[@i_319]) && ((x2 = x2_282[@i_319]) && ((x3 = X[@i_319]) && ((x4 = exp(g, @1_x_535[@i_171[@i_319]])) && (x5 = exp(g, mult(@1_x_535[@i_171[@i_319]], x[@i_319]))))))) then
    out(c20[!_45], r_278[@i_319])
  orfind @i_318 <= NU suchthat defined(x[@i_318], K_u_787[@i_318], x1_289[@i_318], x2_288[@i_318], X[@i_318], @1_x_535[@i_171[@i_318]], r_284[@i_318]) && otheruses(r_284[@i_318]) && ((x1 = x1_289[@i_318]) && ((x2 = x2_288[@i_318]) && ((x3 = X[@i_318]) && ((x4 = exp(g, @1_x_535[@i_171[@i_318]])) && (x5 = exp(g, mult(@1_x_535[@i_171[@i_318]], x[@i_318]))))))) then
    out(c20[!_45], r_284[@i_318])
  orfind @i_317 <= NU suchthat defined(x[@i_317], K_u_788[@i_317], x1_295[@i_317], x2_294[@i_317], X[@i_317], @1_x_650[@i_168[@i_317]], r_290[@i_317]) && otheruses(r_290[@i_317]) && ((x1 = x1_295[@i_317]) && ((x2 = x2_294[@i_317]) && ((x3 = X[@i_317]) && ((x4 = exp(g, @1_x_650[@i_168[@i_317]])) && (x5 = exp(g, mult(@1_x_650[@i_168[@i_317]], x[@i_317]))))))) then
    out(c20[!_45], r_290[@i_317])
  orfind @i_316 <= NU suchthat defined(x[@i_316], K_u_788[@i_316], x1_301[@i_316], x2_300[@i_316], X[@i_316], @1_x_650[@i_168[@i_316]], r_296[@i_316]) && otheruses(r_296[@i_316]) && ((x1 = x1_301[@i_316]) && ((x2 = x2_300[@i_316]) && ((x3 = X[@i_316]) && ((x4 = exp(g, @1_x_650[@i_168[@i_316]])) && (x5 = exp(g, mult(@1_x_650[@i_168[@i_316]], x[@i_316]))))))) then
    out(c20[!_45], r_296[@i_316])
  orfind @i_315 <= NU suchthat defined(x1_307[@i_315], x2_306[@i_315], X[@i_315], Y[@i_165[@i_315]], K_u_789[@i_315], r_302[@i_315]) && otheruses(r_302[@i_315]) && ((x1 = x1_307[@i_315]) && ((x2 = x2_306[@i_315]) && ((x3 = X[@i_315]) && ((x4 = Y[@i_165[@i_315]]) && (x5 = K_u_789[@i_315]))))) then
    out(c20[!_45], r_302[@i_315])
  orfind @i_314 <= NU suchthat defined(x1_313[@i_314], x2_312[@i_314], X[@i_314], Y[@i_165[@i_314]], K_u_789[@i_314], r_308[@i_314]) && otheruses(r_308[@i_314]) && ((x1 = x1_313[@i_314]) && ((x2 = x2_312[@i_314]) && ((x3 = X[@i_314]) && ((x4 = Y[@i_165[@i_314]]) && (x5 = K_u_789[@i_314]))))) then
    out(c20[!_45], r_308[@i_314])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x[@i_83], @1_x_535[@i_171[@i_83]], K_u_787[@i_83], x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = exp(g, mult(@1_x_535[@i_171[@i_83]], x[@i_83]))))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x[@i_83], @1_x_650[@i_168[@i_83]], K_u_788[@i_83], x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = exp(g, mult(@1_x_650[@i_168[@i_83]], x[@i_83]))))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], K_u_789[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = K_u_789[@i_83]))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x[@i_83], @1_x_650[@i_83], K_u_790[@i_83], x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = exp(g, mult(@1_x_650[@i_83], x[@i_83]))))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying remove assignments of binder K_u_789 yields

Game 25 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_x_535[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_x_535[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = exp(g, @1_x_535[@i_171]) in
    let K_u_787: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_535[@i_171]) = x14[@i_91]) && (exp(g, mult(@1_x_535[@i_171], x)) = x15[@i_91]))))) then
    (
      let x1_289: host = U in
      let x2_288: host = S in
      find [unique] @i_373 <= qH0 suchthat defined(x1[@i_373], x2[@i_373], x3[@i_373], x4[@i_373], x5[@i_373], r_254[@i_373]) && otheruses(r_254[@i_373]) && ((x1_289 = x1[@i_373]) && ((x2_288 = x2[@i_373]) && ((X = x3[@i_373]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_373]) && (exp(g, mult(@1_x_535[@i_171], x)) = x5[@i_373]))))) then
      (
        let sk_u: hash0 = r_254[@i_373] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_373]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_284: hash0;
        let sk_u: hash0 = r_284 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_284);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_283: host = U in
      let x2_282: host = S in
      find [unique] @i_363 <= qH0 suchthat defined(x1[@i_363], x2[@i_363], x3[@i_363], x4[@i_363], x5[@i_363], r_254[@i_363]) && otheruses(r_254[@i_363]) && ((x1_283 = x1[@i_363]) && ((x2_282 = x2[@i_363]) && ((X = x3[@i_363]) && ((exp(g, @1_x_535[@i_171]) = x4[@i_363]) && (exp(g, mult(@1_x_535[@i_171], x)) = x5[@i_363]))))) then
      (
        let sk_u: hash0 = r_254[@i_363] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_363]);
        out(c6[!_41], r1_77)
      )
      else
        new r_278: hash0;
        let sk_u: hash0 = r_278 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_278);
        out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @1_x_650[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @1_x_650[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = exp(g, @1_x_650[@i_168]) in
    let K_u_788: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((exp(g, @1_x_650[@i_168]) = x14[@i_91]) && (exp(g, mult(@1_x_650[@i_168], x)) = x15[@i_91]))))) then
    (
      let x1_301: host = U in
      let x2_300: host = S in
      find [unique] @i_393 <= qH0 suchthat defined(x1[@i_393], x2[@i_393], x3[@i_393], x4[@i_393], x5[@i_393], r_254[@i_393]) && otheruses(r_254[@i_393]) && ((x1_301 = x1[@i_393]) && ((x2_300 = x2[@i_393]) && ((X = x3[@i_393]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_393]) && (exp(g, mult(@1_x_650[@i_168], x)) = x5[@i_393]))))) then
      (
        let sk_u: hash0 = r_254[@i_393] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_393]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_296: hash0;
        let sk_u: hash0 = r_296 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_296);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_295: host = U in
      let x2_294: host = S in
      find [unique] @i_383 <= qH0 suchthat defined(x1[@i_383], x2[@i_383], x3[@i_383], x4[@i_383], x5[@i_383], r_254[@i_383]) && otheruses(r_254[@i_383]) && ((x1_295 = x1[@i_383]) && ((x2_294 = x2[@i_383]) && ((X = x3[@i_383]) && ((exp(g, @1_x_650[@i_168]) = x4[@i_383]) && (exp(g, mult(@1_x_650[@i_168], x)) = x5[@i_383]))))) then
      (
        let sk_u: hash0 = r_254[@i_383] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_383]);
        out(c6[!_41], r1_77)
      )
      else
        new r_290: hash0;
        let sk_u: hash0 = r_290 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_290);
        out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u_789: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && (exp(g, mult(y[@i_165], x)) = x15[@i_91]))))) then
    (
      let x1_313: host = U in
      let x2_312: host = S in
      find [unique] @i_413 <= qH0 suchthat defined(x1[@i_413], x2[@i_413], x3[@i_413], x4[@i_413], x5[@i_413], r_254[@i_413]) && otheruses(r_254[@i_413]) && ((x1_313 = x1[@i_413]) && ((x2_312 = x2[@i_413]) && ((X = x3[@i_413]) && ((Y[@i_165] = x4[@i_413]) && (exp(g, mult(y[@i_165], x)) = x5[@i_413]))))) then
      (
        let sk_u: hash0 = r_254[@i_413] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_413]);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind  suchthat defined(j[@i_165], r_260[@i_165]) && otheruses(r_260[@i_165]) && (!_41 = j[@i_165]) then
      (
        let sk_u: hash0 = r_260[@i_165] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_260[@i_165]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_308: hash0;
        let sk_u: hash0 = r_308 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_308);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_307: host = U in
      let x2_306: host = S in
      find [unique] @i_403 <= qH0 suchthat defined(x1[@i_403], x2[@i_403], x3[@i_403], x4[@i_403], x5[@i_403], r_254[@i_403]) && otheruses(r_254[@i_403]) && ((x1_307 = x1[@i_403]) && ((x2_306 = x2[@i_403]) && ((X = x3[@i_403]) && ((Y[@i_165] = x4[@i_403]) && (exp(g, mult(y[@i_165], x)) = x5[@i_403]))))) then
      (
        let sk_u: hash0 = r_254[@i_403] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_403]);
        out(c6[!_41], r1_77)
      )
      else
        new r_302: hash0;
        let sk_u: hash0 = r_302 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_302);
        out(c6[!_41], r1_77)
  )
  else
    new @1_x_650: exponent;
    let @2_r4_137: G = cst_G in
    let Y_u: G = exp(g, @1_x_650) in
    let K_u_790: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, r_272);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = cst_G in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && (exp(g, mult(x[j], y)) = x15[@i_88]))))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let x1_265: host = U in
    let x2_264: host = S in
    find [unique] @i_333 <= qH0 suchthat defined(x1[@i_333], x2[@i_333], x3[@i_333], x4[@i_333], x5[@i_333], r_254[@i_333]) && otheruses(r_254[@i_333]) && ((x1_265 = x1[@i_333]) && ((x2_264 = x2[@i_333]) && ((X_s = x3[@i_333]) && ((Y = x4[@i_333]) && (exp(g, mult(x[j], y)) = x5[@i_333]))))) then
    (
      let sk_s: hash0 = r_254[@i_333] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_333])
    )
    orfind  suchthat defined(@i_165[j], r_302[j]) && otheruses(r_302[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    orfind  suchthat defined(@i_165[j], r_308[j]) && otheruses(r_308[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_308[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_308[j])
    )
    else
      new r_260: hash0;
      let sk_s: hash0 = r_260 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_260)
  )
  orfind  suchthat defined(x[j], y[@i_165[j]], K_u_789[j], @i_165[j], r1_77[j]) && otheruses(r1_77[j]) && (!_42 = @i_165[j]) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && (exp(g, mult(x[j], y)) = x5[@i_343]))))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_x_535[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_x_535[@i_155]) && ((@2_x = exp(g, @1_x_535[@i_155])) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@1_x_650[@i_152], Ystar_u[@i_152], @2_r4_137[@i_152]) && otheruses(Ystar_u[@i_152] -> @1_x_650[@i_152]) && ((@2_x = exp(g, @1_x_650[@i_152])) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_x_535[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_x_535[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], exp(g, @1_x_535[@i_147]))
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_650[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @1_x_650[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], exp(g, @1_x_650[@i_144]))
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_x_535: exponent;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], exp(g, @1_x_535))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  orfind @i_322 <= NS suchthat defined(y[@i_322], x[j[@i_322]], K_s[@i_322], x1_265[@i_322], x2_264[@i_322], X_s[@i_322], Y[@i_322], r_260[@i_322]) && otheruses(r_260[@i_322]) && ((x1 = x1_265[@i_322]) && ((x2 = x2_264[@i_322]) && ((x3 = X_s[@i_322]) && ((x4 = Y[@i_322]) && (x5 = exp(g, mult(x[j[@i_322]], y[@i_322]))))))) then
    out(c20[!_45], r_260[@i_322])
  orfind @i_321 <= NS suchthat defined(y[@i_321], x[j[@i_321]], K_s[@i_321], x1_271[@i_321], x2_270[@i_321], X_s[@i_321], Y[@i_321], r_266[@i_321]) && otheruses(r_266[@i_321]) && ((x1 = x1_271[@i_321]) && ((x2 = x2_270[@i_321]) && ((x3 = X_s[@i_321]) && ((x4 = Y[@i_321]) && (x5 = exp(g, mult(x[j[@i_321]], y[@i_321]))))))) then
    out(c20[!_45], r_266[@i_321])
  orfind @i_320 <= NU suchthat defined(x[@i_320], K_u_790[@i_320], x1_277[@i_320], x2_276[@i_320], X[@i_320], @1_x_650[@i_320], r_272[@i_320]) && otheruses(r_272[@i_320]) && ((x1 = x1_277[@i_320]) && ((x2 = x2_276[@i_320]) && ((x3 = X[@i_320]) && ((x4 = exp(g, @1_x_650[@i_320])) && (x5 = exp(g, mult(@1_x_650[@i_320], x[@i_320]))))))) then
    out(c20[!_45], r_272[@i_320])
  orfind @i_319 <= NU suchthat defined(x[@i_319], K_u_787[@i_319], x1_283[@i_319], x2_282[@i_319], X[@i_319], @1_x_535[@i_171[@i_319]], r_278[@i_319]) && otheruses(r_278[@i_319]) && ((x1 = x1_283[@i_319]) && ((x2 = x2_282[@i_319]) && ((x3 = X[@i_319]) && ((x4 = exp(g, @1_x_535[@i_171[@i_319]])) && (x5 = exp(g, mult(@1_x_535[@i_171[@i_319]], x[@i_319]))))))) then
    out(c20[!_45], r_278[@i_319])
  orfind @i_318 <= NU suchthat defined(x[@i_318], K_u_787[@i_318], x1_289[@i_318], x2_288[@i_318], X[@i_318], @1_x_535[@i_171[@i_318]], r_284[@i_318]) && otheruses(r_284[@i_318]) && ((x1 = x1_289[@i_318]) && ((x2 = x2_288[@i_318]) && ((x3 = X[@i_318]) && ((x4 = exp(g, @1_x_535[@i_171[@i_318]])) && (x5 = exp(g, mult(@1_x_535[@i_171[@i_318]], x[@i_318]))))))) then
    out(c20[!_45], r_284[@i_318])
  orfind @i_317 <= NU suchthat defined(x[@i_317], K_u_788[@i_317], x1_295[@i_317], x2_294[@i_317], X[@i_317], @1_x_650[@i_168[@i_317]], r_290[@i_317]) && otheruses(r_290[@i_317]) && ((x1 = x1_295[@i_317]) && ((x2 = x2_294[@i_317]) && ((x3 = X[@i_317]) && ((x4 = exp(g, @1_x_650[@i_168[@i_317]])) && (x5 = exp(g, mult(@1_x_650[@i_168[@i_317]], x[@i_317]))))))) then
    out(c20[!_45], r_290[@i_317])
  orfind @i_316 <= NU suchthat defined(x[@i_316], K_u_788[@i_316], x1_301[@i_316], x2_300[@i_316], X[@i_316], @1_x_650[@i_168[@i_316]], r_296[@i_316]) && otheruses(r_296[@i_316]) && ((x1 = x1_301[@i_316]) && ((x2 = x2_300[@i_316]) && ((x3 = X[@i_316]) && ((x4 = exp(g, @1_x_650[@i_168[@i_316]])) && (x5 = exp(g, mult(@1_x_650[@i_168[@i_316]], x[@i_316]))))))) then
    out(c20[!_45], r_296[@i_316])
  orfind @i_315 <= NU suchthat defined(x[@i_315], y[@i_165[@i_315]], K_u_789[@i_315], x1_307[@i_315], x2_306[@i_315], X[@i_315], Y[@i_165[@i_315]], r_302[@i_315]) && otheruses(r_302[@i_315]) && ((x1 = x1_307[@i_315]) && ((x2 = x2_306[@i_315]) && ((x3 = X[@i_315]) && ((x4 = Y[@i_165[@i_315]]) && (x5 = exp(g, mult(y[@i_165[@i_315]], x[@i_315]))))))) then
    out(c20[!_45], r_302[@i_315])
  orfind @i_314 <= NU suchthat defined(x[@i_314], y[@i_165[@i_314]], K_u_789[@i_314], x1_313[@i_314], x2_312[@i_314], X[@i_314], Y[@i_165[@i_314]], r_308[@i_314]) && otheruses(r_308[@i_314]) && ((x1 = x1_313[@i_314]) && ((x2 = x2_312[@i_314]) && ((x3 = X[@i_314]) && ((x4 = Y[@i_165[@i_314]]) && (x5 = exp(g, mult(y[@i_165[@i_314]], x[@i_314]))))))) then
    out(c20[!_45], r_308[@i_314])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x[@i_83], @1_x_535[@i_171[@i_83]], K_u_787[@i_83], x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = exp(g, mult(@1_x_535[@i_171[@i_83]], x[@i_83]))))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x[@i_83], @1_x_650[@i_168[@i_83]], K_u_788[@i_83], x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = exp(g, mult(@1_x_650[@i_168[@i_83]], x[@i_83]))))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x[@i_83], y[@i_165[@i_83]], K_u_789[@i_83], x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = exp(g, mult(y[@i_165[@i_83]], x[@i_83]))))))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x[@i_83], @1_x_650[@i_83], K_u_790[@i_83], x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && (x15 = exp(g, mult(@1_x_650[@i_83], x[@i_83]))))))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
with @1_x_650, y, x, @1_x_535 [Excluding set(dist 25->26.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 25)) + 2. * qH1 * pCDH(NS * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 25))) U set(dist 25->26.2, proba <= NU * qD / |exponent|) U set(dist 25->26.3, proba <= 0.5 * qD * qD / |exponent|) U set(dist 25->26.4, proba <= 0.5 * NU * NU / |exponent|)] yields

Game 26 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_x_535[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_x_535[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = @1_exp'(g, @1_x_535[@i_171]) in
    let K_u_787: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && find  else find  else ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((@1_exp'(g, @1_x_535[@i_171]) = x14[@i_91]) && false)))) then
    (
      let x1_289: host = U in
      let x2_288: host = S in
      find [unique] @i_373 <= qH0 suchthat defined(x1[@i_373], x2[@i_373], x3[@i_373], x4[@i_373], x5[@i_373], r_254[@i_373]) && otheruses(r_254[@i_373]) && find  else find  else ((x1_289 = x1[@i_373]) && ((x2_288 = x2[@i_373]) && ((X = x3[@i_373]) && ((@1_exp'(g, @1_x_535[@i_171]) = x4[@i_373]) && false)))) then
      (
        let sk_u: hash0 = r_254[@i_373] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_373]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_284: hash0;
        let sk_u: hash0 = r_284 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_284);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_283: host = U in
      let x2_282: host = S in
      find [unique] @i_363 <= qH0 suchthat defined(x1[@i_363], x2[@i_363], x3[@i_363], x4[@i_363], x5[@i_363], r_254[@i_363]) && otheruses(r_254[@i_363]) && find  else find  else ((x1_283 = x1[@i_363]) && ((x2_282 = x2[@i_363]) && ((X = x3[@i_363]) && ((@1_exp'(g, @1_x_535[@i_171]) = x4[@i_363]) && false)))) then
      (
        let sk_u: hash0 = r_254[@i_363] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_363]);
        out(c6[!_41], r1_77)
      )
      else
        new r_278: hash0;
        let sk_u: hash0 = r_278 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_278);
        out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @1_x_650[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @1_x_650[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = @1_exp'(g, @1_x_650[@i_168]) in
    let K_u_788: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && find  else find  else ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((@1_exp'(g, @1_x_650[@i_168]) = x14[@i_91]) && false)))) then
    (
      let x1_301: host = U in
      let x2_300: host = S in
      find [unique] @i_393 <= qH0 suchthat defined(x1[@i_393], x2[@i_393], x3[@i_393], x4[@i_393], x5[@i_393], r_254[@i_393]) && otheruses(r_254[@i_393]) && find  else find  else ((x1_301 = x1[@i_393]) && ((x2_300 = x2[@i_393]) && ((X = x3[@i_393]) && ((@1_exp'(g, @1_x_650[@i_168]) = x4[@i_393]) && false)))) then
      (
        let sk_u: hash0 = r_254[@i_393] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_393]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_296: hash0;
        let sk_u: hash0 = r_296 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_296);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_295: host = U in
      let x2_294: host = S in
      find [unique] @i_383 <= qH0 suchthat defined(x1[@i_383], x2[@i_383], x3[@i_383], x4[@i_383], x5[@i_383], r_254[@i_383]) && otheruses(r_254[@i_383]) && find  else find  else ((x1_295 = x1[@i_383]) && ((x2_294 = x2[@i_383]) && ((X = x3[@i_383]) && ((@1_exp'(g, @1_x_650[@i_168]) = x4[@i_383]) && false)))) then
      (
        let sk_u: hash0 = r_254[@i_383] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_383]);
        out(c6[!_41], r1_77)
      )
      else
        new r_290: hash0;
        let sk_u: hash0 = r_290 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_290);
        out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165], y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u_789: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    find [unique] @i_91 <= qH1 suchthat defined(x11[@i_91], x12[@i_91], x13[@i_91], x14[@i_91], x15[@i_91], r1_65[@i_91]) && otheruses(r1_65[@i_91]) && find  else find  else ((x1_82 = x11[@i_91]) && ((x2_81 = x12[@i_91]) && ((X = x13[@i_91]) && ((Y[@i_165] = x14[@i_91]) && false)))) then
    (
      let x1_313: host = U in
      let x2_312: host = S in
      find [unique] @i_413 <= qH0 suchthat defined(x1[@i_413], x2[@i_413], x3[@i_413], x4[@i_413], x5[@i_413], r_254[@i_413]) && otheruses(r_254[@i_413]) && find  else find  else ((x1_313 = x1[@i_413]) && ((x2_312 = x2[@i_413]) && ((X = x3[@i_413]) && ((Y[@i_165] = x4[@i_413]) && false)))) then
      (
        let sk_u: hash0 = r_254[@i_413] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_254[@i_413]);
        out(c6[!_41], r1_65[@i_91])
      )
      orfind  suchthat defined(j[@i_165], r_260[@i_165]) && otheruses(r_260[@i_165]) && (!_41 = j[@i_165]) then
      (
        let sk_u: hash0 = r_260[@i_165] in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_260[@i_165]);
        out(c6[!_41], r1_65[@i_91])
      )
      else
        new r_308: hash0;
        let sk_u: hash0 = r_308 in
        event termU(U, X, S, Ystar_u, r1_65[@i_91], r_308);
        out(c6[!_41], r1_65[@i_91])
    )
    else
      let x1_307: host = U in
      let x2_306: host = S in
      find [unique] @i_403 <= qH0 suchthat defined(x1[@i_403], x2[@i_403], x3[@i_403], x4[@i_403], x5[@i_403], r_254[@i_403]) && otheruses(r_254[@i_403]) && find  else find  else ((x1_307 = x1[@i_403]) && ((x2_306 = x2[@i_403]) && ((X = x3[@i_403]) && ((Y[@i_165] = x4[@i_403]) && false)))) then
      (
        let sk_u: hash0 = r_254[@i_403] in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_254[@i_403]);
        out(c6[!_41], r1_77)
      )
      else
        new r_302: hash0;
        let sk_u: hash0 = r_302 in
        new r1_77: hash1;
        event termU(U, X, S, Ystar_u, r1_77, r_302);
        out(c6[!_41], r1_77)
  )
  else
    new @1_x_650: exponent;
    let @2_r4_137: G = cst_G in
    let Y_u: G = @1_exp'(g, @1_x_650) in
    let K_u_790: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, r_272);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  let K_s: G = cst_G in
  let x1_76: host = U in
  let x2_75: host = S in
  find [unique] @i_88 <= qH1 suchthat defined(x11[@i_88], x12[@i_88], x13[@i_88], x14[@i_88], x15[@i_88], r1_65[@i_88]) && otheruses(r1_65[@i_88]) && find  else find  else ((x1_76 = x11[@i_88]) && ((x2_75 = x12[@i_88]) && ((X_s = x13[@i_88]) && ((Y = x14[@i_88]) && false)))) then
  (
    if (auth_s = r1_65[@i_88]) then
    let x1_265: host = U in
    let x2_264: host = S in
    find [unique] @i_333 <= qH0 suchthat defined(x1[@i_333], x2[@i_333], x3[@i_333], x4[@i_333], x5[@i_333], r_254[@i_333]) && otheruses(r_254[@i_333]) && find  else find  else ((x1_265 = x1[@i_333]) && ((x2_264 = x2[@i_333]) && ((X_s = x3[@i_333]) && ((Y = x4[@i_333]) && false)))) then
    (
      let sk_s: hash0 = r_254[@i_333] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_333])
    )
    orfind  suchthat defined(@i_165[j], r_302[j]) && otheruses(r_302[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    orfind  suchthat defined(@i_165[j], r_308[j]) && otheruses(r_308[j]) && (!_42 = @i_165[j]) then
    (
      let sk_s: hash0 = r_308[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_308[j])
    )
    else
      new r_260: hash0;
      let sk_s: hash0 = r_260 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_260)
  )
  orfind  suchthat defined(x[j], y[@i_165[j]], K_u_789[j], @i_165[j], r1_77[j]) && otheruses(r1_77[j]) && (!_42 = @i_165[j]) then
  (
    if (auth_s = r1_77[j]) then
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_343 <= qH0 suchthat defined(x1[@i_343], x2[@i_343], x3[@i_343], x4[@i_343], x5[@i_343], r_254[@i_343]) && otheruses(r_254[@i_343]) && find  else find  else ((x1_271 = x1[@i_343]) && ((x2_270 = x2[@i_343]) && ((X_s = x3[@i_343]) && ((Y = x4[@i_343]) && false)))) then
    (
      let sk_s: hash0 = r_254[@i_343] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_254[@i_343])
    )
    orfind  suchthat defined(r_302[j]) && otheruses(r_302[j]) then
    (
      let sk_s: hash0 = r_302[j] in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
    )
    else
      new r_266: hash0;
      let sk_s: hash0 = r_266 in
      event termS(U, X_s, S, @2_r2_134, auth_s, r_266)
  )
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_x_535[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_x_535[@i_155]) && ((@2_x = @1_exp'(g, @1_x_535[@i_155])) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@1_x_650[@i_152], Ystar_u[@i_152], @2_r4_137[@i_152]) && otheruses(Ystar_u[@i_152] -> @1_x_650[@i_152]) && ((@2_x = @1_exp'(g, @1_x_650[@i_152])) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_x_535[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_x_535[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @1_exp'(g, @1_x_535[@i_147]))
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_650[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @1_x_650[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], @1_exp'(g, @1_x_650[@i_144]))
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_x_535: exponent;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], @1_exp'(g, @1_x_535))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  orfind @i_322 <= NS suchthat defined(y[@i_322], x[j[@i_322]], K_s[@i_322], x1_265[@i_322], x2_264[@i_322], X_s[@i_322], Y[@i_322], r_260[@i_322]) && otheruses(r_260[@i_322]) && find  else find  else ((x1 = x1_265[@i_322]) && ((x2 = x2_264[@i_322]) && ((x3 = X_s[@i_322]) && ((x4 = Y[@i_322]) && false)))) then
    out(c20[!_45], r_260[@i_322])
  orfind @i_321 <= NS suchthat defined(y[@i_321], x[j[@i_321]], K_s[@i_321], x1_271[@i_321], x2_270[@i_321], X_s[@i_321], Y[@i_321], r_266[@i_321]) && otheruses(r_266[@i_321]) && find  else find  else ((x1 = x1_271[@i_321]) && ((x2 = x2_270[@i_321]) && ((x3 = X_s[@i_321]) && ((x4 = Y[@i_321]) && false)))) then
    out(c20[!_45], r_266[@i_321])
  orfind @i_320 <= NU suchthat defined(x[@i_320], K_u_790[@i_320], x1_277[@i_320], x2_276[@i_320], X[@i_320], @1_x_650[@i_320], r_272[@i_320]) && otheruses(r_272[@i_320]) && find  else find  else ((x1 = x1_277[@i_320]) && ((x2 = x2_276[@i_320]) && ((x3 = X[@i_320]) && ((x4 = @1_exp'(g, @1_x_650[@i_320])) && false)))) then
    out(c20[!_45], r_272[@i_320])
  orfind @i_319 <= NU suchthat defined(x[@i_319], K_u_787[@i_319], x1_283[@i_319], x2_282[@i_319], X[@i_319], @1_x_535[@i_171[@i_319]], r_278[@i_319]) && otheruses(r_278[@i_319]) && find  else find  else ((x1 = x1_283[@i_319]) && ((x2 = x2_282[@i_319]) && ((x3 = X[@i_319]) && ((x4 = @1_exp'(g, @1_x_535[@i_171[@i_319]])) && false)))) then
    out(c20[!_45], r_278[@i_319])
  orfind @i_318 <= NU suchthat defined(x[@i_318], K_u_787[@i_318], x1_289[@i_318], x2_288[@i_318], X[@i_318], @1_x_535[@i_171[@i_318]], r_284[@i_318]) && otheruses(r_284[@i_318]) && find  else find  else ((x1 = x1_289[@i_318]) && ((x2 = x2_288[@i_318]) && ((x3 = X[@i_318]) && ((x4 = @1_exp'(g, @1_x_535[@i_171[@i_318]])) && false)))) then
    out(c20[!_45], r_284[@i_318])
  orfind @i_317 <= NU suchthat defined(x[@i_317], K_u_788[@i_317], x1_295[@i_317], x2_294[@i_317], X[@i_317], @1_x_650[@i_168[@i_317]], r_290[@i_317]) && otheruses(r_290[@i_317]) && find  else find  else ((x1 = x1_295[@i_317]) && ((x2 = x2_294[@i_317]) && ((x3 = X[@i_317]) && ((x4 = @1_exp'(g, @1_x_650[@i_168[@i_317]])) && false)))) then
    out(c20[!_45], r_290[@i_317])
  orfind @i_316 <= NU suchthat defined(x[@i_316], K_u_788[@i_316], x1_301[@i_316], x2_300[@i_316], X[@i_316], @1_x_650[@i_168[@i_316]], r_296[@i_316]) && otheruses(r_296[@i_316]) && find  else find  else ((x1 = x1_301[@i_316]) && ((x2 = x2_300[@i_316]) && ((x3 = X[@i_316]) && ((x4 = @1_exp'(g, @1_x_650[@i_168[@i_316]])) && false)))) then
    out(c20[!_45], r_296[@i_316])
  orfind @i_315 <= NU suchthat defined(x[@i_315], y[@i_165[@i_315]], K_u_789[@i_315], x1_307[@i_315], x2_306[@i_315], X[@i_315], Y[@i_165[@i_315]], r_302[@i_315]) && otheruses(r_302[@i_315]) && find  else find  else ((x1 = x1_307[@i_315]) && ((x2 = x2_306[@i_315]) && ((x3 = X[@i_315]) && ((x4 = Y[@i_165[@i_315]]) && false)))) then
    out(c20[!_45], r_302[@i_315])
  orfind @i_314 <= NU suchthat defined(x[@i_314], y[@i_165[@i_314]], K_u_789[@i_314], x1_313[@i_314], x2_312[@i_314], X[@i_314], Y[@i_165[@i_314]], r_308[@i_314]) && otheruses(r_308[@i_314]) && find  else find  else ((x1 = x1_313[@i_314]) && ((x2 = x2_312[@i_314]) && ((x3 = X[@i_314]) && ((x4 = Y[@i_165[@i_314]]) && false)))) then
    out(c20[!_45], r_308[@i_314])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  orfind @i_83 <= NU suchthat defined(x[@i_83], @1_x_535[@i_171[@i_83]], K_u_787[@i_83], x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && find  else find  else ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && false)))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x[@i_83], @1_x_650[@i_168[@i_83]], K_u_788[@i_83], x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && find  else find  else ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && false)))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x[@i_83], y[@i_165[@i_83]], K_u_789[@i_83], x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && find  else find  else ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && false)))) then
    out(c21[!_46], r1_77[@i_83])
  orfind @i_83 <= NU suchthat defined(x[@i_83], @1_x_650[@i_83], K_u_790[@i_83], x1_82[@i_83], x2_81[@i_83], X[@i_83], Y_u[@i_83], r1_77[@i_83]) && otheruses(r1_77[@i_83]) && find  else find  else ((x11 = x1_82[@i_83]) && ((x12 = x2_81[@i_83]) && ((x13 = X[@i_83]) && ((x14 = Y_u[@i_83]) && false)))) then
    out(c21[!_46], r1_77[@i_83])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying simplify yields

Game 27 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_x_535[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_x_535[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = @1_exp'(g, @1_x_535[@i_171]) in
    let K_u_787: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    let x1_283: host = U in
    let x2_282: host = S in
    new r_278: hash0;
    let sk_u: hash0 = r_278 in
    new r1_77: hash1;
    event termU(U, X, S, Ystar_u, r1_77, r_278);
    out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @1_x_650[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @1_x_650[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = @1_exp'(g, @1_x_650[@i_168]) in
    let K_u_788: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    let x1_295: host = U in
    let x2_294: host = S in
    new r_290: hash0;
    let sk_u: hash0 = r_290 in
    new r1_77: hash1;
    event termU(U, X, S, Ystar_u, r1_77, r_290);
    out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u_789: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    let x1_307: host = U in
    let x2_306: host = S in
    new r_302: hash0;
    let sk_u: hash0 = r_302 in
    new r1_77: hash1;
    event termU(U, X, S, Ystar_u, r1_77, r_302);
    out(c6[!_41], r1_77)
  )
  else
    new @1_x_650: exponent;
    let @2_r4_137: G = cst_G in
    let Y_u: G = @1_exp'(g, @1_x_650) in
    let K_u_790: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, r_272);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  let K_s: G = cst_G in
  let x1_76: host = U in
  let x2_75: host = S in
  if defined(@i_165[j], r1_77[j], r_302[j]) && otheruses(r1_77[j]) && (!_42 = @i_165[j]) then
  if (auth_s = r1_77[j]) then
  let x1_271: host = U in
  let x2_270: host = S in
  if defined(r_302[j]) && otheruses(r_302[j]) then
  let sk_s: hash0 = r_302[j] in
  event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_x_535[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_x_535[@i_155]) && ((@2_x = @1_exp'(g, @1_x_535[@i_155])) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@1_x_650[@i_152], Ystar_u[@i_152], @2_r4_137[@i_152]) && otheruses(Ystar_u[@i_152] -> @1_x_650[@i_152]) && ((@2_x = @1_exp'(g, @1_x_650[@i_152])) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_x_535[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_x_535[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @1_exp'(g, @1_x_535[@i_147]))
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_650[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @1_x_650[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], @1_exp'(g, @1_x_650[@i_144]))
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_x_535: exponent;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], @1_exp'(g, @1_x_535))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying move all binders yields

Game 28 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_x_535[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_x_535[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    let Y_u: G = @1_exp'(g, @1_x_535[@i_171]) in
    let K_u_787: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    let x1_283: host = U in
    let x2_282: host = S in
    new r_278: hash0;
    let sk_u: hash0 = r_278 in
    new r1_77: hash1;
    event termU(U, X, S, Ystar_u, r1_77, r_278);
    out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @1_x_650[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @1_x_650[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    let Y_u: G = @1_exp'(g, @1_x_650[@i_168]) in
    let K_u_788: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    let x1_295: host = U in
    let x2_294: host = S in
    new r_290: hash0;
    let sk_u: hash0 = r_290 in
    new r1_77: hash1;
    event termU(U, X, S, Ystar_u, r1_77, r_290);
    out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    let Y_u: G = Y[@i_165] in
    let K_u_789: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    let x1_307: host = U in
    let x2_306: host = S in
    new r_302: hash0;
    let sk_u: hash0 = r_302 in
    new r1_77: hash1;
    event termU(U, X, S, Ystar_u, r1_77, r_302);
    out(c6[!_41], r1_77)
  )
  else
    new @1_x_650: exponent;
    let @2_r4_137: G = cst_G in
    let Y_u: G = @1_exp'(g, @1_x_650) in
    let K_u_790: G = cst_G in
    let x1_82: host = U in
    let x2_81: host = S in
    new r1_77: hash1;
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, r_272);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  if defined(@i_165[j], r1_77[j], r_302[j]) && otheruses(r1_77[j]) && (!_42 = @i_165[j]) then
  if (auth_s = r1_77[j]) then
  if defined(r_302[j]) && otheruses(r_302[j]) then
  let sk_s: hash0 = r_302[j] in
  event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_x_535[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_x_535[@i_155]) && ((@2_x = @1_exp'(g, @1_x_535[@i_155])) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@1_x_650[@i_152], Ystar_u[@i_152], @2_r4_137[@i_152]) && otheruses(Ystar_u[@i_152] -> @1_x_650[@i_152]) && ((@2_x = @1_exp'(g, @1_x_650[@i_152])) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_x_535[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_x_535[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @1_exp'(g, @1_x_535[@i_147]))
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_650[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @1_x_650[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], @1_exp'(g, @1_x_650[@i_144]))
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_x_535: exponent;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], @1_exp'(g, @1_x_535))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying remove assignments of useless yields

Game 29 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_x_535[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_x_535[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    new r_278: hash0;
    let sk_u: hash0 = r_278 in
    new r1_77: hash1;
    event termU(U, X, S, Ystar_u, r1_77, r_278);
    out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @1_x_650[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @1_x_650[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    new r_290: hash0;
    let sk_u: hash0 = r_290 in
    new r1_77: hash1;
    event termU(U, X, S, Ystar_u, r1_77, r_290);
    out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    new r_302: hash0;
    let sk_u: hash0 = r_302 in
    new r1_77: hash1;
    event termU(U, X, S, Ystar_u, r1_77, r_302);
    out(c6[!_41], r1_77)
  )
  else
    new @1_x_650: exponent;
    let @2_r4_137: G = cst_G in
    new r1_77: hash1;
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, r_272);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  if defined(@i_165[j], r1_77[j], r_302[j]) && otheruses(r1_77[j]) && (!_42 = @i_165[j]) then
  if (auth_s = r1_77[j]) then
  if defined(r_302[j]) && otheruses(r_302[j]) then
  let sk_s: hash0 = r_302[j] in
  event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_x_535[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_x_535[@i_155]) && ((@2_x = @1_exp'(g, @1_x_535[@i_155])) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@1_x_650[@i_152], Ystar_u[@i_152], @2_r4_137[@i_152]) && otheruses(Ystar_u[@i_152] -> @1_x_650[@i_152]) && ((@2_x = @1_exp'(g, @1_x_650[@i_152])) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_x_535[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_x_535[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @1_exp'(g, @1_x_535[@i_147]))
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_650[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @1_x_650[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], @1_exp'(g, @1_x_650[@i_144]))
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_x_535: exponent;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], @1_exp'(g, @1_x_535))
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


RESULT Proved event termS(x, X, y, Y, a, k) && termU(x, X, y, Y, a, k') ==> (k = k') excluding set(dist 3->4, proba <= 1. / |exponent| * NS + NS / |hash1| + 0.5 * NU * NU / |exponent| + 0.5 * NS * NS / |exponent|) U set(dist 6->7, proba <= (NS * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 7->8, proba <= qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G|) U set(event Encrypt in game 11) U set(dist 12->13, proba <= 9. * 1. / |exponent| * NS + 8. * 1. / |exponent| * NU + NU * NS / |exponent| + qD * NS / |exponent| + 6.5 * NU * NU / |G| + 3. * NS * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 19->20, proba <= 3. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 25->26.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 25)) + 2. * qH1 * pCDH(NS * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 25))) U set(dist 25->26.2, proba <= NU * qD / |exponent|) U set(dist 25->26.3, proba <= 0.5 * qD * qD / |exponent|) U set(dist 25->26.4, proba <= 0.5 * NU * NU / |exponent|)
RESULT However, I could not bound the probability of set(event Encrypt in game 11)
RESULT Proved event inj:termS(x, X, y, Y, a, k) ==> inj:termU(x, X, y, Y, a, k) excluding set(dist 3->4, proba <= 1. / |exponent| * NS + NS / |hash1| + 0.5 * NU * NU / |exponent| + 0.5 * NS * NS / |exponent|) U set(dist 6->7, proba <= (NS * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 7->8, proba <= qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G|) U set(event Encrypt in game 11) U set(dist 12->13, proba <= 9. * 1. / |exponent| * NS + 8. * 1. / |exponent| * NU + NU * NS / |exponent| + qD * NS / |exponent| + 6.5 * NU * NU / |G| + 3. * NS * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 19->20, proba <= 3. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 25->26.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 25)) + 2. * qH1 * pCDH(NS * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 25))) U set(dist 25->26.2, proba <= NU * qD / |exponent|) U set(dist 25->26.3, proba <= 0.5 * qD * qD / |exponent|) U set(dist 25->26.4, proba <= 0.5 * NU * NU / |exponent|)
RESULT However, I could not bound the probability of set(event Encrypt in game 11)
RESULT Proved secrecy of sk_s excluding set(dist 3->4, proba <= 1. / |exponent| * NS + NS / |hash1| + 0.5 * NU * NU / |exponent| + 0.5 * NS * NS / |exponent|) U set(dist 6->7, proba <= (NS * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 7->8, proba <= qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G|) U set(event Encrypt in game 11) U set(dist 12->13, proba <= 9. * 1. / |exponent| * NS + 8. * 1. / |exponent| * NU + NU * NS / |exponent| + qD * NS / |exponent| + 6.5 * NU * NU / |G| + 3. * NS * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 19->20, proba <= 3. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 25->26.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 25)) + 2. * qH1 * pCDH(NS * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 25))) U set(dist 25->26.2, proba <= NU * qD / |exponent|) U set(dist 25->26.3, proba <= 0.5 * qD * qD / |exponent|) U set(dist 25->26.4, proba <= 0.5 * NU * NU / |exponent|)
RESULT However, I could not bound the probability of set(event Encrypt in game 11)
RESULT Proved secrecy of sk_u excluding set(dist 3->4, proba <= 1. / |exponent| * NS + NS / |hash1| + 0.5 * NU * NU / |exponent| + 0.5 * NS * NS / |exponent|) U set(dist 6->7, proba <= (NS * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 7->8, proba <= qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G|) U set(event Encrypt in game 11) U set(dist 12->13, proba <= 9. * 1. / |exponent| * NS + 8. * 1. / |exponent| * NU + NU * NS / |exponent| + qD * NS / |exponent| + 6.5 * NU * NU / |G| + 3. * NS * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 19->20, proba <= 3. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 25->26.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 25)) + 2. * qH1 * pCDH(NS * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 25))) U set(dist 25->26.2, proba <= NU * qD / |exponent|) U set(dist 25->26.3, proba <= 0.5 * qD * qD / |exponent|) U set(dist 25->26.4, proba <= 0.5 * NU * NU / |exponent|)
RESULT However, I could not bound the probability of set(event Encrypt in game 11)

Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 30 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@1_X_2403[@i_171], @2_m[@i_171], @2_kd[@i_171], @1_x_535[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_X_2403[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    new r_278: hash0;
    let sk_u: hash0 = r_278 in
    new r1_77: hash1;
    event termU(U, X, S, Ystar_u, r1_77, r_278);
    out(c6[!_41], r1_77)
  )
  orfind @i_168 <= NU suchthat defined(Ystar_u[@i_168], @1_x_650[@i_168], @2_r4_137[@i_168]) && otheruses(Ystar_u[@i_168] -> @1_x_650[@i_168]) && (Ystar_u = Ystar_u[@i_168]) then
  (
    new r_290: hash0;
    let sk_u: hash0 = r_290 in
    new r1_77: hash1;
    event termU(U, X, S, Ystar_u, r1_77, r_290);
    out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    new r_302: hash0;
    let sk_u: hash0 = r_302 in
    new r1_77: hash1;
    event termU(U, X, S, Ystar_u, r1_77, r_302);
    out(c6[!_41], r1_77)
  )
  else
    new @1_x_650: exponent;
    let @2_r4_137: G = cst_G in
    new r1_77: hash1;
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    event termU(U, X, S, Ystar_u, r1_77, r_272);
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  if defined(@i_165[j], r1_77[j], r_302[j]) && otheruses(r1_77[j]) && (!_42 = @i_165[j]) then
  if (auth_s = r1_77[j]) then
  if defined(r_302[j]) && otheruses(r_302[j]) then
  let sk_s: hash0 = r_302[j] in
  event termS(U, X_s, S, @2_r2_134, auth_s, r_302[j])
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_X_2403[@i_155], @1_x_535[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_X_2403[@i_155]) && ((@2_x = @1_X_2403[@i_155]) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_152 <= NU suchthat defined(@1_x_650[@i_152], Ystar_u[@i_152], @2_r4_137[@i_152]) && otheruses(Ystar_u[@i_152] -> @1_x_650[@i_152]) && ((@2_x = @1_exp'(g, @1_x_650[@i_152])) && (@2_ke = pw)) then
    out(@2_c2[!_43], Ystar_u[@i_152])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@1_X_2403[@i_147], @2_m[@i_147], @2_kd[@i_147], @1_x_535[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_X_2403[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @1_X_2403[@i_147])
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_650[@i_144], @2_r4_137[@i_144]) && otheruses(Ystar_u[@i_144] -> @1_x_650[@i_144]) && ((@2_m = Ystar_u[@i_144]) && (@2_kd = pw)) then
    out(@2_c4[!_44], @1_exp'(g, @1_x_650[@i_144]))
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_X_2403: G;
    let @1_x_535: exponent = cst_exponent in
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], @1_X_2403)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying simplify yields

Game 31 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_X_2403[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_X_2403[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    new r_278: hash0;
    let sk_u: hash0 = r_278 in
    new r1_77: hash1;
    out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    new r_302: hash0;
    let sk_u: hash0 = r_302 in
    new r1_77: hash1;
    out(c6[!_41], r1_77)
  )
  else
    let @2_r4_137: G = cst_G in
    new r1_77: hash1;
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  if defined(@i_165[j], r1_77[j], r_302[j]) && otheruses(r1_77[j]) && (!_42 = @i_165[j]) then
  if (auth_s = r1_77[j]) then
  let sk_s: hash0 = r_302[j]
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_X_2403[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_X_2403[@i_155]) && ((@2_x = @1_X_2403[@i_155]) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_X_2403[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_X_2403[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @1_X_2403[@i_147])
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_X_2403: G;
    let @1_x_535: exponent = cst_exponent in
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], @1_X_2403)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying remove assignments of useless yields

Game 32 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_X_2403[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_X_2403[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    new r_278: hash0;
    let sk_u: hash0 = r_278 in
    new r1_77: hash1;
    out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    new r_302: hash0;
    let sk_u: hash0 = r_302 in
    new r1_77: hash1;
    out(c6[!_41], r1_77)
  )
  else
    new r1_77: hash1;
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  if defined(@i_165[j], r1_77[j], r_302[j]) && otheruses(r1_77[j]) && (!_42 = @i_165[j]) then
  if (auth_s = r1_77[j]) then
  let sk_s: hash0 = r_302[j]
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_X_2403[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_X_2403[@i_155]) && ((@2_x = @1_X_2403[@i_155]) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_X_2403[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_X_2403[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @1_X_2403[@i_147])
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_X_2403: G;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], @1_X_2403)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 33 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_X_2403[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_X_2403[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    new r_278: hash0;
    let sk_u: hash0 = r_278 in
    new r1_77: hash1;
    out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@2_r2_134[@i_165], Y[@i_165]) && otheruses(Y[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    new r_302: hash0;
    let sk_u: hash0 = r_302 in
    new r1_77: hash1;
    out(c6[!_41], r1_77)
  )
  else
    new r1_77: hash1;
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @1_X_2471: G;
  let Y: G = @1_X_2471 in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  if defined(@i_165[j], r1_77[j], r_302[j]) && otheruses(r1_77[j]) && (!_42 = @i_165[j]) then
  if (auth_s = r1_77[j]) then
  let sk_s: hash0 = r_302[j]
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_X_2403[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_X_2403[@i_155]) && ((@2_x = @1_X_2403[@i_155]) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(Y[@i_149], @2_r2_134[@i_149]) && otheruses(Y[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = Y[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_X_2403[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_X_2403[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @1_X_2403[@i_147])
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@2_r2_134[@i_141], Y[@i_141]) && otheruses(Y[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], Y[@i_141])
  else
    new @1_X_2403: G;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], @1_X_2403)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying remove assignments of useless yields

Game 34 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_X_2403[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_X_2403[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    new r_278: hash0;
    let sk_u: hash0 = r_278 in
    new r1_77: hash1;
    out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@1_X_2471[@i_165], Y[@i_165], @2_r2_134[@i_165]) && otheruses(@1_X_2471[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    new r_302: hash0;
    let sk_u: hash0 = r_302 in
    new r1_77: hash1;
    out(c6[!_41], r1_77)
  )
  else
    new r1_77: hash1;
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @1_X_2471: G;
  let Y: G = cst_G in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  if defined(@i_165[j], r1_77[j], r_302[j]) && otheruses(r1_77[j]) && (!_42 = @i_165[j]) then
  if (auth_s = r1_77[j]) then
  let sk_s: hash0 = r_302[j]
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_X_2403[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_X_2403[@i_155]) && ((@2_x = @1_X_2403[@i_155]) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(@1_X_2471[@i_149], Y[@i_149], @2_r2_134[@i_149]) && otheruses(@1_X_2471[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = @1_X_2471[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_X_2403[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_X_2403[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @1_X_2403[@i_147])
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@1_X_2471[@i_141], Y[@i_141], @2_r2_134[@i_141]) && otheruses(@1_X_2471[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], @1_X_2471[@i_141])
  else
    new @1_X_2403: G;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], @1_X_2403)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 35 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new @1_X_2502: G;
  let X: G = @1_X_2502 in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_X_2403[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_X_2403[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    new r_278: hash0;
    let sk_u: hash0 = r_278 in
    new r1_77: hash1;
    out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  orfind @i_165 <= NS suchthat defined(@1_X_2471[@i_165], Y[@i_165], @2_r2_134[@i_165]) && otheruses(@1_X_2471[@i_165] -> @2_r2_134[@i_165]) && (Ystar_u = @2_r2_134[@i_165]) then
  (
    new r_302: hash0;
    let sk_u: hash0 = r_302 in
    new r1_77: hash1;
    out(c6[!_41], r1_77)
  )
  else
    new r1_77: hash1;
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @1_X_2471: G;
  let Y: G = cst_G in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  if defined(@i_165[j], r1_77[j], r_302[j]) && otheruses(r1_77[j]) && (!_42 = @i_165[j]) then
  if (auth_s = r1_77[j]) then
  let sk_s: hash0 = r_302[j]
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_X_2403[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_X_2403[@i_155]) && ((@2_x = @1_X_2403[@i_155]) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  orfind @i_149 <= NS suchthat defined(@1_X_2471[@i_149], Y[@i_149], @2_r2_134[@i_149]) && otheruses(@1_X_2471[@i_149] -> @2_r2_134[@i_149]) && ((@2_x = @1_X_2471[@i_149]) && (@2_ke = pw)) then
    out(@2_c2[!_43], @2_r2_134[@i_149])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_X_2403[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_X_2403[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @1_X_2403[@i_147])
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  orfind @i_141 <= NS suchthat defined(@1_X_2471[@i_141], Y[@i_141], @2_r2_134[@i_141]) && otheruses(@1_X_2471[@i_141] -> @2_r2_134[@i_141]) && ((@2_m = @2_r2_134[@i_141]) && (@2_kd = pw)) then
    out(@2_c4[!_44], @1_X_2471[@i_141])
  else
    new @1_X_2403: G;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], @1_X_2403)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying simplify yields

Game 36 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new @1_X_2502: G;
  let X: G = @1_X_2502 in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_X_2403[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_X_2403[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    new r_278: hash0;
    let sk_u: hash0 = r_278 in
    new r1_77: hash1;
    out(c6[!_41], r1_77)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  else
    new r1_77: hash1;
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    out(c6[!_41], r1_77)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  let Y: G = cst_G in
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1)
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_X_2403[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_X_2403[@i_155]) && ((@2_x = @1_X_2403[@i_155]) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_X_2403[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_X_2403[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @1_X_2403[@i_147])
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  else
    new @1_X_2403: G;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], @1_X_2403)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)


Applying remove assignments of useless yields

Game 37 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new @1_X_2502: G;
  out(c2[!_41], (U, @1_X_2502));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_171 <= qD suchthat defined(@2_m[@i_171], @2_kd[@i_171], @1_X_2403[@i_171], @2_r4_128[@i_171]) && otheruses(@2_m[@i_171] -> @1_X_2403[@i_171]) && ((Ystar_u = @2_m[@i_171]) && (pw = @2_kd[@i_171])) then
  (
    new r_278: hash0;
    let sk_u: hash0 = r_278 in
    new r1_2562: hash1;
    out(c6[!_41], r1_2562)
  )
  orfind @i_166 <= qE suchthat defined(@2_r2_131[@i_166], @2_ke[@i_166], @2_x[@i_166]) && otheruses(@2_x[@i_166] -> @2_r2_131[@i_166]) && ((Ystar_u = @2_r2_131[@i_166]) && (pw = @2_ke[@i_166])) then
    event Encrypt
  else
    new r1_2561: hash1;
    new r_272: hash0;
    let sk_u: hash0 = r_272 in
    out(c6[!_41], r1_2561)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @2_r2_134: G;
  out(c4[!_42], (S, @2_r2_134));
  in(c7[!_42], auth_s: hash1)
) | (
  ! !_43 <= qE
  in(@2_c1[!_43], (@2_x: G, @2_ke: passwd));
  find [unique] @i_155 <= qD suchthat defined(@1_X_2403[@i_155], @2_kd[@i_155], @2_m[@i_155], @2_r4_128[@i_155]) && otheruses(@2_m[@i_155] -> @1_X_2403[@i_155]) && ((@2_x = @1_X_2403[@i_155]) && (@2_ke = @2_kd[@i_155])) then
    out(@2_c2[!_43], @2_m[@i_155])
  orfind @i_150 <= qE suchthat defined(@2_x[@i_150], @2_ke[@i_150], @2_r2_131[@i_150]) && otheruses(@2_x[@i_150] -> @2_r2_131[@i_150]) && ((@2_x = @2_x[@i_150]) && (@2_ke = @2_ke[@i_150])) then
    out(@2_c2[!_43], @2_r2_131[@i_150])
  else
    new @2_r2_131: G;
    out(@2_c2[!_43], @2_r2_131)
) | (
  ! !_44 <= qD
  in(@2_c3[!_44], (@2_m: G, @2_kd: passwd));
  find [unique] @i_147 <= qD suchthat defined(@2_m[@i_147], @2_kd[@i_147], @1_X_2403[@i_147], @2_r4_128[@i_147]) && otheruses(@2_m[@i_147] -> @1_X_2403[@i_147]) && ((@2_m = @2_m[@i_147]) && (@2_kd = @2_kd[@i_147])) then
    out(@2_c4[!_44], @1_X_2403[@i_147])
  orfind @i_142 <= qE suchthat defined(@2_r2_131[@i_142], @2_ke[@i_142], @2_x[@i_142]) && otheruses(@2_x[@i_142] -> @2_r2_131[@i_142]) && ((@2_m = @2_r2_131[@i_142]) && (@2_kd = @2_ke[@i_142])) then
    out(@2_c4[!_44], @2_x[@i_142])
  else
    new @1_X_2403: G;
    let @2_r4_128: G = cst_G in
    out(@2_c4[!_44], @1_X_2403)
) | (
  ! !_45 <= qH0
  in(c10[!_45], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_323 <= qH0 suchthat defined(x1[@i_323], x2[@i_323], x3[@i_323], x4[@i_323], x5[@i_323], r_254[@i_323]) && otheruses(r_254[@i_323]) && ((x1 = x1[@i_323]) && ((x2 = x2[@i_323]) && ((x3 = x3[@i_323]) && ((x4 = x4[@i_323]) && (x5 = x5[@i_323]))))) then
    out(c20[!_45], r_254[@i_323])
  else
    new r_254: hash0;
    out(c20[!_45], r_254)
) | (
  ! !_46 <= qH1
  in(c11[!_46], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_85 <= qH1 suchthat defined(x11[@i_85], x12[@i_85], x13[@i_85], x14[@i_85], x15[@i_85], r1_65[@i_85]) && otheruses(r1_65[@i_85]) && ((x11 = x11[@i_85]) && ((x12 = x12[@i_85]) && ((x13 = x13[@i_85]) && ((x14 = x14[@i_85]) && (x15 = x15[@i_85]))))) then
    out(c21[!_46], r1_65[@i_85])
  else
    new r1_65: hash1;
    out(c21[!_46], r1_65)
)

RESULT time(context for game 25) = 0
RESULT Could not prove event Encrypt ==> false in game 11.
