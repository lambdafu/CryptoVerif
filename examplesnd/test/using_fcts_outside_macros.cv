(* The process can use the identifiers enc_seed_4 and enc_r_4
defined by the expansion of the macro IND_CPA_sym_enc, even 
though they are not passed as parameters.
That's not good. *)

type key [large,fixed].
type cleartext.
type ciphertext.

proba Penc.

expand IND_CPA_sym_enc(key, cleartext, ciphertext, enc, dec, injbot, Z, Penc).

channel c.

process
	in(c, x: cleartext); new k: key; (*out(c, enc(x,k))*)
	new r: enc_seed_4; out(c, enc_r_4(x, k, r))

(* EXPECTED
All queries proved.
0.127s (elapsed: user + system + other processes)
END *)

