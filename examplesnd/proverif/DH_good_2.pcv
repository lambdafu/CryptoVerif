type Z [large,bounded].
type G [large,bounded].

(* Let's use a good group *)
expand DH_good_group(G, Z, g, exp, exp', mult).

channel c.

event bad.
query event(bad) ==> false.

process
	in(c, (X: G, X': G, y:Z)); if exp(X,y) = exp(X',y) && X <> X' then event bad

(* EXPECTED
All queries proved.
0.200s (user 0.172s + system 0.028s), max rss 44156K
END *)

(* EXPECTPV
RESULT not event(bad) is true.
0.024s (user 0.016s + system 0.008s), max rss 10400K
END *)
